var ts=Object.defineProperty;var es=(v,n,L)=>n in v?ts(v,n,{enumerable:!0,configurable:!0,writable:!0,value:L}):v[n]=L;var It=(v,n,L)=>(es(v,typeof n!="symbol"?n+"":n,L),L),he=(v,n,L)=>{if(!n.has(v))throw TypeError("Cannot "+L)};var m=(v,n,L)=>(he(v,n,"read from private field"),L?L.call(v):n.get(v)),et=(v,n,L)=>{if(n.has(v))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(v):n.set(v,L)},pt=(v,n,L,i)=>(he(v,n,"write to private field"),i?i.call(v,L):n.set(v,L),L),ie=(v,n,L,i)=>({set _(y){pt(v,n,y,L)},get _(){return m(v,n,i)}}),ot=(v,n,L)=>(he(v,n,"access private method"),L);import{J as includes,q as propsFactory,K as getCurrentInstanceName,p as computed,k as isRef,e as createVNode,F as Fragment,a as unref,L as useColor,M as makeDensityProps,N as makeRoundedProps,H as makeTagProps,O as makeThemeProps,m as genericComponent,P as provideTheme,Q as useDensity,R as useRounded,U as provideDefaults,V as toRef,n as useRender,W as getCurrentInstance,X as getUid,Y as provide,Z as inject,_ as onBeforeUnmount,x as watch,$ as reactive,a0 as useProxiedModel,a1 as onMounted,a2 as deepEqual,a3 as findChildrenWithProvide,a4 as consoleWarn,a5 as wrapInArray,v as mergeProps,j as ref,S as SUPPORTS_INTERSECTION,a6 as makeSizeProps,a7 as useSize,a8 as useTextColor,a9 as useResizeObserver,C as convertToUnit,l as watchEffect,aa as isObject,ab as keyCodes,ac as useRtl,z as nextTick,ad as IconValue,ae as makeRouterProps,af as useLink,A as withDirectives,B as resolveDirective,ag as VIcon,ah as VDefaultsProvider,I as useRoute,ai as toRaw,o as openBlock,b as createBlock,w as withCtx,d as createCommentVNode,aj as createTextVNode,f as createBaseVNode,t as toDisplayString}from"./index.1d37784f.js";import{V as VContainer}from"./VContainer.0f7226a7.js";import{m as makeDimensionProps,u as useDimension,a as VCol,V as VRow}from"./dimensions.da7fd089.js";const block=["top","bottom"],inline=["start","end","left","right"];function parseAnchor(v,n){let[L,i]=v.split(" ");return i||(i=includes(block,L)?"start":includes(inline,L)?"top":"center"),{side:toPhysical(L,n),align:toPhysical(i,n)}}function toPhysical(v,n){return v==="start"?n?"right":"left":v==="end"?n?"left":"right":v}function getAugmentedNamespace(v){var n=v.default;if(typeof n=="function"){var L=function(){return n.apply(this,arguments)};L.prototype=n.prototype}else L={};return Object.defineProperty(L,"__esModule",{value:!0}),Object.keys(v).forEach(function(i){var y=Object.getOwnPropertyDescriptor(v,i);Object.defineProperty(L,i,y.get?y:{enumerable:!0,get:function(){return v[i]}})}),L}function commonjsRequire(v){throw new Error('Could not dynamically require "'+v+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(n,L){module.exports=L()})(globalThis,()=>(()=>{var __webpack_modules__=[,(v,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.VerbosityLevel=n.Util=n.UnknownErrorException=n.UnexpectedResponseException=n.TextRenderingMode=n.RenderingIntentFlag=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.MAX_IMAGE_SIZE_TO_CACHE=n.LINE_FACTOR=n.LINE_DESCENT_FACTOR=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FeatureTest=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.BASELINE_FACTOR=n.AnnotationType=n.AnnotationStateModelType=n.AnnotationReviewState=n.AnnotationReplyType=n.AnnotationMode=n.AnnotationMarkedState=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationEditorType=n.AnnotationEditorPrefix=n.AnnotationEditorParamsType=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,n.assert=yt,n.bytesToString=M,n.createPromiseCapability=wt,n.createValidAbsoluteUrl=u,n.getModificationDate=At,n.getVerbosityLevel=ft,n.info=lt,n.isArrayBuffer=gt,n.isArrayEqual=Ct,n.objectFromMap=P,n.objectSize=A,n.setVerbosityLevel=it,n.shadow=f,n.string32=l,n.stringToBytes=e,n.stringToPDFString=dt,n.stringToUTF8String=ct,n.unreachable=_t,n.utf8StringToString=bt,n.warn=ut;const L=[1,0,0,1,0,0];n.IDENTITY_MATRIX=L;const i=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=i;const y=1e7;n.MAX_IMAGE_SIZE_TO_CACHE=y;const B=1.35;n.LINE_FACTOR=B;const q=.35;n.LINE_DESCENT_FACTOR=q;const Z=q/B;n.BASELINE_FACTOR=Z;const N={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=N;const T={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=T;const b="pdfjs_internal_editor_";n.AnnotationEditorPrefix=b;const k={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};n.AnnotationEditorType=k;const E={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};n.AnnotationEditorParamsType=E;const _={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=_;const d={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=d;const p={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=p;const s={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=s;const a={MARKED:"Marked",REVIEW:"Review"};n.AnnotationStateModelType=a;const w={MARKED:"Marked",UNMARKED:"Unmarked"};n.AnnotationMarkedState=w;const R={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};n.AnnotationReviewState=R;const S={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=S;const t={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=t;const c={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=c;const h={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=h;const r={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=r;const g={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=g;const x={O:"PageOpen",C:"PageClose"};n.PageActionEventType=x;const o={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=o;const D={NONE:0,BINARY:1};n.CMapCompressionType=D;const z={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=z;const K={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=K;let tt=o.WARNINGS;function it(F){Number.isInteger(F)&&(tt=F)}function ft(){return tt}function lt(F){tt>=o.INFOS&&console.log(`Info: ${F}`)}function ut(F){tt>=o.WARNINGS&&console.log(`Warning: ${F}`)}function _t(F){throw new Error(F)}function yt(F,H){F||_t(H)}function G(F){if(!F)return!1;switch(F.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function u(F,H=null,W=null){if(!F)return null;try{if(W&&typeof F=="string"){if(W.addDefaultProtocol&&F.startsWith("www.")){const Et=F.match(/\./g);Et&&Et.length>=2&&(F=`http://${F}`)}if(W.tryConvertEncoding)try{F=ct(F)}catch{}}const mt=H?new URL(F,H):new URL(F);if(G(mt))return mt}catch{}return null}function f(F,H,W,mt=!1){return Object.defineProperty(F,H,{value:W,enumerable:!mt,configurable:!0,writable:!1}),W}const C=function(){function H(W,mt){this.constructor===H&&_t("Cannot initialize BaseException."),this.message=W,this.name=mt}return H.prototype=new Error,H.constructor=H,H}();n.BaseException=C;class V extends C{constructor(H,W){super(H,"PasswordException"),this.code=W}}n.PasswordException=V;class I extends C{constructor(H,W){super(H,"UnknownErrorException"),this.details=W}}n.UnknownErrorException=I;class $ extends C{constructor(H){super(H,"InvalidPDFException")}}n.InvalidPDFException=$;class X extends C{constructor(H){super(H,"MissingPDFException")}}n.MissingPDFException=X;class J extends C{constructor(H,W){super(H,"UnexpectedResponseException"),this.status=W}}n.UnexpectedResponseException=J;class Y extends C{constructor(H){super(H,"FormatError")}}n.FormatError=Y;class j extends C{constructor(H){super(H,"AbortException")}}n.AbortException=j;function M(F){(typeof F!="object"||F===null||F.length===void 0)&&_t("Invalid argument for bytesToString");const H=F.length,W=8192;if(H<W)return String.fromCharCode.apply(null,F);const mt=[];for(let Et=0;Et<H;Et+=W){const Q=Math.min(Et+W,H),ht=F.subarray(Et,Q);mt.push(String.fromCharCode.apply(null,ht))}return mt.join("")}function e(F){typeof F!="string"&&_t("Invalid argument for stringToBytes");const H=F.length,W=new Uint8Array(H);for(let mt=0;mt<H;++mt)W[mt]=F.charCodeAt(mt)&255;return W}function l(F){return String.fromCharCode(F>>24&255,F>>16&255,F>>8&255,F&255)}function A(F){return Object.keys(F).length}function P(F){const H=Object.create(null);for(const[W,mt]of F)H[W]=mt;return H}function O(){const F=new Uint8Array(4);return F[0]=1,new Uint32Array(F.buffer,0,1)[0]===1}function U(){try{return new Function(""),!0}catch{return!1}}class nt{static get isLittleEndian(){return f(this,"isLittleEndian",O())}static get isEvalSupported(){return f(this,"isEvalSupported",U())}static get isOffscreenCanvasSupported(){return f(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?f(this,"platform",{isWin:!1,isMac:!1}):f(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}n.FeatureTest=nt;const st=[...Array(256).keys()].map(F=>F.toString(16).padStart(2,"0"));class rt{static makeHexColor(H,W,mt){return`#${st[H]}${st[W]}${st[mt]}`}static scaleMinMax(H,W){let mt;H[0]?(H[0]<0&&(mt=W[0],W[0]=W[1],W[1]=mt),W[0]*=H[0],W[1]*=H[0],H[3]<0&&(mt=W[2],W[2]=W[3],W[3]=mt),W[2]*=H[3],W[3]*=H[3]):(mt=W[0],W[0]=W[2],W[2]=mt,mt=W[1],W[1]=W[3],W[3]=mt,H[1]<0&&(mt=W[2],W[2]=W[3],W[3]=mt),W[2]*=H[1],W[3]*=H[1],H[2]<0&&(mt=W[0],W[0]=W[1],W[1]=mt),W[0]*=H[2],W[1]*=H[2]),W[0]+=H[4],W[1]+=H[4],W[2]+=H[5],W[3]+=H[5]}static transform(H,W){return[H[0]*W[0]+H[2]*W[1],H[1]*W[0]+H[3]*W[1],H[0]*W[2]+H[2]*W[3],H[1]*W[2]+H[3]*W[3],H[0]*W[4]+H[2]*W[5]+H[4],H[1]*W[4]+H[3]*W[5]+H[5]]}static applyTransform(H,W){const mt=H[0]*W[0]+H[1]*W[2]+W[4],Et=H[0]*W[1]+H[1]*W[3]+W[5];return[mt,Et]}static applyInverseTransform(H,W){const mt=W[0]*W[3]-W[1]*W[2],Et=(H[0]*W[3]-H[1]*W[2]+W[2]*W[5]-W[4]*W[3])/mt,Q=(-H[0]*W[1]+H[1]*W[0]+W[4]*W[1]-W[5]*W[0])/mt;return[Et,Q]}static getAxialAlignedBoundingBox(H,W){const mt=rt.applyTransform(H,W),Et=rt.applyTransform(H.slice(2,4),W),Q=rt.applyTransform([H[0],H[3]],W),ht=rt.applyTransform([H[2],H[1]],W);return[Math.min(mt[0],Et[0],Q[0],ht[0]),Math.min(mt[1],Et[1],Q[1],ht[1]),Math.max(mt[0],Et[0],Q[0],ht[0]),Math.max(mt[1],Et[1],Q[1],ht[1])]}static inverseTransform(H){const W=H[0]*H[3]-H[1]*H[2];return[H[3]/W,-H[1]/W,-H[2]/W,H[0]/W,(H[2]*H[5]-H[4]*H[3])/W,(H[4]*H[1]-H[5]*H[0])/W]}static singularValueDecompose2dScale(H){const W=[H[0],H[2],H[1],H[3]],mt=H[0]*W[0]+H[1]*W[2],Et=H[0]*W[1]+H[1]*W[3],Q=H[2]*W[0]+H[3]*W[2],ht=H[2]*W[1]+H[3]*W[3],vt=(mt+ht)/2,St=Math.sqrt((mt+ht)**2-4*(mt*ht-Q*Et))/2,Rt=vt+St||1,kt=vt-St||1;return[Math.sqrt(Rt),Math.sqrt(kt)]}static normalizeRect(H){const W=H.slice(0);return H[0]>H[2]&&(W[0]=H[2],W[2]=H[0]),H[1]>H[3]&&(W[1]=H[3],W[3]=H[1]),W}static intersect(H,W){const mt=Math.max(Math.min(H[0],H[2]),Math.min(W[0],W[2])),Et=Math.min(Math.max(H[0],H[2]),Math.max(W[0],W[2]));if(mt>Et)return null;const Q=Math.max(Math.min(H[1],H[3]),Math.min(W[1],W[3])),ht=Math.min(Math.max(H[1],H[3]),Math.max(W[1],W[3]));return Q>ht?null:[mt,Q,Et,ht]}static bezierBoundingBox(H,W,mt,Et,Q,ht,vt,St){const Rt=[],kt=[[],[]];let xt,Pt,Ft,Tt,Nt,Mt,Dt,Lt;for(let Ht=0;Ht<2;++Ht){if(Ht===0?(Pt=6*H-12*mt+6*Q,xt=-3*H+9*mt-9*Q+3*vt,Ft=3*mt-3*H):(Pt=6*W-12*Et+6*ht,xt=-3*W+9*Et-9*ht+3*St,Ft=3*Et-3*W),Math.abs(xt)<1e-12){if(Math.abs(Pt)<1e-12)continue;Tt=-Ft/Pt,0<Tt&&Tt<1&&Rt.push(Tt);continue}Dt=Pt*Pt-4*Ft*xt,Lt=Math.sqrt(Dt),!(Dt<0)&&(Nt=(-Pt+Lt)/(2*xt),0<Nt&&Nt<1&&Rt.push(Nt),Mt=(-Pt-Lt)/(2*xt),0<Mt&&Mt<1&&Rt.push(Mt))}let Bt=Rt.length,Ot;const jt=Bt;for(;Bt--;)Tt=Rt[Bt],Ot=1-Tt,kt[0][Bt]=Ot*Ot*Ot*H+3*Ot*Ot*Tt*mt+3*Ot*Tt*Tt*Q+Tt*Tt*Tt*vt,kt[1][Bt]=Ot*Ot*Ot*W+3*Ot*Ot*Tt*Et+3*Ot*Tt*Tt*ht+Tt*Tt*Tt*St;return kt[0][jt]=H,kt[1][jt]=W,kt[0][jt+1]=vt,kt[1][jt+1]=St,kt[0].length=kt[1].length=jt+2,[Math.min(...kt[0]),Math.min(...kt[1]),Math.max(...kt[0]),Math.max(...kt[1])]}}n.Util=rt;const at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function dt(F){if(F[0]>="\xEF"){let W;if(F[0]==="\xFE"&&F[1]==="\xFF"?W="utf-16be":F[0]==="\xFF"&&F[1]==="\xFE"?W="utf-16le":F[0]==="\xEF"&&F[1]==="\xBB"&&F[2]==="\xBF"&&(W="utf-8"),W)try{const mt=new TextDecoder(W,{fatal:!0}),Et=e(F);return mt.decode(Et)}catch(mt){ut(`stringToPDFString: "${mt}".`)}}const H=[];for(let W=0,mt=F.length;W<mt;W++){const Et=at[F.charCodeAt(W)];H.push(Et?String.fromCharCode(Et):F.charAt(W))}return H.join("")}function ct(F){return decodeURIComponent(escape(F))}function bt(F){return unescape(encodeURIComponent(F))}function gt(F){return typeof F=="object"&&F!==null&&F.byteLength!==void 0}function Ct(F,H){if(F.length!==H.length)return!1;for(let W=0,mt=F.length;W<mt;W++)if(F[W]!==H[W])return!1;return!0}function At(F=new Date){return[F.getUTCFullYear().toString(),(F.getUTCMonth()+1).toString().padStart(2,"0"),F.getUTCDate().toString().padStart(2,"0"),F.getUTCHours().toString().padStart(2,"0"),F.getUTCMinutes().toString().padStart(2,"0"),F.getUTCSeconds().toString().padStart(2,"0")].join("")}function wt(){const F=Object.create(null);let H=!1;return Object.defineProperty(F,"settled",{get(){return H}}),F.promise=new Promise(function(W,mt){F.resolve=function(Et){H=!0,W(Et)},F.reject=function(Et){H=!0,mt(Et)}}),F}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var v,L,i,y,$t,q,re,N,T,b,k,E,_,d,p,de,a,w,ue,S,t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:h,NodeCMapReaderFactory:r,NodeFilterFactory:g,NodeStandardFontDataFactory:x}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=h,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=r,exports.DefaultFilterFactory=DefaultFilterFactory=g,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=x}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:h}=__w_pdfjs_require__(21);createPDFNetworkStream=r=>new h(r)}else{const{PDFNetworkStream:h}=__w_pdfjs_require__(24),{PDFFetchStream:r}=__w_pdfjs_require__(25);createPDFNetworkStream=g=>(0,_display_utils.isValidFetchUrl)(g.url)?new r(g):new h(g)}function getDocument(h){var gt,Ct;if(typeof h=="string"||h instanceof URL?h={url:h}:(0,_util.isArrayBuffer)(h)&&(h={data:h}),typeof h!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!h.url&&!h.data&&!h.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const r=new PDFDocumentLoadingTask,{docId:g}=r,x=h.url?getUrlProp(h.url):null,o=h.data?getDataProp(h.data):null,D=h.httpHeaders||null,z=h.withCredentials===!0,K=(gt=h.password)!=null?gt:null,tt=h.range instanceof PDFDataRangeTransport?h.range:null,it=Number.isInteger(h.rangeChunkSize)&&h.rangeChunkSize>0?h.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let ft=h.worker instanceof PDFWorker?h.worker:null;const lt=h.verbosity,ut=typeof h.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(h.docBaseUrl)?h.docBaseUrl:null,_t=typeof h.cMapUrl=="string"?h.cMapUrl:null,yt=h.cMapPacked!==!1,G=h.CMapReaderFactory||DefaultCMapReaderFactory,u=typeof h.standardFontDataUrl=="string"?h.standardFontDataUrl:null,f=h.StandardFontDataFactory||DefaultStandardFontDataFactory,C=h.stopAtErrors!==!0,V=Number.isInteger(h.maxImageSize)&&h.maxImageSize>-1?h.maxImageSize:-1,I=h.isEvalSupported!==!1,$=typeof h.isOffscreenCanvasSupported=="boolean"?h.isOffscreenCanvasSupported:!_is_node.isNodeJS,X=Number.isInteger(h.canvasMaxAreaInBytes)?h.canvasMaxAreaInBytes:-1,J=typeof h.disableFontFace=="boolean"?h.disableFontFace:_is_node.isNodeJS,Y=h.fontExtraProperties===!0,j=h.enableXfa===!0,M=h.ownerDocument||globalThis.document,e=h.disableRange===!0,l=h.disableStream===!0,A=h.disableAutoFetch===!0,P=h.pdfBug===!0,O=tt?tt.length:(Ct=h.length)!=null?Ct:NaN,U=typeof h.useSystemFonts=="boolean"?h.useSystemFonts:!_is_node.isNodeJS&&!J,nt=typeof h.useWorkerFetch=="boolean"?h.useWorkerFetch:G===_display_utils.DOMCMapReaderFactory&&f===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(_t,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(u,document.baseURI),st=h.canvasFactory||new DefaultCanvasFactory({ownerDocument:M}),rt=h.filterFactory||new DefaultFilterFactory({docId:g,ownerDocument:M}),at=null;(0,_util.setVerbosityLevel)(lt);const dt={canvasFactory:st,filterFactory:rt};if(nt||(dt.cMapReaderFactory=new G({baseUrl:_t,isCompressed:yt}),dt.standardFontDataFactory=new f({baseUrl:u})),!ft){const At={verbosity:lt,port:_worker_options.GlobalWorkerOptions.workerPort};ft=At.port?PDFWorker.fromPort(At):new PDFWorker(At),r._worker=ft}const ct={docId:g,apiVersion:"3.5.141",data:o,password:K,disableAutoFetch:A,rangeChunkSize:it,length:O,docBaseUrl:ut,enableXfa:j,evaluatorOptions:{maxImageSize:V,disableFontFace:J,ignoreErrors:C,isEvalSupported:I,isOffscreenCanvasSupported:$,canvasMaxAreaInBytes:X,fontExtraProperties:Y,useSystemFonts:U,cMapUrl:nt?_t:null,standardFontDataUrl:nt?u:null}},bt={ignoreErrors:C,isEvalSupported:I,disableFontFace:J,fontExtraProperties:Y,enableXfa:j,ownerDocument:M,disableAutoFetch:A,pdfBug:P,styleElement:at};return ft.promise.then(function(){if(r.destroyed)throw new Error("Loading aborted");const At=_fetchDocument(ft,ct),wt=new Promise(function(F){let H;tt?H=new _transport_stream.PDFDataTransportStream({length:O,initialData:tt.initialData,progressiveDone:tt.progressiveDone,contentDispositionFilename:tt.contentDispositionFilename,disableRange:e,disableStream:l},tt):o||(H=createPDFNetworkStream({url:x,length:O,httpHeaders:D,withCredentials:z,rangeChunkSize:it,disableRange:e,disableStream:l})),F(H)});return Promise.all([At,wt]).then(function([F,H]){if(r.destroyed)throw new Error("Loading aborted");const W=new _message_handler.MessageHandler(g,F,ft.port),mt=new WorkerTransport(W,r,H,bt,dt);r._transport=mt,W.send("Ready",null)})}).catch(r._capability.reject),r}async function _fetchDocument(h,r){if(h.destroyed)throw new Error("Worker was destroyed");const g=await h.messageHandler.sendWithPromise("GetDocRequest",r,r.data?[r.data.buffer]:null);if(h.destroyed)throw new Error("Worker was destroyed");return g}function getUrlProp(h){if(h instanceof URL)return h.href;try{return new URL(h,window.location).href}catch{if(_is_node.isNodeJS&&typeof h=="string")return h}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(h){if(_is_node.isNodeJS&&typeof Buffer<"u"&&h instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(h);if(h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength)return h;if(typeof h=="string")return(0,_util.stringToBytes)(h);if(typeof h=="object"&&!isNaN(h==null?void 0:h.length)||(0,_util.isArrayBuffer)(h))return new Uint8Array(h);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const n=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ie(n,v)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var r;this.destroyed=!0,await((r=this._transport)==null?void 0:r.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=n;v=new WeakMap,et(PDFDocumentLoadingTask,v,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(r,g,x=!1,o=null){this.length=r,this.initialData=g,this.progressiveDone=x,this.contentDispositionFilename=o,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(r){this._rangeListeners.push(r)}addProgressListener(r){this._progressListeners.push(r)}addProgressiveReadListener(r){this._progressiveReadListeners.push(r)}addProgressiveDoneListener(r){this._progressiveDoneListeners.push(r)}onDataRange(r,g){for(const x of this._rangeListeners)x(r,g)}onDataProgress(r,g){this._readyCapability.promise.then(()=>{for(const x of this._progressListeners)x(r,g)})}onDataProgressiveRead(r){this._readyCapability.promise.then(()=>{for(const g of this._progressiveReadListeners)g(r)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const r of this._progressiveDoneListeners)r()})}transportReady(){this._readyCapability.resolve()}requestDataRange(r,g){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(r,g){this._pdfInfo=r,this._transport=g}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(r){return this._transport.getPage(r)}getPageIndex(r){return this._transport.getPageIndex(r)}getDestinations(){return this._transport.getDestinations()}getDestination(r){return this._transport.getDestination(r)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(r=!1){return this._transport.startCleanup(r||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(r,g,x,o=!1){et(this,y);et(this,q);et(this,L,null);et(this,i,!1);this._pageIndex=r,this._pageInfo=g,this._transport=x,this._stats=o?new _display_utils.StatTimer:null,this._pdfBug=o,this.commonObjs=x.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:r,rotation:g=this.rotate,offsetX:x=0,offsetY:o=0,dontFlip:D=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:r,rotation:g,offsetX:x,offsetY:o,dontFlip:D})}getAnnotations({intent:r="display"}={}){const g=this._transport.getRenderingIntent(r);return this._transport.getAnnotations(this._pageIndex,g.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var r;return((r=this._transport._htmlForXfa)==null?void 0:r.children[this._pageIndex])||null}render({canvasContext:r,viewport:g,intent:x="display",annotationMode:o=_util.AnnotationMode.ENABLE,transform:D=null,background:z=null,optionalContentConfigPromise:K=null,annotationCanvasMap:tt=null,pageColors:it=null,printAnnotationStorage:ft=null}){var f,C,V;if((f=arguments[0])!=null&&f.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");(C=this._stats)==null||C.time("Overall");const lt=this._transport.getRenderingIntent(x,o,ft);pt(this,i,!1),ot(this,q,re).call(this),K||(K=this._transport.getOptionalContentConfig());let ut=this._intentStates.get(lt.cacheKey);ut||(ut=Object.create(null),this._intentStates.set(lt.cacheKey,ut)),ut.streamReaderCancelTimeout&&(clearTimeout(ut.streamReaderCancelTimeout),ut.streamReaderCancelTimeout=null);const _t=!!(lt.renderingIntent&_util.RenderingIntentFlag.PRINT);ut.displayReadyCapability||(ut.displayReadyCapability=(0,_util.createPromiseCapability)(),ut.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(V=this._stats)==null||V.time("Page Request"),this._pumpOperatorList(lt));const yt=I=>{var $,X;ut.renderTasks.delete(G),(this._maybeCleanupAfterRender||_t)&&pt(this,i,!0),ot(this,y,$t).call(this,!_t),I?(G.capability.reject(I),this._abortOperatorList({intentState:ut,reason:I instanceof Error?I:new Error(I)})):G.capability.resolve(),($=this._stats)==null||$.timeEnd("Rendering"),(X=this._stats)==null||X.timeEnd("Overall")},G=new InternalRenderTask({callback:yt,params:{canvasContext:r,viewport:g,transform:D,background:z},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:tt,operatorList:ut.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_t,pdfBug:this._pdfBug,pageColors:it});(ut.renderTasks||(ut.renderTasks=new Set)).add(G);const u=G.task;return Promise.all([ut.displayReadyCapability.promise,K]).then(([I,$])=>{var X;if(m(this,i)){yt();return}(X=this._stats)==null||X.time("Rendering"),G.initializeGraphics({transparency:I,optionalContentConfig:$}),G.operatorListChanged()}).catch(yt),u}getOperatorList({intent:r="display",annotationMode:g=_util.AnnotationMode.ENABLE,printAnnotationStorage:x=null}={}){var tt;function o(){z.operatorList.lastChunk&&(z.opListReadCapability.resolve(z.operatorList),z.renderTasks.delete(K))}const D=this._transport.getRenderingIntent(r,g,x,!0);let z=this._intentStates.get(D.cacheKey);z||(z=Object.create(null),this._intentStates.set(D.cacheKey,z));let K;return z.opListReadCapability||(K=Object.create(null),K.operatorListChanged=o,z.opListReadCapability=(0,_util.createPromiseCapability)(),(z.renderTasks||(z.renderTasks=new Set)).add(K),z.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(tt=this._stats)==null||tt.time("Page Request"),this._pumpOperatorList(D)),z.opListReadCapability.promise}streamTextContent({includeMarkedContent:r=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:r===!0},{highWaterMark:100,size(x){return x.items.length}})}getTextContent(r={}){if(this._transport._htmlForXfa)return this.getXfa().then(x=>_xfa_text.XfaText.textContent(x));const g=this.streamTextContent(r);return new Promise(function(x,o){function D(){z.read().then(function({value:tt,done:it}){if(it){x(K);return}Object.assign(K.styles,tt.styles),K.items.push(...tt.items),D()},o)}const z=g.getReader(),K={items:[],styles:Object.create(null)};D()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const r=[];for(const g of this._intentStates.values())if(this._abortOperatorList({intentState:g,reason:new Error("Page was destroyed."),force:!0}),!g.opListReadCapability)for(const x of g.renderTasks)r.push(x.completed),x.cancel();return this.objs.clear(),pt(this,i,!1),ot(this,q,re).call(this),Promise.all(r)}cleanup(r=!1){pt(this,i,!0);const g=ot(this,y,$t).call(this,!1);return r&&g&&this._stats&&(this._stats=new _display_utils.StatTimer),g}_startRenderPage(r,g){var o,D;const x=this._intentStates.get(g);!x||((o=this._stats)==null||o.timeEnd("Page Request"),(D=x.displayReadyCapability)==null||D.resolve(r))}_renderPageChunk(r,g){for(let x=0,o=r.length;x<o;x++)g.operatorList.fnArray.push(r.fnArray[x]),g.operatorList.argsArray.push(r.argsArray[x]);g.operatorList.lastChunk=r.lastChunk,g.operatorList.separateAnnots=r.separateAnnots;for(const x of g.renderTasks)x.operatorListChanged();r.lastChunk&&ot(this,y,$t).call(this,!0)}_pumpOperatorList({renderingIntent:r,cacheKey:g,annotationStorageMap:x}){const D=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:r,cacheKey:g,annotationStorage:x}).getReader(),z=this._intentStates.get(g);z.streamReader=D;const K=()=>{D.read().then(({value:tt,done:it})=>{if(it){z.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(tt,z),K())},tt=>{if(z.streamReader=null,!this._transport.destroyed){if(z.operatorList){z.operatorList.lastChunk=!0;for(const it of z.renderTasks)it.operatorListChanged();ot(this,y,$t).call(this,!0)}if(z.displayReadyCapability)z.displayReadyCapability.reject(tt);else if(z.opListReadCapability)z.opListReadCapability.reject(tt);else throw tt}})};K()}_abortOperatorList({intentState:r,reason:g,force:x=!1}){if(!!r.streamReader){if(r.streamReaderCancelTimeout&&(clearTimeout(r.streamReaderCancelTimeout),r.streamReaderCancelTimeout=null),!x){if(r.renderTasks.size>0)return;if(g instanceof _display_utils.RenderingCancelledException){let o=RENDERING_CANCELLED_TIMEOUT;g.extraDelay>0&&g.extraDelay<1e3&&(o+=g.extraDelay),r.streamReaderCancelTimeout=setTimeout(()=>{r.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:r,reason:g,force:!0})},o);return}}if(r.streamReader.cancel(new _util.AbortException(g.message)).catch(()=>{}),r.streamReader=null,!this._transport.destroyed){for(const[o,D]of this._intentStates)if(D===r){this._intentStates.delete(o);break}this.cleanup()}}}get stats(){return this._stats}}L=new WeakMap,i=new WeakMap,y=new WeakSet,$t=function(r=!1){if(ot(this,q,re).call(this),!m(this,i))return!1;if(r)return pt(this,L,setTimeout(()=>{pt(this,L,null),ot(this,y,$t).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:g,operatorList:x}of this._intentStates.values())if(g.size>0||!x.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),pt(this,i,!1),!0},q=new WeakSet,re=function(){m(this,L)&&(clearTimeout(m(this,L)),pt(this,L,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){et(this,N,new Set);et(this,T,Promise.resolve())}postMessage(r,g){const x={data:structuredClone(r,g?{transfer:g}:null)};m(this,T).then(()=>{for(const o of m(this,N))o.call(this,x)})}addEventListener(r,g){m(this,N).add(g)}removeEventListener(r,g){m(this,N).delete(g)}terminate(){m(this,N).clear()}}N=new WeakMap,T=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const h=(b=document==null?void 0:document.currentScript)==null?void 0:b.src;h&&(PDFWorkerUtil.fallbackWorkerSrc=h.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(h,r){let g;try{if(g=new URL(h),!g.origin||g.origin==="null")return!1}catch{return!1}const x=new URL(r,g);return g.origin===x.origin},PDFWorkerUtil.createCDNWrapper=function(h){const r=`importScripts("${h}");`;return URL.createObjectURL(new Blob([r]))}}const _PDFWorker=class{constructor({name:h=null,port:r=null,verbosity:g=(0,_util.getVerbosityLevel)()}={}){if(r&&m(_PDFWorker,k).has(r))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=h,this.destroyed=!1,this.verbosity=g,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,r){m(_PDFWorker,k).set(r,this),this._initializeFromPort(r);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(h){this._port=h,this._messageHandler=new _message_handler.MessageHandler("main","worker",h),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:h}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,h)||(h=PDFWorkerUtil.createCDNWrapper(new URL(h,window.location).href));const r=new Worker(h),g=new _message_handler.MessageHandler("main","worker",r),x=()=>{r.removeEventListener("error",o),g.destroy(),r.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},o=()=>{this._webWorker||x()};r.addEventListener("error",o),g.on("test",z=>{if(r.removeEventListener("error",o),this.destroyed){x();return}z?(this._messageHandler=g,this._port=r,this._webWorker=r,this._readyCapability.resolve(),g.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),g.destroy(),r.terminate())}),g.on("ready",z=>{if(r.removeEventListener("error",o),this.destroyed){x();return}try{D()}catch{this._setupFakeWorker()}});const D=()=>{const z=new Uint8Array;g.send("test",z,[z.buffer])};D();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(h=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const r=new LoopbackPort;this._port=r;const g=`fake${PDFWorkerUtil.fakeWorkerId++}`,x=new _message_handler.MessageHandler(g+"_worker",g,r);h.setup(x,r);const o=new _message_handler.MessageHandler(g,g+"_worker",r);this._messageHandler=o,this._readyCapability.resolve(),o.send("configure",{verbosity:this.verbosity})}).catch(h=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${h.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),m(_PDFWorker,k).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(h){if(!(h!=null&&h.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return m(this,k).has(h.port)?m(this,k).get(h.port):new _PDFWorker(h)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var h;try{return((h=globalThis.pdfjsWorker)==null?void 0:h.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;k=new WeakMap,et(PDFWorker,k,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(r,g,x,o,D){et(this,p);et(this,E,new Map);et(this,_,new Map);et(this,d,new Map);this.messageHandler=r,this.loadingTask=g,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:o.ownerDocument,styleElement:o.styleElement}),this._params=o,this.canvasFactory=D.canvasFactory,this.filterFactory=D.filterFactory,this.cMapReaderFactory=D.cMapReaderFactory,this.standardFontDataFactory=D.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=x,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(r,g=_util.AnnotationMode.ENABLE,x=null,o=!1){let D=_util.RenderingIntentFlag.DISPLAY,z=null;switch(r){case"any":D=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":D=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${r}`)}switch(g){case _util.AnnotationMode.DISABLE:D+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:D+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:D+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,z=(D&_util.RenderingIntentFlag.PRINT&&x instanceof _annotation_storage.PrintAnnotationStorage?x:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${g}`)}return o&&(D+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:D,cacheKey:`${D}_${_annotation_storage.AnnotationStorage.getHash(z)}`,annotationStorageMap:z}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const r=[];for(const x of m(this,_).values())r.push(x._destroy());m(this,_).clear(),m(this,d).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const g=this.messageHandler.sendWithPromise("Terminate",null);return r.push(g),Promise.all(r).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),m(this,E).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:r,loadingTask:g}=this;r.on("GetReader",(x,o)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=D=>{this._lastProgress={loaded:D.loaded,total:D.total}},o.onPull=()=>{this._fullReader.read().then(function({value:D,done:z}){if(z){o.close();return}(0,_util.assert)(D instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(D),1,[D])}).catch(D=>{o.error(D)})},o.onCancel=D=>{this._fullReader.cancel(D),o.ready.catch(z=>{if(!this.destroyed)throw z})}}),r.on("ReaderHeadersReady",x=>{const o=(0,_util.createPromiseCapability)(),D=this._fullReader;return D.headersReady.then(()=>{var z;(!D.isStreamingSupported||!D.isRangeSupported)&&(this._lastProgress&&((z=g.onProgress)==null||z.call(g,this._lastProgress)),D.onProgress=K=>{var tt;(tt=g.onProgress)==null||tt.call(g,{loaded:K.loaded,total:K.total})}),o.resolve({isStreamingSupported:D.isStreamingSupported,isRangeSupported:D.isRangeSupported,contentLength:D.contentLength})},o.reject),o.promise}),r.on("GetRangeReader",(x,o)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const D=this._networkStream.getRangeReader(x.begin,x.end);if(!D){o.close();return}o.onPull=()=>{D.read().then(function({value:z,done:K}){if(K){o.close();return}(0,_util.assert)(z instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(z),1,[z])}).catch(z=>{o.error(z)})},o.onCancel=z=>{D.cancel(z),o.ready.catch(K=>{if(!this.destroyed)throw K})}}),r.on("GetDoc",({pdfInfo:x})=>{this._numPages=x.numPages,this._htmlForXfa=x.htmlForXfa,delete x.htmlForXfa,g._capability.resolve(new PDFDocumentProxy(x,this))}),r.on("DocException",function(x){let o;switch(x.name){case"PasswordException":o=new _util.PasswordException(x.message,x.code);break;case"InvalidPDFException":o=new _util.InvalidPDFException(x.message);break;case"MissingPDFException":o=new _util.MissingPDFException(x.message);break;case"UnexpectedResponseException":o=new _util.UnexpectedResponseException(x.message,x.status);break;case"UnknownErrorException":o=new _util.UnknownErrorException(x.message,x.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}g._capability.reject(o)}),r.on("PasswordRequest",x=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),g.onPassword){const o=D=>{D instanceof Error?this._passwordCapability.reject(D):this._passwordCapability.resolve({password:D})};try{g.onPassword(o,x.code)}catch(D){this._passwordCapability.reject(D)}}else this._passwordCapability.reject(new _util.PasswordException(x.message,x.code));return this._passwordCapability.promise}),r.on("DataLoaded",x=>{var o;(o=g.onProgress)==null||o.call(g,{loaded:x.length,total:x.length}),this.downloadInfoCapability.resolve(x)}),r.on("StartRenderPage",x=>{if(this.destroyed)return;m(this,_).get(x.pageIndex)._startRenderPage(x.transparency,x.cacheKey)}),r.on("commonobj",([x,o,D])=>{var z;if(!this.destroyed&&!this.commonObjs.has(x))switch(o){case"Font":const K=this._params;if("error"in D){const ft=D.error;(0,_util.warn)(`Error during font loading: ${ft}`),this.commonObjs.resolve(x,ft);break}const tt=K.pdfBug&&((z=globalThis.FontInspector)==null?void 0:z.enabled)?(ft,lt)=>globalThis.FontInspector.fontAdded(ft,lt):null,it=new _font_loader.FontFaceObject(D,{isEvalSupported:K.isEvalSupported,disableFontFace:K.disableFontFace,ignoreErrors:K.ignoreErrors,inspectFont:tt});this.fontLoader.bind(it).catch(ft=>r.sendWithPromise("FontFallback",{id:x})).finally(()=>{!K.fontExtraProperties&&it.data&&(it.data=null),this.commonObjs.resolve(x,it)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(x,D);break;default:throw new Error(`Got unknown common object type ${o}`)}}),r.on("obj",([x,o,D,z])=>{var tt;if(this.destroyed)return;const K=m(this,_).get(o);if(!K.objs.has(x))switch(D){case"Image":if(K.objs.resolve(x,z),z){let it;if(z.bitmap){const{width:ft,height:lt}=z;it=ft*lt*4}else it=((tt=z.data)==null?void 0:tt.length)||0;it>_util.MAX_IMAGE_SIZE_TO_CACHE&&(K._maybeCleanupAfterRender=!0)}break;case"Pattern":K.objs.resolve(x,z);break;default:throw new Error(`Got unknown object type ${D}`)}}),r.on("DocProgress",x=>{var o;this.destroyed||(o=g.onProgress)==null||o.call(g,{loaded:x.loaded,total:x.total})}),r.on("FetchBuiltInCMap",x=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(x):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),r.on("FetchStandardFontData",x=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(x):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r,g;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(g=(r=this._fullReader)==null?void 0:r.filename)!=null?g:null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(r){if(!Number.isInteger(r)||r<=0||r>this._numPages)return Promise.reject(new Error("Invalid page request."));const g=r-1,x=m(this,d).get(g);if(x)return x;const o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:g}).then(D=>{if(this.destroyed)throw new Error("Transport destroyed");const z=new PDFPageProxy(g,D,this,this._params.pdfBug);return m(this,_).set(g,z),z});return m(this,d).set(g,o),o}getPageIndex(r){return typeof r!="object"||r===null||!Number.isInteger(r.num)||r.num<0||!Number.isInteger(r.gen)||r.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:r.num,gen:r.gen})}getAnnotations(r,g){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:r,intent:g})}getFieldObjects(){return ot(this,p,de).call(this,"GetFieldObjects")}hasJSActions(){return ot(this,p,de).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(r){return typeof r!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:r})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(r){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:r})}getStructTree(r){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:r})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(r=>new _optional_content_config.OptionalContentConfig(r))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const r="GetMetadata",g=m(this,E).get(r);if(g)return g;const x=this.messageHandler.sendWithPromise(r,null).then(o=>{var D,z,K,tt;return{info:o[0],metadata:o[1]?new _metadata.Metadata(o[1]):null,contentDispositionFilename:(z=(D=this._fullReader)==null?void 0:D.filename)!=null?z:null,contentLength:(tt=(K=this._fullReader)==null?void 0:K.contentLength)!=null?tt:null}});return m(this,E).set(r,x),x}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(r=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const g of m(this,_).values())if(!g.cleanup())throw new Error(`startCleanup: Page ${g.pageNumber} is currently rendering.`);this.commonObjs.clear(),r||this.fontLoader.clear(),m(this,E).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:r,enableXfa:g}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:r,enableXfa:g})}}E=new WeakMap,_=new WeakMap,d=new WeakMap,p=new WeakSet,de=function(r,g=null){const x=m(this,E).get(r);if(x)return x;const o=this.messageHandler.sendWithPromise(r,g);return m(this,E).set(r,o),o};class PDFObjects{constructor(){et(this,w);et(this,a,Object.create(null))}get(r,g=null){if(g){const o=ot(this,w,ue).call(this,r);return o.capability.promise.then(()=>g(o.data)),null}const x=m(this,a)[r];if(!(x!=null&&x.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${r}.`);return x.data}has(r){const g=m(this,a)[r];return(g==null?void 0:g.capability.settled)||!1}resolve(r,g=null){const x=ot(this,w,ue).call(this,r);x.data=g,x.capability.resolve()}clear(){var r;for(const g in m(this,a)){const{data:x}=m(this,a)[g];(r=x==null?void 0:x.bitmap)==null||r.close()}pt(this,a,Object.create(null))}}a=new WeakMap,w=new WeakSet,ue=function(r){const g=m(this,a)[r];return g||(m(this,a)[r]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(r){et(this,S,null);pt(this,S,r),this.onContinue=null}get promise(){return m(this,S).capability.promise}cancel(r=0){m(this,S).cancel(null,r)}get separateAnnots(){const{separateAnnots:r}=m(this,S).operatorList;if(!r)return!1;const{annotationCanvasMap:g}=m(this,S);return r.form||r.canvas&&(g==null?void 0:g.size)>0}}S=new WeakMap,exports.RenderTask=RenderTask;const c=class{constructor({callback:r,params:g,objs:x,commonObjs:o,annotationCanvasMap:D,operatorList:z,pageIndex:K,canvasFactory:tt,filterFactory:it,useRequestAnimationFrame:ft=!1,pdfBug:lt=!1,pageColors:ut=null}){this.callback=r,this.params=g,this.objs=x,this.commonObjs=o,this.annotationCanvasMap=D,this.operatorListIdx=null,this.operatorList=z,this._pageIndex=K,this.canvasFactory=tt,this.filterFactory=it,this._pdfBug=lt,this.pageColors=ut,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=ft===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=g.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:r=!1,optionalContentConfig:g}){var K,tt;if(this.cancelled)return;if(this._canvas){if(m(c,t).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");m(c,t).add(this._canvas)}this._pdfBug&&((K=globalThis.StepperManager)==null?void 0:K.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:x,viewport:o,transform:D,background:z}=this.params;this.gfx=new _canvas.CanvasGraphics(x,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:g},this.annotationCanvasMap),this.gfx.beginDrawing({transform:D,viewport:o,transparency:r,background:z}),this.operatorListIdx=0,this.graphicsReady=!0,(tt=this.graphicsReadyCallback)==null||tt.call(this)}cancel(r=null,g=0){var x;this.running=!1,this.cancelled=!0,(x=this.gfx)==null||x.endDrawing(this.pageColors),this._canvas&&m(c,t).delete(this._canvas),this.callback(r||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",g))}operatorListChanged(){var r;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(r=this.stepper)==null||r.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&m(c,t).delete(this._canvas),this.callback())))}};let InternalRenderTask=c;t=new WeakMap,et(InternalRenderTask,t,new WeakSet);const version="3.5.141";exports.version=version;const build="be0f6ee08";exports.build=build},(v,n,L)=>{var N,T,b,Me,E;Object.defineProperty(n,"__esModule",{value:!0}),n.PrintAnnotationStorage=n.AnnotationStorage=void 0;var i=L(1),y=L(4),B=L(8);class q{constructor(){et(this,b);et(this,N,!1);et(this,T,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(d,p){const s=m(this,T).get(d);return s===void 0?p:Object.assign(p,s)}getRawValue(d){return m(this,T).get(d)}remove(d){if(m(this,T).delete(d),m(this,T).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const p of m(this,T).values())if(p instanceof y.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(d,p){const s=m(this,T).get(d);let a=!1;if(s!==void 0)for(const[w,R]of Object.entries(p))s[w]!==R&&(a=!0,s[w]=R);else a=!0,m(this,T).set(d,p);a&&ot(this,b,Me).call(this),p instanceof y.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(p.constructor._type)}has(d){return m(this,T).has(d)}getAll(){return m(this,T).size>0?(0,i.objectFromMap)(m(this,T)):null}setAll(d){for(const[p,s]of Object.entries(d))this.setValue(p,s)}get size(){return m(this,T).size}resetModified(){m(this,N)&&(pt(this,N,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Z(this)}get serializable(){if(m(this,T).size===0)return null;const d=new Map;for(const[p,s]of m(this,T)){const a=s instanceof y.AnnotationEditor?s.serialize():s;a&&d.set(p,a)}return d}static getHash(d){if(!d)return"";const p=new B.MurmurHash3_64;for(const[s,a]of d)p.update(`${s}:${JSON.stringify(a)}`);return p.hexdigest()}}N=new WeakMap,T=new WeakMap,b=new WeakSet,Me=function(){m(this,N)||(pt(this,N,!0),typeof this.onSetModified=="function"&&this.onSetModified())},n.AnnotationStorage=q;class Z extends q{constructor(p){super();et(this,E,null);pt(this,E,structuredClone(p.serializable))}get print(){(0,i.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return m(this,E)}}E=new WeakMap,n.PrintAnnotationStorage=Z},(v,n,L)=>{var q,Z,N,T,b,k;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditor=void 0;var i=L(5),y=L(1);const E=class{constructor(d){et(this,q,this.focusin.bind(this));et(this,Z,this.focusout.bind(this));et(this,N,!1);et(this,T,!1);et(this,b,!1);It(this,"_uiManager",null);et(this,k,E._zIndex++);this.constructor===E&&(0,y.unreachable)("Cannot initialize AnnotationEditor."),this.parent=d.parent,this.id=d.id,this.width=this.height=null,this.pageIndex=d.parent.pageIndex,this.name=d.name,this.div=null,this._uiManager=d.uiManager;const{rotation:p,rawDims:{pageWidth:s,pageHeight:a,pageX:w,pageY:R}}=this.parent.viewport;this.rotation=p,this.pageDimensions=[s,a],this.pageTranslation=[w,R];const[S,t]=this.parentDimensions;this.x=d.x/S,this.y=d.y/t,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,y.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(d){this._uiManager.addCommands(d)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=m(this,k)}setParent(d){d!==null&&(this.pageIndex=d.pageIndex,this.pageDimensions=d.pageDimensions),this.parent=d}focusin(d){m(this,N)?pt(this,N,!1):this.parent.setSelected(this)}focusout(d){var s;if(!this.isAttachedToDOM)return;const p=d.relatedTarget;p!=null&&p.closest(`#${this.id}`)||(d.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(d){const p=this.parent.div.getBoundingClientRect();this.startX=d.clientX-p.x,this.startY=d.clientY-p.y,d.dataTransfer.setData("text/plain",this.id),d.dataTransfer.effectAllowed="move"}setAt(d,p,s,a){const[w,R]=this.parentDimensions;[s,a]=this.screenToPageTranslation(s,a),this.x=(d+s)/w,this.y=(p+a)/R,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(d,p){const[s,a]=this.parentDimensions;[d,p]=this.screenToPageTranslation(d,p),this.x+=d/s,this.y+=p/a,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(d,p){switch(this.parentRotation){case 90:return[p,-d];case 180:return[-d,-p];case 270:return[-p,d];default:return[d,p]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:d}=this._uiManager.viewParameters,[p,s]=this.pageDimensions;return[p*d,s*d]}setDims(d,p){const[s,a]=this.parentDimensions;this.div.style.width=`${100*d/s}%`,this.div.style.height=`${100*p/a}%`}fixDims(){const{style:d}=this.div,{height:p,width:s}=d,a=s.endsWith("%"),w=p.endsWith("%");if(a&&w)return;const[R,S]=this.parentDimensions;a||(d.width=`${100*parseFloat(s)/R}%`),w||(d.height=`${100*parseFloat(p)/S}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",m(this,q)),this.div.addEventListener("focusout",m(this,Z));const[d,p]=this.getInitialTranslation();return this.translate(d,p),(0,i.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(d){const{isMac:p}=y.FeatureTest.platform;if(d.button!==0||d.ctrlKey&&p){d.preventDefault();return}d.ctrlKey&&!p||d.shiftKey||d.metaKey&&p?this.parent.toggleSelected(this):this.parent.setSelected(this),pt(this,N,!0)}getRect(d,p){const s=this.parentScale,[a,w]=this.pageDimensions,[R,S]=this.pageTranslation,t=d/s,c=p/s,h=this.x*a,r=this.y*w,g=this.width*a,x=this.height*w;switch(this.rotation){case 0:return[h+t+R,w-r-c-x+S,h+t+g+R,w-r-c+S];case 90:return[h+c+R,w-r+t+S,h+c+x+R,w-r+t+g+S];case 180:return[h-t-g+R,w-r+c+S,h-t+R,w-r+c+x+S];case 270:return[h-c-x+R,w-r-t-g+S,h-c+R,w-r-t+S];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(d,p){const[s,a,w,R]=d,S=w-s,t=R-a;switch(this.rotation){case 0:return[s,p-R,S,t];case 90:return[s,p-a,t,S];case 180:return[w,p-a,S,t];case 270:return[w,p-R,t,S];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){pt(this,b,!0)}disableEditMode(){pt(this,b,!1)}isInEditMode(){return m(this,b)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var d;(d=this.div)==null||d.addEventListener("focusin",m(this,q))}serialize(){(0,y.unreachable)("An editor must be serializable")}static deserialize(d,p,s){const a=new this.prototype.constructor({parent:p,id:p.getNextId(),uiManager:s});a.rotation=d.rotation;const[w,R]=a.pageDimensions,[S,t,c,h]=a.getRectInCurrentCoords(d.rect,R);return a.x=S/w,a.y=t/R,a.width=c/w,a.height=h/R,a}remove(){this.div.removeEventListener("focusin",m(this,q)),this.div.removeEventListener("focusout",m(this,Z)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var d;(d=this.div)==null||d.classList.add("selectedEditor")}unselect(){var d;(d=this.div)==null||d.classList.remove("selectedEditor")}updateParams(d,p){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return m(this,T)}set isEditing(d){pt(this,T,d),d?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let B=E;q=new WeakMap,Z=new WeakMap,N=new WeakMap,T=new WeakMap,b=new WeakMap,k=new WeakMap,It(B,"_colorManager",new i.ColorManager),It(B,"_zIndex",1),n.AnnotationEditor=B},(v,n,L)=>{var E,_,d,p,s,a,Ie,S,t,c,h,r,g,x,o,D,z,K,tt,it,ft,lt,ut,_t,yt,G,u,f,C,V,I,De,X,fe,Y,Oe,M,Le,l,Vt,P,Jt,U,Ne,st,Be,at,pe,ct,Qt,gt,ge;Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardManager=n.CommandManager=n.ColorManager=n.AnnotationEditorUIManager=void 0,n.bindEvents=B,n.opacityToHex=q;var i=L(1),y=L(6);function B(wt,F,H){for(const W of H)F.addEventListener(W,wt[W].bind(wt))}function q(wt){return Math.round(Math.min(255,Math.max(1,255*wt))).toString(16).padStart(2,"0")}class Z{constructor(){et(this,E,0)}getId(){return`${i.AnnotationEditorPrefix}${ie(this,E)._++}`}}E=new WeakMap;class N{constructor(F=128){et(this,_,[]);et(this,d,!1);et(this,p,void 0);et(this,s,-1);pt(this,p,F)}add({cmd:F,undo:H,mustExec:W,type:mt=NaN,overwriteIfSameType:Et=!1,keepUndo:Q=!1}){if(W&&F(),m(this,d))return;const ht={cmd:F,undo:H,type:mt};if(m(this,s)===-1){m(this,_).length>0&&(m(this,_).length=0),pt(this,s,0),m(this,_).push(ht);return}if(Et&&m(this,_)[m(this,s)].type===mt){Q&&(ht.undo=m(this,_)[m(this,s)].undo),m(this,_)[m(this,s)]=ht;return}const vt=m(this,s)+1;vt===m(this,p)?m(this,_).splice(0,1):(pt(this,s,vt),vt<m(this,_).length&&m(this,_).splice(vt)),m(this,_).push(ht)}undo(){m(this,s)!==-1&&(pt(this,d,!0),m(this,_)[m(this,s)].undo(),pt(this,d,!1),pt(this,s,m(this,s)-1))}redo(){m(this,s)<m(this,_).length-1&&(pt(this,s,m(this,s)+1),pt(this,d,!0),m(this,_)[m(this,s)].cmd(),pt(this,d,!1))}hasSomethingToUndo(){return m(this,s)!==-1}hasSomethingToRedo(){return m(this,s)<m(this,_).length-1}destroy(){pt(this,_,null)}}_=new WeakMap,d=new WeakMap,p=new WeakMap,s=new WeakMap,n.CommandManager=N;class T{constructor(F){et(this,a);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:H}=i.FeatureTest.platform;for(const[W,mt]of F)for(const Et of W){const Q=Et.startsWith("mac+");H&&Q?(this.callbacks.set(Et.slice(4),mt),this.allKeys.add(Et.split("+").at(-1))):!H&&!Q&&(this.callbacks.set(Et,mt),this.allKeys.add(Et.split("+").at(-1)))}}exec(F,H){if(!this.allKeys.has(H.key))return;const W=this.callbacks.get(ot(this,a,Ie).call(this,H));!W||(W.bind(F)(),H.stopPropagation(),H.preventDefault())}}a=new WeakSet,Ie=function(F){F.altKey&&this.buffer.push("alt"),F.ctrlKey&&this.buffer.push("ctrl"),F.metaKey&&this.buffer.push("meta"),F.shiftKey&&this.buffer.push("shift"),this.buffer.push(F.key);const H=this.buffer.join("+");return this.buffer.length=0,H},n.KeyboardManager=T;const R=class{get _colors(){const F=new Map([["CanvasText",null],["Canvas",null]]);return(0,y.getColorValues)(F),(0,i.shadow)(this,"_colors",F)}convert(F){const H=(0,y.getRGB)(F);if(!window.matchMedia("(forced-colors: active)").matches)return H;for(const[W,mt]of this._colors)if(mt.every((Et,Q)=>Et===H[Q]))return R._colorsMapping.get(W);return H}getHexCode(F){const H=this._colors.get(F);return H?i.Util.makeHexColor(...H):F}};let b=R;It(b,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),n.ColorManager=b;const At=class{constructor(F,H,W){et(this,I);et(this,X);et(this,Y);et(this,M);et(this,l);et(this,P);et(this,U);et(this,st);et(this,at);et(this,ct);et(this,gt);et(this,S,null);et(this,t,new Map);et(this,c,new Map);et(this,h,null);et(this,r,new N);et(this,g,0);et(this,x,null);et(this,o,new Set);et(this,D,null);et(this,z,new Z);et(this,K,!1);et(this,tt,i.AnnotationEditorType.NONE);et(this,it,new Set);et(this,ft,this.copy.bind(this));et(this,lt,this.cut.bind(this));et(this,ut,this.paste.bind(this));et(this,_t,this.keydown.bind(this));et(this,yt,this.onEditingAction.bind(this));et(this,G,this.onPageChanging.bind(this));et(this,u,this.onScaleChanging.bind(this));et(this,f,this.onRotationChanging.bind(this));et(this,C,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});et(this,V,null);pt(this,V,F),pt(this,D,H),m(this,D)._on("editingaction",m(this,yt)),m(this,D)._on("pagechanging",m(this,G)),m(this,D)._on("scalechanging",m(this,u)),m(this,D)._on("rotationchanging",m(this,f)),pt(this,h,W),this.viewParameters={realScale:y.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){ot(this,X,fe).call(this),m(this,D)._off("editingaction",m(this,yt)),m(this,D)._off("pagechanging",m(this,G)),m(this,D)._off("scalechanging",m(this,u)),m(this,D)._off("rotationchanging",m(this,f));for(const F of m(this,c).values())F.destroy();m(this,c).clear(),m(this,t).clear(),m(this,o).clear(),pt(this,S,null),m(this,it).clear(),m(this,r).destroy()}onPageChanging({pageNumber:F}){pt(this,g,F-1)}focusMainContainer(){m(this,V).focus()}addShouldRescale(F){m(this,o).add(F)}removeShouldRescale(F){m(this,o).delete(F)}onScaleChanging({scale:F}){this.commitOrRemove(),this.viewParameters.realScale=F*y.PixelsPerInch.PDF_TO_CSS_UNITS;for(const H of m(this,o))H.onScaleChanging()}onRotationChanging({pagesRotation:F}){this.commitOrRemove(),this.viewParameters.rotation=F}addToAnnotationStorage(F){!F.isEmpty()&&m(this,h)&&!m(this,h).has(F.id)&&m(this,h).setValue(F.id,F)}copy(F){if(F.preventDefault(),m(this,S)&&m(this,S).commitOrRemove(),!this.hasSelection)return;const H=[];for(const W of m(this,it))W.isEmpty()||H.push(W.serialize());H.length!==0&&F.clipboardData.setData("application/pdfjs",JSON.stringify(H))}cut(F){this.copy(F),this.delete()}paste(F){F.preventDefault();let H=F.clipboardData.getData("application/pdfjs");if(!H)return;try{H=JSON.parse(H)}catch(mt){(0,i.warn)(`paste: "${mt.message}".`);return}if(!Array.isArray(H))return;this.unselectAll();const W=m(this,c).get(m(this,g));try{const mt=[];for(const ht of H){const vt=W.deserialize(ht);if(!vt)return;mt.push(vt)}const Et=()=>{for(const ht of mt)ot(this,at,pe).call(this,ht);ot(this,gt,ge).call(this,mt)},Q=()=>{for(const ht of mt)ht.remove()};this.addCommands({cmd:Et,undo:Q,mustExec:!0})}catch(mt){(0,i.warn)(`paste: "${mt.message}".`)}}keydown(F){var H;(H=this.getActive())!=null&&H.shouldGetKeyboardEvents()||At._keyboardManager.exec(this,F)}onEditingAction(F){["undo","redo","delete","selectAll"].includes(F.name)&&this[F.name]()}setEditingState(F){F?(ot(this,I,De).call(this),ot(this,Y,Oe).call(this),ot(this,l,Vt).call(this,{isEditing:m(this,tt)!==i.AnnotationEditorType.NONE,isEmpty:ot(this,ct,Qt).call(this),hasSomethingToUndo:m(this,r).hasSomethingToUndo(),hasSomethingToRedo:m(this,r).hasSomethingToRedo(),hasSelectedEditor:!1})):(ot(this,X,fe).call(this),ot(this,M,Le).call(this),ot(this,l,Vt).call(this,{isEditing:!1}))}registerEditorTypes(F){if(!m(this,x)){pt(this,x,F);for(const H of m(this,x))ot(this,P,Jt).call(this,H.defaultPropertiesToUpdate)}}getId(){return m(this,z).getId()}get currentLayer(){return m(this,c).get(m(this,g))}get currentPageIndex(){return m(this,g)}addLayer(F){m(this,c).set(F.pageIndex,F),m(this,K)?F.enable():F.disable()}removeLayer(F){m(this,c).delete(F.pageIndex)}updateMode(F){if(pt(this,tt,F),F===i.AnnotationEditorType.NONE)this.setEditingState(!1),ot(this,st,Be).call(this);else{this.setEditingState(!0),ot(this,U,Ne).call(this);for(const H of m(this,c).values())H.updateMode(F)}}updateToolbar(F){F!==m(this,tt)&&m(this,D).dispatch("switchannotationeditormode",{source:this,mode:F})}updateParams(F,H){if(!!m(this,x)){for(const W of m(this,it))W.updateParams(F,H);for(const W of m(this,x))W.updateDefaultParams(F,H)}}getEditors(F){const H=[];for(const W of m(this,t).values())W.pageIndex===F&&H.push(W);return H}getEditor(F){return m(this,t).get(F)}addEditor(F){m(this,t).set(F.id,F)}removeEditor(F){var H;m(this,t).delete(F.id),this.unselect(F),(H=m(this,h))==null||H.remove(F.id)}setActiveEditor(F){m(this,S)!==F&&(pt(this,S,F),F&&ot(this,P,Jt).call(this,F.propertiesToUpdate))}toggleSelected(F){if(m(this,it).has(F)){m(this,it).delete(F),F.unselect(),ot(this,l,Vt).call(this,{hasSelectedEditor:this.hasSelection});return}m(this,it).add(F),F.select(),ot(this,P,Jt).call(this,F.propertiesToUpdate),ot(this,l,Vt).call(this,{hasSelectedEditor:!0})}setSelected(F){for(const H of m(this,it))H!==F&&H.unselect();m(this,it).clear(),m(this,it).add(F),F.select(),ot(this,P,Jt).call(this,F.propertiesToUpdate),ot(this,l,Vt).call(this,{hasSelectedEditor:!0})}isSelected(F){return m(this,it).has(F)}unselect(F){F.unselect(),m(this,it).delete(F),ot(this,l,Vt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return m(this,it).size!==0}undo(){m(this,r).undo(),ot(this,l,Vt).call(this,{hasSomethingToUndo:m(this,r).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ot(this,ct,Qt).call(this)})}redo(){m(this,r).redo(),ot(this,l,Vt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:m(this,r).hasSomethingToRedo(),isEmpty:ot(this,ct,Qt).call(this)})}addCommands(F){m(this,r).add(F),ot(this,l,Vt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ot(this,ct,Qt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const F=[...m(this,it)],H=()=>{for(const mt of F)mt.remove()},W=()=>{for(const mt of F)ot(this,at,pe).call(this,mt)};this.addCommands({cmd:H,undo:W,mustExec:!0})}commitOrRemove(){var F;(F=m(this,S))==null||F.commitOrRemove()}selectAll(){for(const F of m(this,it))F.commit();ot(this,gt,ge).call(this,m(this,t).values())}unselectAll(){if(m(this,S)){m(this,S).commitOrRemove();return}if(m(this,it).size!==0){for(const F of m(this,it))F.unselect();m(this,it).clear(),ot(this,l,Vt).call(this,{hasSelectedEditor:!1})}}isActive(F){return m(this,S)===F}getActive(){return m(this,S)}getMode(){return m(this,tt)}};let k=At;S=new WeakMap,t=new WeakMap,c=new WeakMap,h=new WeakMap,r=new WeakMap,g=new WeakMap,x=new WeakMap,o=new WeakMap,D=new WeakMap,z=new WeakMap,K=new WeakMap,tt=new WeakMap,it=new WeakMap,ft=new WeakMap,lt=new WeakMap,ut=new WeakMap,_t=new WeakMap,yt=new WeakMap,G=new WeakMap,u=new WeakMap,f=new WeakMap,C=new WeakMap,V=new WeakMap,I=new WeakSet,De=function(){m(this,V).addEventListener("keydown",m(this,_t))},X=new WeakSet,fe=function(){m(this,V).removeEventListener("keydown",m(this,_t))},Y=new WeakSet,Oe=function(){document.addEventListener("copy",m(this,ft)),document.addEventListener("cut",m(this,lt)),document.addEventListener("paste",m(this,ut))},M=new WeakSet,Le=function(){document.removeEventListener("copy",m(this,ft)),document.removeEventListener("cut",m(this,lt)),document.removeEventListener("paste",m(this,ut))},l=new WeakSet,Vt=function(F){Object.entries(F).some(([W,mt])=>m(this,C)[W]!==mt)&&m(this,D).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(m(this,C),F)})},P=new WeakSet,Jt=function(F){m(this,D).dispatch("annotationeditorparamschanged",{source:this,details:F})},U=new WeakSet,Ne=function(){if(!m(this,K)){pt(this,K,!0);for(const F of m(this,c).values())F.enable()}},st=new WeakSet,Be=function(){if(this.unselectAll(),m(this,K)){pt(this,K,!1);for(const F of m(this,c).values())F.disable()}},at=new WeakSet,pe=function(F){const H=m(this,c).get(F.pageIndex);H?H.addOrRebuild(F):this.addEditor(F)},ct=new WeakSet,Qt=function(){if(m(this,t).size===0)return!0;if(m(this,t).size===1)for(const F of m(this,t).values())return F.isEmpty();return!1},gt=new WeakSet,ge=function(F){m(this,it).clear();for(const H of F)H.isEmpty()||(m(this,it).add(H),H.select());ot(this,l,Vt).call(this,{hasSelectedEditor:!0})},It(k,"_keyboardManager",new T([[["ctrl+a","mac+meta+a"],At.prototype.selectAll],[["ctrl+z","mac+meta+z"],At.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],At.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],At.prototype.delete],[["Escape","mac+Escape"],At.prototype.unselectAll]])),n.AnnotationEditorUIManager=k},(v,n,L)=>{var ft,lt,ut,_t,yt,G,u,f,C,zt,I,qt,X,Wt;Object.defineProperty(n,"__esModule",{value:!0}),n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PageViewport=n.PDFDateString=n.DOMStandardFontDataFactory=n.DOMSVGFactory=n.DOMFilterFactory=n.DOMCanvasFactory=n.DOMCMapReaderFactory=n.AnnotationPrefix=void 0,n.deprecated=h,n.getColorValues=D,n.getCurrentTransform=z,n.getCurrentTransformInverse=K,n.getFilenameFromUrl=w,n.getPdfFilenameFromUrl=R,n.getRGB=o,n.getXfaPageViewport=x,n.isDataScheme=s,n.isPdfFile=a,n.isValidFetchUrl=t,n.loadScript=c,n.setLayerDimensions=tt;var i=L(7),y=L(1);const B="http://www.w3.org/2000/svg",q="pdfjs_internal_id_";n.AnnotationPrefix=q;const it=class{};let Z=it;It(Z,"CSS",96),It(Z,"PDF",72),It(Z,"PDF_TO_CSS_UNITS",it.CSS/it.PDF),n.PixelsPerInch=Z;class N extends i.BaseFilterFactory{constructor({docId:M,ownerDocument:e=globalThis.document}={}){super();et(this,C);et(this,I);et(this,X);et(this,ft,void 0);et(this,lt,void 0);et(this,ut,void 0);et(this,_t,void 0);et(this,yt,void 0);et(this,G,void 0);et(this,u,void 0);et(this,f,0);pt(this,ut,M),pt(this,_t,e)}addFilter(M){if(!M)return"none";let e=m(this,C,zt).get(M);if(e)return e;let l,A,P,O;if(M.length===1){const at=M[0],dt=new Array(256);for(let ct=0;ct<256;ct++)dt[ct]=at[ct]/255;O=l=A=P=dt.join(",")}else{const[at,dt,ct]=M,bt=new Array(256),gt=new Array(256),Ct=new Array(256);for(let At=0;At<256;At++)bt[At]=at[At]/255,gt[At]=dt[At]/255,Ct[At]=ct[At]/255;l=bt.join(","),A=gt.join(","),P=Ct.join(","),O=`${l}${A}${P}`}if(e=m(this,C,zt).get(O),e)return m(this,C,zt).set(M,e),e;const U=`g_${m(this,ut)}_transfer_map_${ie(this,f)._++}`,nt=`url(#${U})`;m(this,C,zt).set(M,nt),m(this,C,zt).set(O,nt);const st=m(this,_t).createElementNS(B,"filter",B);st.setAttribute("id",U),st.setAttribute("color-interpolation-filters","sRGB");const rt=m(this,_t).createElementNS(B,"feComponentTransfer");return st.append(rt),ot(this,X,Wt).call(this,rt,"feFuncR",l),ot(this,X,Wt).call(this,rt,"feFuncG",A),ot(this,X,Wt).call(this,rt,"feFuncB",P),m(this,I,qt).append(st),nt}addHCMFilter(M,e){var ct;const l=`${M}-${e}`;if(m(this,G)===l)return m(this,u);if(pt(this,G,l),pt(this,u,"none"),(ct=m(this,yt))==null||ct.remove(),!M||!e)return m(this,u);m(this,I,qt).style.color=M,M=getComputedStyle(m(this,I,qt)).getPropertyValue("color");const A=o(M);M=y.Util.makeHexColor(...A),m(this,I,qt).style.color=e,e=getComputedStyle(m(this,I,qt)).getPropertyValue("color");const P=o(e);if(e=y.Util.makeHexColor(...P),m(this,I,qt).style.color="",M==="#000000"&&e==="#ffffff"||M===e)return m(this,u);const O=new Array(256);for(let bt=0;bt<=255;bt++){const gt=bt/255;O[bt]=gt<=.03928?gt/12.92:((gt+.055)/1.055)**2.4}const U=O.join(","),nt=`g_${m(this,ut)}_hcm_filter`,st=pt(this,yt,m(this,_t).createElementNS(B,"filter",B));st.setAttribute("id",nt),st.setAttribute("color-interpolation-filters","sRGB");let rt=m(this,_t).createElementNS(B,"feComponentTransfer");st.append(rt),ot(this,X,Wt).call(this,rt,"feFuncR",U),ot(this,X,Wt).call(this,rt,"feFuncG",U),ot(this,X,Wt).call(this,rt,"feFuncB",U);const at=m(this,_t).createElementNS(B,"feColorMatrix");at.setAttribute("type","matrix"),at.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),st.append(at),rt=m(this,_t).createElementNS(B,"feComponentTransfer"),st.append(rt);const dt=(bt,gt)=>{const Ct=A[bt]/255,At=P[bt]/255,wt=new Array(gt+1);for(let F=0;F<=gt;F++)wt[F]=Ct+F/gt*(At-Ct);return wt.join(",")};return ot(this,X,Wt).call(this,rt,"feFuncR",dt(0,5)),ot(this,X,Wt).call(this,rt,"feFuncG",dt(1,5)),ot(this,X,Wt).call(this,rt,"feFuncB",dt(2,5)),m(this,I,qt).append(st),pt(this,u,`url(#${nt})`),m(this,u)}destroy(M=!1){M&&m(this,u)||(m(this,lt)&&(m(this,lt).parentNode.parentNode.remove(),pt(this,lt,null)),m(this,ft)&&(m(this,ft).clear(),pt(this,ft,null)),pt(this,f,0))}}ft=new WeakMap,lt=new WeakMap,ut=new WeakMap,_t=new WeakMap,yt=new WeakMap,G=new WeakMap,u=new WeakMap,f=new WeakMap,C=new WeakSet,zt=function(){return m(this,ft)||pt(this,ft,new Map)},I=new WeakSet,qt=function(){if(!m(this,lt)){const M=m(this,_t).createElement("div"),{style:e}=M;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const l=m(this,_t).createElementNS(B,"svg");l.setAttribute("width",0),l.setAttribute("height",0),pt(this,lt,m(this,_t).createElementNS(B,"defs")),M.append(l),l.append(m(this,lt)),m(this,_t).body.append(M)}return m(this,lt)},X=new WeakSet,Wt=function(M,e,l){const A=m(this,_t).createElementNS(B,e);A.setAttribute("type","discrete"),A.setAttribute("tableValues",l),M.append(A)},n.DOMFilterFactory=N;class T extends i.BaseCanvasFactory{constructor({ownerDocument:j=globalThis.document}={}){super(),this._document=j}_createCanvas(j,M){const e=this._document.createElement("canvas");return e.width=j,e.height=M,e}}n.DOMCanvasFactory=T;async function b(Y,j=!1){if(t(Y,document.baseURI)){const M=await fetch(Y);if(!M.ok)throw new Error(M.statusText);return j?new Uint8Array(await M.arrayBuffer()):(0,y.stringToBytes)(await M.text())}return new Promise((M,e)=>{const l=new XMLHttpRequest;l.open("GET",Y,!0),j&&(l.responseType="arraybuffer"),l.onreadystatechange=()=>{if(l.readyState===XMLHttpRequest.DONE){if(l.status===200||l.status===0){let A;if(j&&l.response?A=new Uint8Array(l.response):!j&&l.responseText&&(A=(0,y.stringToBytes)(l.responseText)),A){M(A);return}}e(new Error(l.statusText))}},l.send(null)})}class k extends i.BaseCMapReaderFactory{_fetchData(j,M){return b(j,this.isCompressed).then(e=>({cMapData:e,compressionType:M}))}}n.DOMCMapReaderFactory=k;class E extends i.BaseStandardFontDataFactory{_fetchData(j){return b(j,!0)}}n.DOMStandardFontDataFactory=E;class _ extends i.BaseSVGFactory{_createSVG(j){return document.createElementNS(B,j)}}n.DOMSVGFactory=_;class d{constructor({viewBox:j,scale:M,rotation:e,offsetX:l=0,offsetY:A=0,dontFlip:P=!1}){this.viewBox=j,this.scale=M,this.rotation=e,this.offsetX=l,this.offsetY=A;const O=(j[2]+j[0])/2,U=(j[3]+j[1])/2;let nt,st,rt,at;switch(e%=360,e<0&&(e+=360),e){case 180:nt=-1,st=0,rt=0,at=1;break;case 90:nt=0,st=1,rt=1,at=0;break;case 270:nt=0,st=-1,rt=-1,at=0;break;case 0:nt=1,st=0,rt=0,at=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}P&&(rt=-rt,at=-at);let dt,ct,bt,gt;nt===0?(dt=Math.abs(U-j[1])*M+l,ct=Math.abs(O-j[0])*M+A,bt=(j[3]-j[1])*M,gt=(j[2]-j[0])*M):(dt=Math.abs(O-j[0])*M+l,ct=Math.abs(U-j[1])*M+A,bt=(j[2]-j[0])*M,gt=(j[3]-j[1])*M),this.transform=[nt*M,st*M,rt*M,at*M,dt-nt*M*O-rt*M*U,ct-st*M*O-at*M*U],this.width=bt,this.height=gt}get rawDims(){const{viewBox:j}=this;return(0,y.shadow)(this,"rawDims",{pageWidth:j[2]-j[0],pageHeight:j[3]-j[1],pageX:j[0],pageY:j[1]})}clone({scale:j=this.scale,rotation:M=this.rotation,offsetX:e=this.offsetX,offsetY:l=this.offsetY,dontFlip:A=!1}={}){return new d({viewBox:this.viewBox.slice(),scale:j,rotation:M,offsetX:e,offsetY:l,dontFlip:A})}convertToViewportPoint(j,M){return y.Util.applyTransform([j,M],this.transform)}convertToViewportRectangle(j){const M=y.Util.applyTransform([j[0],j[1]],this.transform),e=y.Util.applyTransform([j[2],j[3]],this.transform);return[M[0],M[1],e[0],e[1]]}convertToPdfPoint(j,M){return y.Util.applyInverseTransform([j,M],this.transform)}}n.PageViewport=d;class p extends y.BaseException{constructor(j,M,e=0){super(j,"RenderingCancelledException"),this.type=M,this.extraDelay=e}}n.RenderingCancelledException=p;function s(Y){const j=Y.length;let M=0;for(;M<j&&Y[M].trim()==="";)M++;return Y.substring(M,M+5).toLowerCase()==="data:"}function a(Y){return typeof Y=="string"&&/\.pdf$/i.test(Y)}function w(Y,j=!1){return j||([Y]=Y.split(/[#?]/,1)),Y.substring(Y.lastIndexOf("/")+1)}function R(Y,j="document.pdf"){if(typeof Y!="string")return j;if(s(Y))return(0,y.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),j;const M=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,l=M.exec(Y);let A=e.exec(l[1])||e.exec(l[2])||e.exec(l[3]);if(A&&(A=A[0],A.includes("%")))try{A=e.exec(decodeURIComponent(A))[0]}catch{}return A||j}class S{constructor(){It(this,"started",Object.create(null));It(this,"times",[])}time(j){j in this.started&&(0,y.warn)(`Timer is already running for ${j}`),this.started[j]=Date.now()}timeEnd(j){j in this.started||(0,y.warn)(`Timer has not been started for ${j}`),this.times.push({name:j,start:this.started[j],end:Date.now()}),delete this.started[j]}toString(){const j=[];let M=0;for(const{name:e}of this.times)M=Math.max(e.length,M);for(const{name:e,start:l,end:A}of this.times)j.push(`${e.padEnd(M)} ${A-l}ms
`);return j.join("")}}n.StatTimer=S;function t(Y,j){try{const{protocol:M}=j?new URL(Y,j):new URL(Y);return M==="http:"||M==="https:"}catch{return!1}}function c(Y,j=!1){return new Promise((M,e)=>{const l=document.createElement("script");l.src=Y,l.onload=function(A){j&&l.remove(),M(A)},l.onerror=function(){e(new Error(`Cannot load script at: ${l.src}`))},(document.head||document.documentElement).append(l)})}function h(Y){console.log("Deprecated API usage: "+Y)}let r;class g{static toDateObject(j){if(!j||typeof j!="string")return null;r||(r=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const M=r.exec(j);if(!M)return null;const e=parseInt(M[1],10);let l=parseInt(M[2],10);l=l>=1&&l<=12?l-1:0;let A=parseInt(M[3],10);A=A>=1&&A<=31?A:1;let P=parseInt(M[4],10);P=P>=0&&P<=23?P:0;let O=parseInt(M[5],10);O=O>=0&&O<=59?O:0;let U=parseInt(M[6],10);U=U>=0&&U<=59?U:0;const nt=M[7]||"Z";let st=parseInt(M[8],10);st=st>=0&&st<=23?st:0;let rt=parseInt(M[9],10)||0;return rt=rt>=0&&rt<=59?rt:0,nt==="-"?(P+=st,O+=rt):nt==="+"&&(P-=st,O-=rt),new Date(Date.UTC(e,l,A,P,O,U))}}n.PDFDateString=g;function x(Y,{scale:j=1,rotation:M=0}){const{width:e,height:l}=Y.attributes.style,A=[0,0,parseInt(e),parseInt(l)];return new d({viewBox:A,scale:j,rotation:M})}function o(Y){if(Y.startsWith("#")){const j=parseInt(Y.slice(1),16);return[(j&16711680)>>16,(j&65280)>>8,j&255]}return Y.startsWith("rgb(")?Y.slice(4,-1).split(",").map(j=>parseInt(j)):Y.startsWith("rgba(")?Y.slice(5,-1).split(",").map(j=>parseInt(j)).slice(0,3):((0,y.warn)(`Not a valid color format: "${Y}"`),[0,0,0])}function D(Y){const j=document.createElement("span");j.style.visibility="hidden",document.body.append(j);for(const M of Y.keys()){j.style.color=M;const e=window.getComputedStyle(j).color;Y.set(M,o(e))}j.remove()}function z(Y){const{a:j,b:M,c:e,d:l,e:A,f:P}=Y.getTransform();return[j,M,e,l,A,P]}function K(Y){const{a:j,b:M,c:e,d:l,e:A,f:P}=Y.getTransform().invertSelf();return[j,M,e,l,A,P]}function tt(Y,j,M=!1,e=!0){if(j instanceof d){const{pageWidth:l,pageHeight:A}=j.rawDims,{style:P}=Y,O=`calc(var(--scale-factor) * ${l}px)`,U=`calc(var(--scale-factor) * ${A}px)`;!M||j.rotation%180===0?(P.width=O,P.height=U):(P.width=U,P.height=O)}e&&Y.setAttribute("data-main-rotation",j.rotation)}},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStandardFontDataFactory=n.BaseSVGFactory=n.BaseFilterFactory=n.BaseCanvasFactory=n.BaseCMapReaderFactory=void 0;var i=L(1);class y{constructor(){this.constructor===y&&(0,i.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(b){return"none"}addHCMFilter(b,k){return"none"}destroy(b=!1){}}n.BaseFilterFactory=y;class B{constructor(){this.constructor===B&&(0,i.unreachable)("Cannot initialize BaseCanvasFactory.")}create(b,k){if(b<=0||k<=0)throw new Error("Invalid canvas size");const E=this._createCanvas(b,k);return{canvas:E,context:E.getContext("2d")}}reset(b,k,E){if(!b.canvas)throw new Error("Canvas is not specified");if(k<=0||E<=0)throw new Error("Invalid canvas size");b.canvas.width=k,b.canvas.height=E}destroy(b){if(!b.canvas)throw new Error("Canvas is not specified");b.canvas.width=0,b.canvas.height=0,b.canvas=null,b.context=null}_createCanvas(b,k){(0,i.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=B;class q{constructor({baseUrl:b=null,isCompressed:k=!0}){this.constructor===q&&(0,i.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=b,this.isCompressed=k}async fetch({name:b}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!b)throw new Error("CMap name must be specified.");const k=this.baseUrl+b+(this.isCompressed?".bcmap":""),E=this.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE;return this._fetchData(k,E).catch(_=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${k}`)})}_fetchData(b,k){(0,i.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=q;class Z{constructor({baseUrl:b=null}){this.constructor===Z&&(0,i.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=b}async fetch({filename:b}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!b)throw new Error("Font filename must be specified.");const k=`${this.baseUrl}${b}`;return this._fetchData(k).catch(E=>{throw new Error(`Unable to load font data at: ${k}`)})}_fetchData(b){(0,i.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=Z;class N{constructor(){this.constructor===N&&(0,i.unreachable)("Cannot initialize BaseSVGFactory.")}create(b,k,E=!1){if(b<=0||k<=0)throw new Error("Invalid SVG dimensions");const _=this._createSVG("svg:svg");return _.setAttribute("version","1.1"),E||(_.setAttribute("width",`${b}px`),_.setAttribute("height",`${k}px`)),_.setAttribute("preserveAspectRatio","none"),_.setAttribute("viewBox",`0 0 ${b} ${k}`),_}createElement(b){if(typeof b!="string")throw new Error("Invalid SVG element type");return this._createSVG(b)}_createSVG(b){(0,i.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=N},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MurmurHash3_64=void 0;var i=L(1);const y=3285377520,B=4294901760,q=65535;class Z{constructor(T){this.h1=T?T&4294967295:y,this.h2=T?T&4294967295:y}update(T){let b,k;if(typeof T=="string"){b=new Uint8Array(T.length*2),k=0;for(let h=0,r=T.length;h<r;h++){const g=T.charCodeAt(h);g<=255?b[k++]=g:(b[k++]=g>>>8,b[k++]=g&255)}}else if((0,i.isArrayBuffer)(T))b=T.slice(),k=b.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const E=k>>2,_=k-E*4,d=new Uint32Array(b.buffer,0,E);let p=0,s=0,a=this.h1,w=this.h2;const R=3432918353,S=461845907,t=R&q,c=S&q;for(let h=0;h<E;h++)h&1?(p=d[h],p=p*R&B|p*t&q,p=p<<15|p>>>17,p=p*S&B|p*c&q,a^=p,a=a<<13|a>>>19,a=a*5+3864292196):(s=d[h],s=s*R&B|s*t&q,s=s<<15|s>>>17,s=s*S&B|s*c&q,w^=s,w=w<<13|w>>>19,w=w*5+3864292196);switch(p=0,_){case 3:p^=b[E*4+2]<<16;case 2:p^=b[E*4+1]<<8;case 1:p^=b[E*4],p=p*R&B|p*t&q,p=p<<15|p>>>17,p=p*S&B|p*c&q,E&1?a^=p:w^=p}this.h1=a,this.h2=w}hexdigest(){let T=this.h1,b=this.h2;return T^=b>>>1,T=T*3981806797&B|T*36045&q,b=b*4283543511&B|((b<<16|T>>>16)*2950163797&B)>>>16,T^=b>>>1,T=T*444984403&B|T*60499&q,b=b*3301882366&B|((b<<16|T>>>16)*3120437893&B)>>>16,T^=b>>>1,(T>>>0).toString(16).padStart(8,"0")+(b>>>0).toString(16).padStart(8,"0")}}n.MurmurHash3_64=Z},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var i=L(1),y=L(10);class B{constructor({ownerDocument:N=globalThis.document,styleElement:T=null}){this._document=N,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(N){this.nativeFontFaces.push(N),this._document.fonts.add(N)}insertRule(N){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const T=this.styleElement.sheet;T.insertRule(N,T.cssRules.length)}clear(){for(const N of this.nativeFontFaces)this._document.fonts.delete(N);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(N){if(N.attached||N.missingFile)return;if(N.attached=!0,this.isFontLoadingAPISupported){const b=N.createNativeFontFace();if(b){this.addNativeFontFace(b);try{await b.loaded}catch(k){throw(0,i.warn)(`Failed to load font '${b.family}': '${k}'.`),N.disableFontFace=!0,k}}return}const T=N.createFontFaceRule();if(T){if(this.insertRule(T),this.isSyncFontLoadingSupported)return;await new Promise(b=>{const k=this._queueLoadingCallback(b);this._prepareFontLoadEvent(N,k)})}}get isFontLoadingAPISupported(){var T;const N=!!((T=this._document)!=null&&T.fonts);return(0,i.shadow)(this,"isFontLoadingAPISupported",N)}get isSyncFontLoadingSupported(){let N=!1;return(y.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(N=!0),(0,i.shadow)(this,"isSyncFontLoadingSupported",N)}_queueLoadingCallback(N){function T(){for((0,i.assert)(!k.done,"completeRequest() cannot be called twice."),k.done=!0;b.length>0&&b[0].done;){const E=b.shift();setTimeout(E.callback,0)}}const{loadingRequests:b}=this,k={done:!1,complete:T,callback:N};return b.push(k),k}get _loadTestFont(){const N=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,i.shadow)(this,"_loadTestFont",N)}_prepareFontLoadEvent(N,T){function b(o,D){return o.charCodeAt(D)<<24|o.charCodeAt(D+1)<<16|o.charCodeAt(D+2)<<8|o.charCodeAt(D+3)&255}function k(o,D,z,K){const tt=o.substring(0,D),it=o.substring(D+z);return tt+K+it}let E,_;const d=this._document.createElement("canvas");d.width=1,d.height=1;const p=d.getContext("2d");let s=0;function a(o,D){if(++s>30){(0,i.warn)("Load test font never loaded."),D();return}if(p.font="30px "+o,p.fillText(".",0,20),p.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(a.bind(null,o,D))}const w=`lt${Date.now()}${this.loadTestFontId++}`;let R=this._loadTestFont;R=k(R,976,w.length,w);const t=16,c=1482184792;let h=b(R,t);for(E=0,_=w.length-3;E<_;E+=4)h=h-c+b(w,E)|0;E<w.length&&(h=h-c+b(w+"XXX",E)|0),R=k(R,t,4,(0,i.string32)(h));const r=`url(data:font/opentype;base64,${btoa(R)});`,g=`@font-face {font-family:"${w}";src:${r}}`;this.insertRule(g);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const o of[N.loadedName,w]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=o,x.append(D)}this._document.body.append(x),a(w,()=>{x.remove(),T.complete()})}}n.FontLoader=B;class q{constructor(N,{isEvalSupported:T=!0,disableFontFace:b=!1,ignoreErrors:k=!1,inspectFont:E=null}){this.compiledGlyphs=Object.create(null);for(const _ in N)this[_]=N[_];this.isEvalSupported=T!==!1,this.disableFontFace=b===!0,this.ignoreErrors=k===!0,this._inspectFont=E}createNativeFontFace(){var T;if(!this.data||this.disableFontFace)return null;let N;if(!this.cssFontInfo)N=new FontFace(this.loadedName,this.data,{});else{const b={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(b.style=`oblique ${this.cssFontInfo.italicAngle}deg`),N=new FontFace(this.cssFontInfo.fontFamily,this.data,b)}return(T=this._inspectFont)==null||T.call(this,this),N}createFontFaceRule(){var k;if(!this.data||this.disableFontFace)return null;const N=(0,i.bytesToString)(this.data),T=`url(data:${this.mimetype};base64,${btoa(N)});`;let b;if(!this.cssFontInfo)b=`@font-face {font-family:"${this.loadedName}";src:${T}}`;else{let E=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(E+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),b=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${E}src:${T}}`}return(k=this._inspectFont)==null||k.call(this,this,T),b}getPathGenerator(N,T){if(this.compiledGlyphs[T]!==void 0)return this.compiledGlyphs[T];let b;try{b=N.get(this.loadedName+"_path_"+T)}catch(k){if(!this.ignoreErrors)throw k;return(0,i.warn)(`getPathGenerator - ignoring character: "${k}".`),this.compiledGlyphs[T]=function(E,_){}}if(this.isEvalSupported&&i.FeatureTest.isEvalSupported){const k=[];for(const E of b){const _=E.args!==void 0?E.args.join(","):"";k.push("c.",E.cmd,"(",_,`);
`)}return this.compiledGlyphs[T]=new Function("c","size",k.join(""))}return this.compiledGlyphs[T]=function(k,E){for(const _ of b)_.cmd==="scale"&&(_.args=[E,-E]),k[_.cmd].apply(k,_.args)}}}n.FontFaceObject=q},(v,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isNodeJS=void 0;const L=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=L},(v,n,L)=>{var ut,me;Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var i=L(1),y=L(6),B=L(12),q=L(13),Z=L(10);const N=16,T=100,b=4096,k=15,E=10,_=1e3,d=16;function p(G,u){if(G._removeMirroring)throw new Error("Context is already forwarding operations.");G.__originalSave=G.save,G.__originalRestore=G.restore,G.__originalRotate=G.rotate,G.__originalScale=G.scale,G.__originalTranslate=G.translate,G.__originalTransform=G.transform,G.__originalSetTransform=G.setTransform,G.__originalResetTransform=G.resetTransform,G.__originalClip=G.clip,G.__originalMoveTo=G.moveTo,G.__originalLineTo=G.lineTo,G.__originalBezierCurveTo=G.bezierCurveTo,G.__originalRect=G.rect,G.__originalClosePath=G.closePath,G.__originalBeginPath=G.beginPath,G._removeMirroring=()=>{G.save=G.__originalSave,G.restore=G.__originalRestore,G.rotate=G.__originalRotate,G.scale=G.__originalScale,G.translate=G.__originalTranslate,G.transform=G.__originalTransform,G.setTransform=G.__originalSetTransform,G.resetTransform=G.__originalResetTransform,G.clip=G.__originalClip,G.moveTo=G.__originalMoveTo,G.lineTo=G.__originalLineTo,G.bezierCurveTo=G.__originalBezierCurveTo,G.rect=G.__originalRect,G.closePath=G.__originalClosePath,G.beginPath=G.__originalBeginPath,delete G._removeMirroring},G.save=function(){u.save(),this.__originalSave()},G.restore=function(){u.restore(),this.__originalRestore()},G.translate=function(C,V){u.translate(C,V),this.__originalTranslate(C,V)},G.scale=function(C,V){u.scale(C,V),this.__originalScale(C,V)},G.transform=function(C,V,I,$,X,J){u.transform(C,V,I,$,X,J),this.__originalTransform(C,V,I,$,X,J)},G.setTransform=function(C,V,I,$,X,J){u.setTransform(C,V,I,$,X,J),this.__originalSetTransform(C,V,I,$,X,J)},G.resetTransform=function(){u.resetTransform(),this.__originalResetTransform()},G.rotate=function(C){u.rotate(C),this.__originalRotate(C)},G.clip=function(C){u.clip(C),this.__originalClip(C)},G.moveTo=function(f,C){u.moveTo(f,C),this.__originalMoveTo(f,C)},G.lineTo=function(f,C){u.lineTo(f,C),this.__originalLineTo(f,C)},G.bezierCurveTo=function(f,C,V,I,$,X){u.bezierCurveTo(f,C,V,I,$,X),this.__originalBezierCurveTo(f,C,V,I,$,X)},G.rect=function(f,C,V,I){u.rect(f,C,V,I),this.__originalRect(f,C,V,I)},G.closePath=function(){u.closePath(),this.__originalClosePath()},G.beginPath=function(){u.beginPath(),this.__originalBeginPath()}}class s{constructor(u){this.canvasFactory=u,this.cache=Object.create(null)}getCanvas(u,f,C){let V;return this.cache[u]!==void 0?(V=this.cache[u],this.canvasFactory.reset(V,f,C)):(V=this.canvasFactory.create(f,C),this.cache[u]=V),V}delete(u){delete this.cache[u]}clear(){for(const u in this.cache){const f=this.cache[u];this.canvasFactory.destroy(f),delete this.cache[u]}}}function a(G,u,f,C,V,I,$,X,J,Y){const[j,M,e,l,A,P]=(0,y.getCurrentTransform)(G);if(M===0&&e===0){const nt=$*j+A,st=Math.round(nt),rt=X*l+P,at=Math.round(rt),dt=($+J)*j+A,ct=Math.abs(Math.round(dt)-st)||1,bt=(X+Y)*l+P,gt=Math.abs(Math.round(bt)-at)||1;return G.setTransform(Math.sign(j),0,0,Math.sign(l),st,at),G.drawImage(u,f,C,V,I,0,0,ct,gt),G.setTransform(j,M,e,l,A,P),[ct,gt]}if(j===0&&l===0){const nt=X*e+A,st=Math.round(nt),rt=$*M+P,at=Math.round(rt),dt=(X+Y)*e+A,ct=Math.abs(Math.round(dt)-st)||1,bt=($+J)*M+P,gt=Math.abs(Math.round(bt)-at)||1;return G.setTransform(0,Math.sign(M),Math.sign(e),0,st,at),G.drawImage(u,f,C,V,I,0,0,gt,ct),G.setTransform(j,M,e,l,A,P),[gt,ct]}G.drawImage(u,f,C,V,I,$,X,J,Y);const O=Math.hypot(j,M),U=Math.hypot(e,l);return[O*J,U*Y]}function w(G){const{width:u,height:f}=G;if(u>_||f>_)return null;const C=1e3,V=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),I=u+1;let $=new Uint8Array(I*(f+1)),X,J,Y;const j=u+7&-8;let M=new Uint8Array(j*f),e=0;for(const U of G.data){let nt=128;for(;nt>0;)M[e++]=U&nt?0:255,nt>>=1}let l=0;for(e=0,M[e]!==0&&($[0]=1,++l),J=1;J<u;J++)M[e]!==M[e+1]&&($[J]=M[e]?2:1,++l),e++;for(M[e]!==0&&($[J]=2,++l),X=1;X<f;X++){e=X*j,Y=X*I,M[e-j]!==M[e]&&($[Y]=M[e]?1:8,++l);let U=(M[e]?4:0)+(M[e-j]?8:0);for(J=1;J<u;J++)U=(U>>2)+(M[e+1]?4:0)+(M[e-j+1]?8:0),V[U]&&($[Y+J]=V[U],++l),e++;if(M[e-j]!==M[e]&&($[Y+J]=M[e]?2:4,++l),l>C)return null}for(e=j*(f-1),Y=X*I,M[e]!==0&&($[Y]=8,++l),J=1;J<u;J++)M[e]!==M[e+1]&&($[Y+J]=M[e]?4:8,++l),e++;if(M[e]!==0&&($[Y+J]=4,++l),l>C)return null;const A=new Int32Array([0,I,-1,0,-I,0,0,0,1]),P=new Path2D;for(X=0;l&&X<=f;X++){let U=X*I;const nt=U+u;for(;U<nt&&!$[U];)U++;if(U===nt)continue;P.moveTo(U%I,X);const st=U;let rt=$[U];do{const at=A[rt];do U+=at;while(!$[U]);const dt=$[U];dt!==5&&dt!==10?(rt=dt,$[U]=0):(rt=dt&51*rt>>4,$[U]&=rt>>2|rt<<2),P.lineTo(U%I,U/I|0),$[U]||--l}while(st!==U);--X}return M=null,$=null,function(U){U.save(),U.scale(1/u,-1/f),U.translate(0,-f),U.fill(P),U.beginPath(),U.restore()}}class R{constructor(u,f){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,u,f])}clone(){const u=Object.create(this);return u.clipBox=this.clipBox.slice(),u}setCurrentPoint(u,f){this.x=u,this.y=f}updatePathMinMax(u,f,C){[f,C]=i.Util.applyTransform([f,C],u),this.minX=Math.min(this.minX,f),this.minY=Math.min(this.minY,C),this.maxX=Math.max(this.maxX,f),this.maxY=Math.max(this.maxY,C)}updateRectMinMax(u,f){const C=i.Util.applyTransform(f,u),V=i.Util.applyTransform(f.slice(2),u);this.minX=Math.min(this.minX,C[0],V[0]),this.minY=Math.min(this.minY,C[1],V[1]),this.maxX=Math.max(this.maxX,C[0],V[0]),this.maxY=Math.max(this.maxY,C[1],V[1])}updateScalingPathMinMax(u,f){i.Util.scaleMinMax(u,f),this.minX=Math.min(this.minX,f[0]),this.maxX=Math.max(this.maxX,f[1]),this.minY=Math.min(this.minY,f[2]),this.maxY=Math.max(this.maxY,f[3])}updateCurvePathMinMax(u,f,C,V,I,$,X,J,Y,j){const M=i.Util.bezierBoundingBox(f,C,V,I,$,X,J,Y);if(j){j[0]=Math.min(j[0],M[0],M[2]),j[1]=Math.max(j[1],M[0],M[2]),j[2]=Math.min(j[2],M[1],M[3]),j[3]=Math.max(j[3],M[1],M[3]);return}this.updateRectMinMax(u,M)}getPathBoundingBox(u=B.PathType.FILL,f=null){const C=[this.minX,this.minY,this.maxX,this.maxY];if(u===B.PathType.STROKE){f||(0,i.unreachable)("Stroke bounding box must include transform.");const V=i.Util.singularValueDecompose2dScale(f),I=V[0]*this.lineWidth/2,$=V[1]*this.lineWidth/2;C[0]-=I,C[1]-=$,C[2]+=I,C[3]+=$}return C}updateClipFromPath(){const u=i.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(u||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(u){this.clipBox=u,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(u=B.PathType.FILL,f=null){return i.Util.intersect(this.clipBox,this.getPathBoundingBox(u,f))}}function S(G,u){if(typeof ImageData<"u"&&u instanceof ImageData){G.putImageData(u,0,0);return}const f=u.height,C=u.width,V=f%d,I=(f-V)/d,$=V===0?I:I+1,X=G.createImageData(C,d);let J=0,Y;const j=u.data,M=X.data;let e,l,A,P;if(u.kind===i.ImageKind.GRAYSCALE_1BPP){const O=j.byteLength,U=new Uint32Array(M.buffer,0,M.byteLength>>2),nt=U.length,st=C+7>>3,rt=4294967295,at=i.FeatureTest.isLittleEndian?4278190080:255;for(e=0;e<$;e++){for(A=e<I?d:V,Y=0,l=0;l<A;l++){const dt=O-J;let ct=0;const bt=dt>st?C:dt*8-7,gt=bt&-8;let Ct=0,At=0;for(;ct<gt;ct+=8)At=j[J++],U[Y++]=At&128?rt:at,U[Y++]=At&64?rt:at,U[Y++]=At&32?rt:at,U[Y++]=At&16?rt:at,U[Y++]=At&8?rt:at,U[Y++]=At&4?rt:at,U[Y++]=At&2?rt:at,U[Y++]=At&1?rt:at;for(;ct<bt;ct++)Ct===0&&(At=j[J++],Ct=128),U[Y++]=At&Ct?rt:at,Ct>>=1}for(;Y<nt;)U[Y++]=0;G.putImageData(X,0,e*d)}}else if(u.kind===i.ImageKind.RGBA_32BPP){for(l=0,P=C*d*4,e=0;e<I;e++)M.set(j.subarray(J,J+P)),J+=P,G.putImageData(X,0,l),l+=d;e<$&&(P=C*V*4,M.set(j.subarray(J,J+P)),G.putImageData(X,0,l))}else if(u.kind===i.ImageKind.RGB_24BPP)for(A=d,P=C*A,e=0;e<$;e++){for(e>=I&&(A=V,P=C*A),Y=0,l=P;l--;)M[Y++]=j[J++],M[Y++]=j[J++],M[Y++]=j[J++],M[Y++]=255;G.putImageData(X,0,e*d)}else throw new Error(`bad image kind: ${u.kind}`)}function t(G,u){if(u.bitmap){G.drawImage(u.bitmap,0,0);return}const f=u.height,C=u.width,V=f%d,I=(f-V)/d,$=V===0?I:I+1,X=G.createImageData(C,d);let J=0;const Y=u.data,j=X.data;for(let M=0;M<$;M++){const e=M<I?d:V;({srcPos:J}=(0,q.convertBlackAndWhiteToRGBA)({src:Y,srcPos:J,dest:j,width:C,height:e,nonBlackColor:0})),G.putImageData(X,0,M*d)}}function c(G,u){const f=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const C of f)G[C]!==void 0&&(u[C]=G[C]);G.setLineDash!==void 0&&(u.setLineDash(G.getLineDash()),u.lineDashOffset=G.lineDashOffset)}function h(G){G.strokeStyle=G.fillStyle="#000000",G.fillRule="nonzero",G.globalAlpha=1,G.lineWidth=1,G.lineCap="butt",G.lineJoin="miter",G.miterLimit=10,G.globalCompositeOperation="source-over",G.font="10px sans-serif",G.setLineDash!==void 0&&(G.setLineDash([]),G.lineDashOffset=0),Z.isNodeJS||(G.filter="none")}function r(G,u,f,C){const V=G.length;for(let I=3;I<V;I+=4){const $=G[I];if($===0)G[I-3]=u,G[I-2]=f,G[I-1]=C;else if($<255){const X=255-$;G[I-3]=G[I-3]*$+u*X>>8,G[I-2]=G[I-2]*$+f*X>>8,G[I-1]=G[I-1]*$+C*X>>8}}}function g(G,u,f){const C=G.length,V=1/255;for(let I=3;I<C;I+=4){const $=f?f[G[I]]:G[I];u[I]=u[I]*$*V|0}}function x(G,u,f){const C=G.length;for(let V=3;V<C;V+=4){const I=G[V-3]*77+G[V-2]*152+G[V-1]*28;u[V]=f?u[V]*f[I>>8]>>8:u[V]*I>>16}}function o(G,u,f,C,V,I,$,X,J,Y,j){const M=!!I,e=M?I[0]:0,l=M?I[1]:0,A=M?I[2]:0;let P;V==="Luminosity"?P=x:P=g;const U=Math.min(C,Math.ceil(1048576/f));for(let nt=0;nt<C;nt+=U){const st=Math.min(U,C-nt),rt=G.getImageData(X-Y,nt+(J-j),f,st),at=u.getImageData(X,nt+J,f,st);M&&r(rt.data,e,l,A),P(rt.data,at.data,$),u.putImageData(at,X,nt+J)}}function D(G,u,f,C){const V=C[0],I=C[1],$=C[2]-V,X=C[3]-I;$===0||X===0||(o(u.context,f,$,X,u.subtype,u.backdrop,u.transferMap,V,I,u.offsetX,u.offsetY),G.save(),G.globalAlpha=1,G.globalCompositeOperation="source-over",G.setTransform(1,0,0,1,0,0),G.drawImage(f.canvas,0,0),G.restore())}function z(G,u){const f=i.Util.singularValueDecompose2dScale(G);f[0]=Math.fround(f[0]),f[1]=Math.fround(f[1]);const C=Math.fround((globalThis.devicePixelRatio||1)*y.PixelsPerInch.PDF_TO_CSS_UNITS);return u!==void 0?u:f[0]<=C||f[1]<=C}const K=["butt","round","square"],tt=["miter","round","bevel"],it={},ft={},yt=class{constructor(u,f,C,V,I,{optionalContentConfig:$,markedContentStack:X=null},J){et(this,ut);this.ctx=u,this.current=new R(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=f,this.objs=C,this.canvasFactory=V,this.filterFactory=I,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=X||[],this.optionalContentConfig=$,this.cachedCanvases=new s(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=J,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(u,f=null){return typeof u=="string"?u.startsWith("g_")?this.commonObjs.get(u):this.objs.get(u):f}beginDrawing({transform:u,viewport:f,transparency:C=!1,background:V=null}){const I=this.ctx.canvas.width,$=this.ctx.canvas.height,X=this.ctx.fillStyle;if(this.ctx.fillStyle=V||"#ffffff",this.ctx.fillRect(0,0,I,$),this.ctx.fillStyle=X,C){const J=this.cachedCanvases.getCanvas("transparent",I,$);this.compositeCtx=this.ctx,this.transparentCanvas=J.canvas,this.ctx=J.context,this.ctx.save(),this.ctx.transform(...(0,y.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),h(this.ctx),u&&(this.ctx.transform(...u),this.outputScaleX=u[0],this.outputScaleY=u[0]),this.ctx.transform(...f.transform),this.viewportScale=f.scale,this.baseTransform=(0,y.getCurrentTransform)(this.ctx)}executeOperatorList(u,f,C,V){const I=u.argsArray,$=u.fnArray;let X=f||0;const J=I.length;if(J===X)return X;const Y=J-X>E&&typeof C=="function",j=Y?Date.now()+k:0;let M=0;const e=this.commonObjs,l=this.objs;let A;for(;;){if(V!==void 0&&X===V.nextBreakPoint)return V.breakIt(X,C),X;if(A=$[X],A!==i.OPS.dependency)this[A].apply(this,I[X]);else for(const P of I[X]){const O=P.startsWith("g_")?e:l;if(!O.has(P))return O.get(P,C),X}if(X++,X===J)return X;if(Y&&++M>E){if(Date.now()>j)return C(),X;M=0}}}endDrawing(u=null){ot(this,ut,me).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const f of this._cachedBitmapsMap.values()){for(const C of f.values())typeof HTMLCanvasElement<"u"&&C instanceof HTMLCanvasElement&&(C.width=C.height=0);f.clear()}if(this._cachedBitmapsMap.clear(),u){const f=this.filterFactory.addHCMFilter(u.foreground,u.background);if(f!=="none"){const C=this.ctx.filter;this.ctx.filter=f,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=C}}}_scaleImage(u,f){const C=u.width,V=u.height;let I=Math.max(Math.hypot(f[0],f[1]),1),$=Math.max(Math.hypot(f[2],f[3]),1),X=C,J=V,Y="prescale1",j,M;for(;I>2&&X>1||$>2&&J>1;){let e=X,l=J;I>2&&X>1&&(e=X>=16384?Math.floor(X/2)-1||1:Math.ceil(X/2),I/=X/e),$>2&&J>1&&(l=J>=16384?Math.floor(J/2)-1||1:Math.ceil(J)/2,$/=J/l),j=this.cachedCanvases.getCanvas(Y,e,l),M=j.context,M.clearRect(0,0,e,l),M.drawImage(u,0,0,X,J,0,0,e,l),u=j.canvas,X=e,J=l,Y=Y==="prescale1"?"prescale2":"prescale1"}return{img:u,paintWidth:X,paintHeight:J}}_createMaskCanvas(u){const f=this.ctx,{width:C,height:V}=u,I=this.current.fillColor,$=this.current.patternFill,X=(0,y.getCurrentTransform)(f);let J,Y,j,M;if((u.bitmap||u.data)&&u.count>1){const ct=u.bitmap||u.data.buffer;Y=JSON.stringify($?X:[X.slice(0,4),I]),J=this._cachedBitmapsMap.get(ct),J||(J=new Map,this._cachedBitmapsMap.set(ct,J));const bt=J.get(Y);if(bt&&!$){const gt=Math.round(Math.min(X[0],X[2])+X[4]),Ct=Math.round(Math.min(X[1],X[3])+X[5]);return{canvas:bt,offsetX:gt,offsetY:Ct}}j=bt}j||(M=this.cachedCanvases.getCanvas("maskCanvas",C,V),t(M.context,u));let e=i.Util.transform(X,[1/C,0,0,-1/V,0,0]);e=i.Util.transform(e,[1,0,0,1,0,-V]);const l=i.Util.applyTransform([0,0],e),A=i.Util.applyTransform([C,V],e),P=i.Util.normalizeRect([l[0],l[1],A[0],A[1]]),O=Math.round(P[2]-P[0])||1,U=Math.round(P[3]-P[1])||1,nt=this.cachedCanvases.getCanvas("fillCanvas",O,U),st=nt.context,rt=Math.min(l[0],A[0]),at=Math.min(l[1],A[1]);st.translate(-rt,-at),st.transform(...e),j||(j=this._scaleImage(M.canvas,(0,y.getCurrentTransformInverse)(st)),j=j.img,J&&$&&J.set(Y,j)),st.imageSmoothingEnabled=z((0,y.getCurrentTransform)(st),u.interpolate),a(st,j,0,0,j.width,j.height,0,0,C,V),st.globalCompositeOperation="source-in";const dt=i.Util.transform((0,y.getCurrentTransformInverse)(st),[1,0,0,1,-rt,-at]);return st.fillStyle=$?I.getPattern(f,this,dt,B.PathType.FILL):I,st.fillRect(0,0,C,V),J&&!$&&(this.cachedCanvases.delete("fillCanvas"),J.set(Y,nt.canvas)),{canvas:nt.canvas,offsetX:Math.round(rt),offsetY:Math.round(at)}}setLineWidth(u){u!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=u,this.ctx.lineWidth=u}setLineCap(u){this.ctx.lineCap=K[u]}setLineJoin(u){this.ctx.lineJoin=tt[u]}setMiterLimit(u){this.ctx.miterLimit=u}setDash(u,f){const C=this.ctx;C.setLineDash!==void 0&&(C.setLineDash(u),C.lineDashOffset=f)}setRenderingIntent(u){}setFlatness(u){}setGState(u){for(const[f,C]of u)switch(f){case"LW":this.setLineWidth(C);break;case"LC":this.setLineCap(C);break;case"LJ":this.setLineJoin(C);break;case"ML":this.setMiterLimit(C);break;case"D":this.setDash(C[0],C[1]);break;case"RI":this.setRenderingIntent(C);break;case"FL":this.setFlatness(C);break;case"Font":this.setFont(C[0],C[1]);break;case"CA":this.current.strokeAlpha=C;break;case"ca":this.current.fillAlpha=C,this.ctx.globalAlpha=C;break;case"BM":this.ctx.globalCompositeOperation=C;break;case"SMask":this.current.activeSMask=C?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(C);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const u=this.inSMaskMode;this.current.activeSMask&&!u?this.beginSMaskMode():!this.current.activeSMask&&u&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const u=this.ctx.canvas.width,f=this.ctx.canvas.height,C="smaskGroupAt"+this.groupLevel,V=this.cachedCanvases.getCanvas(C,u,f);this.suspendedCtx=this.ctx,this.ctx=V.context;const I=this.ctx;I.setTransform(...(0,y.getCurrentTransform)(this.suspendedCtx)),c(this.suspendedCtx,I),p(I,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),c(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(u){if(!this.current.activeSMask)return;u?(u[0]=Math.floor(u[0]),u[1]=Math.floor(u[1]),u[2]=Math.ceil(u[2]),u[3]=Math.ceil(u[3])):u=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const f=this.current.activeSMask,C=this.suspendedCtx;D(C,f,this.ctx,u),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(c(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const u=this.current;this.stateStack.push(u),this.current=u.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),c(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(u,f,C,V,I,$){this.ctx.transform(u,f,C,V,I,$),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(u,f,C){const V=this.ctx,I=this.current;let $=I.x,X=I.y,J,Y;const j=(0,y.getCurrentTransform)(V),M=j[0]===0&&j[3]===0||j[1]===0&&j[2]===0,e=M?C.slice(0):null;for(let l=0,A=0,P=u.length;l<P;l++)switch(u[l]|0){case i.OPS.rectangle:$=f[A++],X=f[A++];const O=f[A++],U=f[A++],nt=$+O,st=X+U;V.moveTo($,X),O===0||U===0?V.lineTo(nt,st):(V.lineTo(nt,X),V.lineTo(nt,st),V.lineTo($,st)),M||I.updateRectMinMax(j,[$,X,nt,st]),V.closePath();break;case i.OPS.moveTo:$=f[A++],X=f[A++],V.moveTo($,X),M||I.updatePathMinMax(j,$,X);break;case i.OPS.lineTo:$=f[A++],X=f[A++],V.lineTo($,X),M||I.updatePathMinMax(j,$,X);break;case i.OPS.curveTo:J=$,Y=X,$=f[A+4],X=f[A+5],V.bezierCurveTo(f[A],f[A+1],f[A+2],f[A+3],$,X),I.updateCurvePathMinMax(j,J,Y,f[A],f[A+1],f[A+2],f[A+3],$,X,e),A+=6;break;case i.OPS.curveTo2:J=$,Y=X,V.bezierCurveTo($,X,f[A],f[A+1],f[A+2],f[A+3]),I.updateCurvePathMinMax(j,J,Y,$,X,f[A],f[A+1],f[A+2],f[A+3],e),$=f[A+2],X=f[A+3],A+=4;break;case i.OPS.curveTo3:J=$,Y=X,$=f[A+2],X=f[A+3],V.bezierCurveTo(f[A],f[A+1],$,X,$,X),I.updateCurvePathMinMax(j,J,Y,f[A],f[A+1],$,X,$,X,e),A+=4;break;case i.OPS.closePath:V.closePath();break}M&&I.updateScalingPathMinMax(j,e),I.setCurrentPoint($,X)}closePath(){this.ctx.closePath()}stroke(u=!0){const f=this.ctx,C=this.current.strokeColor;f.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof C=="object"&&(C==null?void 0:C.getPattern)?(f.save(),f.strokeStyle=C.getPattern(f,this,(0,y.getCurrentTransformInverse)(f),B.PathType.STROKE),this.rescaleAndStroke(!1),f.restore()):this.rescaleAndStroke(!0)),u&&this.consumePath(this.current.getClippedPathBoundingBox()),f.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(u=!0){const f=this.ctx,C=this.current.fillColor,V=this.current.patternFill;let I=!1;V&&(f.save(),f.fillStyle=C.getPattern(f,this,(0,y.getCurrentTransformInverse)(f),B.PathType.FILL),I=!0);const $=this.current.getClippedPathBoundingBox();this.contentVisible&&$!==null&&(this.pendingEOFill?(f.fill("evenodd"),this.pendingEOFill=!1):f.fill()),I&&f.restore(),u&&this.consumePath($)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=it}eoClip(){this.pendingClip=ft}beginText(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const u=this.pendingTextPaths,f=this.ctx;if(u===void 0){f.beginPath();return}f.save(),f.beginPath();for(const C of u)f.setTransform(...C.transform),f.translate(C.x,C.y),C.addToPath(f,C.fontSize);f.restore(),f.clip(),f.beginPath(),delete this.pendingTextPaths}setCharSpacing(u){this.current.charSpacing=u}setWordSpacing(u){this.current.wordSpacing=u}setHScale(u){this.current.textHScale=u/100}setLeading(u){this.current.leading=-u}setFont(u,f){const C=this.commonObjs.get(u),V=this.current;if(!C)throw new Error(`Can't find font for ${u}`);if(V.fontMatrix=C.fontMatrix||i.FONT_IDENTITY_MATRIX,(V.fontMatrix[0]===0||V.fontMatrix[3]===0)&&(0,i.warn)("Invalid font matrix for font "+u),f<0?(f=-f,V.fontDirection=-1):V.fontDirection=1,this.current.font=C,this.current.fontSize=f,C.isType3Font)return;const I=C.loadedName||"sans-serif";let $="normal";C.black?$="900":C.bold&&($="bold");const X=C.italic?"italic":"normal",J=`"${I}", ${C.fallbackName}`;let Y=f;f<N?Y=N:f>T&&(Y=T),this.current.fontSizeScale=f/Y,this.ctx.font=`${X} ${$} ${Y}px ${J}`}setTextRenderingMode(u){this.current.textRenderingMode=u}setTextRise(u){this.current.textRise=u}moveText(u,f){this.current.x=this.current.lineX+=u,this.current.y=this.current.lineY+=f}setLeadingMoveText(u,f){this.setLeading(-f),this.moveText(u,f)}setTextMatrix(u,f,C,V,I,$){this.current.textMatrix=[u,f,C,V,I,$],this.current.textMatrixScale=Math.hypot(u,f),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(u,f,C,V){const I=this.ctx,$=this.current,X=$.font,J=$.textRenderingMode,Y=$.fontSize/$.fontSizeScale,j=J&i.TextRenderingMode.FILL_STROKE_MASK,M=!!(J&i.TextRenderingMode.ADD_TO_PATH_FLAG),e=$.patternFill&&!X.missingFile;let l;(X.disableFontFace||M||e)&&(l=X.getPathGenerator(this.commonObjs,u)),X.disableFontFace||e?(I.save(),I.translate(f,C),I.beginPath(),l(I,Y),V&&I.setTransform(...V),(j===i.TextRenderingMode.FILL||j===i.TextRenderingMode.FILL_STROKE)&&I.fill(),(j===i.TextRenderingMode.STROKE||j===i.TextRenderingMode.FILL_STROKE)&&I.stroke(),I.restore()):((j===i.TextRenderingMode.FILL||j===i.TextRenderingMode.FILL_STROKE)&&I.fillText(u,f,C),(j===i.TextRenderingMode.STROKE||j===i.TextRenderingMode.FILL_STROKE)&&I.strokeText(u,f,C)),M&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,y.getCurrentTransform)(I),x:f,y:C,fontSize:Y,addToPath:l})}get isFontSubpixelAAEnabled(){const{context:u}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);u.scale(1.5,1),u.fillText("I",0,10);const f=u.getImageData(0,0,10,10).data;let C=!1;for(let V=3;V<f.length;V+=4)if(f[V]>0&&f[V]<255){C=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",C)}showText(u){const f=this.current,C=f.font;if(C.isType3Font)return this.showType3Text(u);const V=f.fontSize;if(V===0)return;const I=this.ctx,$=f.fontSizeScale,X=f.charSpacing,J=f.wordSpacing,Y=f.fontDirection,j=f.textHScale*Y,M=u.length,e=C.vertical,l=e?1:-1,A=C.defaultVMetrics,P=V*f.fontMatrix[0],O=f.textRenderingMode===i.TextRenderingMode.FILL&&!C.disableFontFace&&!f.patternFill;I.save(),I.transform(...f.textMatrix),I.translate(f.x,f.y+f.textRise),Y>0?I.scale(j,-1):I.scale(j,1);let U;if(f.patternFill){I.save();const dt=f.fillColor.getPattern(I,this,(0,y.getCurrentTransformInverse)(I),B.PathType.FILL);U=(0,y.getCurrentTransform)(I),I.restore(),I.fillStyle=dt}let nt=f.lineWidth;const st=f.textMatrixScale;if(st===0||nt===0){const dt=f.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;(dt===i.TextRenderingMode.STROKE||dt===i.TextRenderingMode.FILL_STROKE)&&(nt=this.getSinglePixelWidth())}else nt/=st;if($!==1&&(I.scale($,$),nt/=$),I.lineWidth=nt,C.isInvalidPDFjsFont){const dt=[];let ct=0;for(const bt of u)dt.push(bt.unicode),ct+=bt.width;I.fillText(dt.join(""),0,0),f.x+=ct*P*j,I.restore(),this.compose();return}let rt=0,at;for(at=0;at<M;++at){const dt=u[at];if(typeof dt=="number"){rt+=l*dt*V/1e3;continue}let ct=!1;const bt=(dt.isSpace?J:0)+X,gt=dt.fontChar,Ct=dt.accent;let At,wt,F=dt.width;if(e){const W=dt.vmetric||A,mt=-(dt.vmetric?W[1]:F*.5)*P,Et=W[2]*P;F=W?-W[0]:F,At=mt/$,wt=(rt+Et)/$}else At=rt/$,wt=0;if(C.remeasure&&F>0){const W=I.measureText(gt).width*1e3/V*$;if(F<W&&this.isFontSubpixelAAEnabled){const mt=F/W;ct=!0,I.save(),I.scale(mt,1),At/=mt}else F!==W&&(At+=(F-W)/2e3*V/$)}if(this.contentVisible&&(dt.isInFont||C.missingFile)){if(O&&!Ct)I.fillText(gt,At,wt);else if(this.paintChar(gt,At,wt,U),Ct){const W=At+V*Ct.offset.x/$,mt=wt-V*Ct.offset.y/$;this.paintChar(Ct.fontChar,W,mt,U)}}let H;e?H=F*P-bt*Y:H=F*P+bt*Y,rt+=H,ct&&I.restore()}e?f.y-=rt:f.x+=rt*j,I.restore(),this.compose()}showType3Text(u){const f=this.ctx,C=this.current,V=C.font,I=C.fontSize,$=C.fontDirection,X=V.vertical?1:-1,J=C.charSpacing,Y=C.wordSpacing,j=C.textHScale*$,M=C.fontMatrix||i.FONT_IDENTITY_MATRIX,e=u.length,l=C.textRenderingMode===i.TextRenderingMode.INVISIBLE;let A,P,O,U;if(!(l||I===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,f.save(),f.transform(...C.textMatrix),f.translate(C.x,C.y),f.scale(j,$),A=0;A<e;++A){if(P=u[A],typeof P=="number"){U=X*P*I/1e3,this.ctx.translate(U,0),C.x+=U*j;continue}const nt=(P.isSpace?Y:0)+J,st=V.charProcOperatorList[P.operatorListId];if(!st){(0,i.warn)(`Type3 character "${P.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=P,this.save(),f.scale(I,I),f.transform(...M),this.executeOperatorList(st),this.restore()),O=i.Util.applyTransform([P.width,0],M)[0]*I+nt,f.translate(O,0),C.x+=O*j}f.restore(),this.processingType3=null}}setCharWidth(u,f){}setCharWidthAndBounds(u,f,C,V,I,$){this.ctx.rect(C,V,I-C,$-V),this.ctx.clip(),this.endPath()}getColorN_Pattern(u){let f;if(u[0]==="TilingPattern"){const C=u[1],V=this.baseTransform||(0,y.getCurrentTransform)(this.ctx),I={createCanvasGraphics:$=>new yt($,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};f=new B.TilingPattern(u,C,this.ctx,I,V)}else f=this._getPattern(u[1],u[2]);return f}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(u,f,C){const V=i.Util.makeHexColor(u,f,C);this.ctx.strokeStyle=V,this.current.strokeColor=V}setFillRGBColor(u,f,C){const V=i.Util.makeHexColor(u,f,C);this.ctx.fillStyle=V,this.current.fillColor=V,this.current.patternFill=!1}_getPattern(u,f=null){let C;return this.cachedPatterns.has(u)?C=this.cachedPatterns.get(u):(C=(0,B.getShadingPattern)(this.getObject(u)),this.cachedPatterns.set(u,C)),f&&(C.matrix=f),C}shadingFill(u){if(!this.contentVisible)return;const f=this.ctx;this.save();const C=this._getPattern(u);f.fillStyle=C.getPattern(f,this,(0,y.getCurrentTransformInverse)(f),B.PathType.SHADING);const V=(0,y.getCurrentTransformInverse)(f);if(V){const I=f.canvas,$=I.width,X=I.height,J=i.Util.applyTransform([0,0],V),Y=i.Util.applyTransform([0,X],V),j=i.Util.applyTransform([$,0],V),M=i.Util.applyTransform([$,X],V),e=Math.min(J[0],Y[0],j[0],M[0]),l=Math.min(J[1],Y[1],j[1],M[1]),A=Math.max(J[0],Y[0],j[0],M[0]),P=Math.max(J[1],Y[1],j[1],M[1]);this.ctx.fillRect(e,l,A-e,P-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,i.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,i.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(u,f){if(!!this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(u)&&u.length===6&&this.transform(...u),this.baseTransform=(0,y.getCurrentTransform)(this.ctx),f)){const C=f[2]-f[0],V=f[3]-f[1];this.ctx.rect(f[0],f[1],C,V),this.current.updateRectMinMax((0,y.getCurrentTransform)(this.ctx),f),this.clip(),this.endPath()}}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(u){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const f=this.ctx;u.isolated||(0,i.info)("TODO: Support non-isolated groups."),u.knockout&&(0,i.warn)("Knockout groups not supported.");const C=(0,y.getCurrentTransform)(f);if(u.matrix&&f.transform(...u.matrix),!u.bbox)throw new Error("Bounding box is required.");let V=i.Util.getAxialAlignedBoundingBox(u.bbox,(0,y.getCurrentTransform)(f));const I=[0,0,f.canvas.width,f.canvas.height];V=i.Util.intersect(V,I)||[0,0,0,0];const $=Math.floor(V[0]),X=Math.floor(V[1]);let J=Math.max(Math.ceil(V[2])-$,1),Y=Math.max(Math.ceil(V[3])-X,1),j=1,M=1;J>b&&(j=J/b,J=b),Y>b&&(M=Y/b,Y=b),this.current.startNewPathAndClipBox([0,0,J,Y]);let e="groupAt"+this.groupLevel;u.smask&&(e+="_smask_"+this.smaskCounter++%2);const l=this.cachedCanvases.getCanvas(e,J,Y),A=l.context;A.scale(1/j,1/M),A.translate(-$,-X),A.transform(...C),u.smask?this.smaskStack.push({canvas:l.canvas,context:A,offsetX:$,offsetY:X,scaleX:j,scaleY:M,subtype:u.smask.subtype,backdrop:u.smask.backdrop,transferMap:u.smask.transferMap||null,startTransformInverse:null}):(f.setTransform(1,0,0,1,0,0),f.translate($,X),f.scale(j,M),f.save()),c(f,A),this.ctx=A,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(f),this.groupLevel++}endGroup(u){if(!this.contentVisible)return;this.groupLevel--;const f=this.ctx,C=this.groupStack.pop();if(this.ctx=C,this.ctx.imageSmoothingEnabled=!1,u.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const V=(0,y.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...V);const I=i.Util.getAxialAlignedBoundingBox([0,0,f.canvas.width,f.canvas.height],V);this.ctx.drawImage(f.canvas,0,0),this.ctx.restore(),this.compose(I)}}beginAnnotation(u,f,C,V,I){if(ot(this,ut,me).call(this),h(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(f)&&f.length===4){const $=f[2]-f[0],X=f[3]-f[1];if(I&&this.annotationCanvasMap){C=C.slice(),C[4]-=f[0],C[5]-=f[1],f=f.slice(),f[0]=f[1]=0,f[2]=$,f[3]=X;const[J,Y]=i.Util.singularValueDecompose2dScale((0,y.getCurrentTransform)(this.ctx)),{viewportScale:j}=this,M=Math.ceil($*this.outputScaleX*j),e=Math.ceil(X*this.outputScaleY*j);this.annotationCanvas=this.canvasFactory.create(M,e);const{canvas:l,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(u,l),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.setTransform(J,0,0,-Y,0,X*Y),h(this.ctx)}else h(this.ctx),this.ctx.rect(f[0],f[1],$,X),this.ctx.clip(),this.endPath()}this.current=new R(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...C),this.transform(...V)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(u){if(!this.contentVisible)return;const f=u.count;u=this.getObject(u.data,u),u.count=f;const C=this.ctx,V=this.processingType3;if(V&&(V.compiled===void 0&&(V.compiled=w(u)),V.compiled)){V.compiled(C);return}const I=this._createMaskCanvas(u),$=I.canvas;C.save(),C.setTransform(1,0,0,1,0,0),C.drawImage($,I.offsetX,I.offsetY),C.restore(),this.compose()}paintImageMaskXObjectRepeat(u,f,C=0,V=0,I,$){if(!this.contentVisible)return;u=this.getObject(u.data,u);const X=this.ctx;X.save();const J=(0,y.getCurrentTransform)(X);X.transform(f,C,V,I,0,0);const Y=this._createMaskCanvas(u);X.setTransform(1,0,0,1,Y.offsetX-J[4],Y.offsetY-J[5]);for(let j=0,M=$.length;j<M;j+=2){const e=i.Util.transform(J,[f,C,V,I,$[j],$[j+1]]),[l,A]=i.Util.applyTransform([0,0],e);X.drawImage(Y.canvas,l,A)}X.restore(),this.compose()}paintImageMaskXObjectGroup(u){if(!this.contentVisible)return;const f=this.ctx,C=this.current.fillColor,V=this.current.patternFill;for(const I of u){const{data:$,width:X,height:J,transform:Y}=I,j=this.cachedCanvases.getCanvas("maskCanvas",X,J),M=j.context;M.save();const e=this.getObject($,I);t(M,e),M.globalCompositeOperation="source-in",M.fillStyle=V?C.getPattern(M,this,(0,y.getCurrentTransformInverse)(f),B.PathType.FILL):C,M.fillRect(0,0,X,J),M.restore(),f.save(),f.transform(...Y),f.scale(1,-1),a(f,j.canvas,0,0,X,J,0,-1,1,1),f.restore()}this.compose()}paintImageXObject(u){if(!this.contentVisible)return;const f=this.getObject(u);if(!f){(0,i.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(f)}paintImageXObjectRepeat(u,f,C,V){if(!this.contentVisible)return;const I=this.getObject(u);if(!I){(0,i.warn)("Dependent image isn't ready yet");return}const $=I.width,X=I.height,J=[];for(let Y=0,j=V.length;Y<j;Y+=2)J.push({transform:[f,0,0,C,V[Y],V[Y+1]],x:0,y:0,w:$,h:X});this.paintInlineImageXObjectGroup(I,J)}applyTransferMapsToCanvas(u){return this.current.transferMaps!=="none"&&(u.filter=this.current.transferMaps,u.drawImage(u.canvas,0,0),u.filter="none"),u.canvas}applyTransferMapsToBitmap(u){if(this.current.transferMaps==="none")return u.bitmap;const{bitmap:f,width:C,height:V}=u,I=this.cachedCanvases.getCanvas("inlineImage",C,V),$=I.context;return $.filter=this.current.transferMaps,$.drawImage(f,0,0),$.filter="none",I.canvas}paintInlineImageXObject(u){if(!this.contentVisible)return;const f=u.width,C=u.height,V=this.ctx;this.save(),Z.isNodeJS||(V.filter="none"),V.scale(1/f,-1/C);let I;if(u.bitmap)I=this.applyTransferMapsToBitmap(u);else if(typeof HTMLElement=="function"&&u instanceof HTMLElement||!u.data)I=u;else{const J=this.cachedCanvases.getCanvas("inlineImage",f,C).context;S(J,u),I=this.applyTransferMapsToCanvas(J)}const $=this._scaleImage(I,(0,y.getCurrentTransformInverse)(V));V.imageSmoothingEnabled=z((0,y.getCurrentTransform)(V),u.interpolate),a(V,$.img,0,0,$.paintWidth,$.paintHeight,0,-C,f,C),this.compose(),this.restore()}paintInlineImageXObjectGroup(u,f){if(!this.contentVisible)return;const C=this.ctx;let V;if(u.bitmap)V=u.bitmap;else{const I=u.width,$=u.height,J=this.cachedCanvases.getCanvas("inlineImage",I,$).context;S(J,u),V=this.applyTransferMapsToCanvas(J)}for(const I of f)C.save(),C.transform(...I.transform),C.scale(1,-1),a(C,V,I.x,I.y,I.w,I.h,0,-1,1,1),C.restore();this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(u){}markPointProps(u,f){}beginMarkedContent(u){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(u,f){u==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(f)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(u){const f=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(u);const C=this.ctx;this.pendingClip&&(f||(this.pendingClip===ft?C.clip("evenodd"):C.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),C.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const u=(0,y.getCurrentTransform)(this.ctx);if(u[1]===0&&u[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(u[0]),Math.abs(u[3]));else{const f=Math.abs(u[0]*u[3]-u[2]*u[1]),C=Math.hypot(u[0],u[2]),V=Math.hypot(u[1],u[3]);this._cachedGetSinglePixelWidth=Math.max(C,V)/f}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:u}=this.current,f=(0,y.getCurrentTransform)(this.ctx);let C,V;if(f[1]===0&&f[2]===0){const I=Math.abs(f[0]),$=Math.abs(f[3]);if(u===0)C=1/I,V=1/$;else{const X=I*u,J=$*u;C=X<1?1/X:1,V=J<1?1/J:1}}else{const I=Math.abs(f[0]*f[3]-f[2]*f[1]),$=Math.hypot(f[0],f[1]),X=Math.hypot(f[2],f[3]);if(u===0)C=X/I,V=$/I;else{const J=u*I;C=X>J?X/J:1,V=$>J?$/J:1}}this._cachedScaleForStroking=[C,V]}return this._cachedScaleForStroking}rescaleAndStroke(u){const{ctx:f}=this,{lineWidth:C}=this.current,[V,I]=this.getScaleForStroking();if(f.lineWidth=C||1,V===1&&I===1){f.stroke();return}let $,X,J;u&&($=(0,y.getCurrentTransform)(f),X=f.getLineDash().slice(),J=f.lineDashOffset),f.scale(V,I);const Y=Math.max(V,I);f.setLineDash(f.getLineDash().map(j=>j/Y)),f.lineDashOffset/=Y,f.stroke(),u&&(f.setTransform(...$),f.setLineDash(X),f.lineDashOffset=J)}isContentVisible(){for(let u=this.markedContentStack.length-1;u>=0;u--)if(!this.markedContentStack[u].visible)return!1;return!0}};let lt=yt;ut=new WeakSet,me=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},n.CanvasGraphics=lt;for(const G in i.OPS)lt.prototype[G]!==void 0&&(lt.prototype[i.OPS[G]]=lt.prototype[G])},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TilingPattern=n.PathType=void 0,n.getShadingPattern=_;var i=L(1),y=L(6);const B={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};n.PathType=B;function q(s,a){if(!a)return;const w=a[2]-a[0],R=a[3]-a[1],S=new Path2D;S.rect(a[0],a[1],w,R),s.clip(S)}class Z{constructor(){this.constructor===Z&&(0,i.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,i.unreachable)("Abstract method `getPattern` called.")}}class N extends Z{constructor(a){super(),this._type=a[1],this._bbox=a[2],this._colorStops=a[3],this._p0=a[4],this._p1=a[5],this._r0=a[6],this._r1=a[7],this.matrix=null}_createGradient(a){let w;this._type==="axial"?w=a.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(w=a.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const R of this._colorStops)w.addColorStop(R[0],R[1]);return w}getPattern(a,w,R,S){let t;if(S===B.STROKE||S===B.FILL){const c=w.current.getClippedPathBoundingBox(S,(0,y.getCurrentTransform)(a))||[0,0,0,0],h=Math.ceil(c[2]-c[0])||1,r=Math.ceil(c[3]-c[1])||1,g=w.cachedCanvases.getCanvas("pattern",h,r,!0),x=g.context;x.clearRect(0,0,x.canvas.width,x.canvas.height),x.beginPath(),x.rect(0,0,x.canvas.width,x.canvas.height),x.translate(-c[0],-c[1]),R=i.Util.transform(R,[1,0,0,1,c[0],c[1]]),x.transform(...w.baseTransform),this.matrix&&x.transform(...this.matrix),q(x,this._bbox),x.fillStyle=this._createGradient(x),x.fill(),t=a.createPattern(g.canvas,"no-repeat");const o=new DOMMatrix(R);t.setTransform(o)}else q(a,this._bbox),t=this._createGradient(a);return t}}function T(s,a,w,R,S,t,c,h){const r=a.coords,g=a.colors,x=s.data,o=s.width*4;let D;r[w+1]>r[R+1]&&(D=w,w=R,R=D,D=t,t=c,c=D),r[R+1]>r[S+1]&&(D=R,R=S,S=D,D=c,c=h,h=D),r[w+1]>r[R+1]&&(D=w,w=R,R=D,D=t,t=c,c=D);const z=(r[w]+a.offsetX)*a.scaleX,K=(r[w+1]+a.offsetY)*a.scaleY,tt=(r[R]+a.offsetX)*a.scaleX,it=(r[R+1]+a.offsetY)*a.scaleY,ft=(r[S]+a.offsetX)*a.scaleX,lt=(r[S+1]+a.offsetY)*a.scaleY;if(K>=lt)return;const ut=g[t],_t=g[t+1],yt=g[t+2],G=g[c],u=g[c+1],f=g[c+2],C=g[h],V=g[h+1],I=g[h+2],$=Math.round(K),X=Math.round(lt);let J,Y,j,M,e,l,A,P;for(let O=$;O<=X;O++){if(O<it){let at;O<K?at=0:at=(K-O)/(K-it),J=z-(z-tt)*at,Y=ut-(ut-G)*at,j=_t-(_t-u)*at,M=yt-(yt-f)*at}else{let at;O>lt?at=1:it===lt?at=0:at=(it-O)/(it-lt),J=tt-(tt-ft)*at,Y=G-(G-C)*at,j=u-(u-V)*at,M=f-(f-I)*at}let U;O<K?U=0:O>lt?U=1:U=(K-O)/(K-lt),e=z-(z-ft)*U,l=ut-(ut-C)*U,A=_t-(_t-V)*U,P=yt-(yt-I)*U;const nt=Math.round(Math.min(J,e)),st=Math.round(Math.max(J,e));let rt=o*O+nt*4;for(let at=nt;at<=st;at++)U=(J-at)/(J-e),U<0?U=0:U>1&&(U=1),x[rt++]=Y-(Y-l)*U|0,x[rt++]=j-(j-A)*U|0,x[rt++]=M-(M-P)*U|0,x[rt++]=255}}function b(s,a,w){const R=a.coords,S=a.colors;let t,c;switch(a.type){case"lattice":const h=a.verticesPerRow,r=Math.floor(R.length/h)-1,g=h-1;for(t=0;t<r;t++){let x=t*h;for(let o=0;o<g;o++,x++)T(s,w,R[x],R[x+1],R[x+h],S[x],S[x+1],S[x+h]),T(s,w,R[x+h+1],R[x+1],R[x+h],S[x+h+1],S[x+1],S[x+h])}break;case"triangles":for(t=0,c=R.length;t<c;t+=3)T(s,w,R[t],R[t+1],R[t+2],S[t],S[t+1],S[t+2]);break;default:throw new Error("illegal figure")}}class k extends Z{constructor(a){super(),this._coords=a[2],this._colors=a[3],this._figures=a[4],this._bounds=a[5],this._bbox=a[7],this._background=a[8],this.matrix=null}_createMeshCanvas(a,w,R){const h=Math.floor(this._bounds[0]),r=Math.floor(this._bounds[1]),g=Math.ceil(this._bounds[2])-h,x=Math.ceil(this._bounds[3])-r,o=Math.min(Math.ceil(Math.abs(g*a[0]*1.1)),3e3),D=Math.min(Math.ceil(Math.abs(x*a[1]*1.1)),3e3),z=g/o,K=x/D,tt={coords:this._coords,colors:this._colors,offsetX:-h,offsetY:-r,scaleX:1/z,scaleY:1/K},it=o+2*2,ft=D+2*2,lt=R.getCanvas("mesh",it,ft,!1),ut=lt.context,_t=ut.createImageData(o,D);if(w){const G=_t.data;for(let u=0,f=G.length;u<f;u+=4)G[u]=w[0],G[u+1]=w[1],G[u+2]=w[2],G[u+3]=255}for(const G of this._figures)b(_t,G,tt);return ut.putImageData(_t,2,2),{canvas:lt.canvas,offsetX:h-2*z,offsetY:r-2*K,scaleX:z,scaleY:K}}getPattern(a,w,R,S){q(a,this._bbox);let t;if(S===B.SHADING)t=i.Util.singularValueDecompose2dScale((0,y.getCurrentTransform)(a));else if(t=i.Util.singularValueDecompose2dScale(w.baseTransform),this.matrix){const h=i.Util.singularValueDecompose2dScale(this.matrix);t=[t[0]*h[0],t[1]*h[1]]}const c=this._createMeshCanvas(t,S===B.SHADING?null:this._background,w.cachedCanvases);return S!==B.SHADING&&(a.setTransform(...w.baseTransform),this.matrix&&a.transform(...this.matrix)),a.translate(c.offsetX,c.offsetY),a.scale(c.scaleX,c.scaleY),a.createPattern(c.canvas,"no-repeat")}}class E extends Z{getPattern(){return"hotpink"}}function _(s){switch(s[0]){case"RadialAxial":return new N(s);case"Mesh":return new k(s);case"Dummy":return new E}throw new Error(`Unknown IR type: ${s[0]}`)}const d={COLORED:1,UNCOLORED:2};class p{static get MAX_PATTERN_SIZE(){return(0,i.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(a,w,R,S,t){this.operatorList=a[2],this.matrix=a[3]||[1,0,0,1,0,0],this.bbox=a[4],this.xstep=a[5],this.ystep=a[6],this.paintType=a[7],this.tilingType=a[8],this.color=w,this.ctx=R,this.canvasGraphicsFactory=S,this.baseTransform=t}createPatternCanvas(a){const w=this.operatorList,R=this.bbox,S=this.xstep,t=this.ystep,c=this.paintType,h=this.tilingType,r=this.color,g=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+h);const x=R[0],o=R[1],D=R[2],z=R[3],K=i.Util.singularValueDecompose2dScale(this.matrix),tt=i.Util.singularValueDecompose2dScale(this.baseTransform),it=[K[0]*tt[0],K[1]*tt[1]],ft=this.getSizeAndScale(S,this.ctx.canvas.width,it[0]),lt=this.getSizeAndScale(t,this.ctx.canvas.height,it[1]),ut=a.cachedCanvases.getCanvas("pattern",ft.size,lt.size,!0),_t=ut.context,yt=g.createCanvasGraphics(_t);yt.groupLevel=a.groupLevel,this.setFillAndStrokeStyleToContext(yt,c,r);let G=x,u=o,f=D,C=z;return x<0&&(G=0,f+=Math.abs(x)),o<0&&(u=0,C+=Math.abs(o)),_t.translate(-(ft.scale*G),-(lt.scale*u)),yt.transform(ft.scale,0,0,lt.scale,0,0),_t.save(),this.clipBbox(yt,G,u,f,C),yt.baseTransform=(0,y.getCurrentTransform)(yt.ctx),yt.executeOperatorList(w),yt.endDrawing(),{canvas:ut.canvas,scaleX:ft.scale,scaleY:lt.scale,offsetX:G,offsetY:u}}getSizeAndScale(a,w,R){a=Math.abs(a);const S=Math.max(p.MAX_PATTERN_SIZE,w);let t=Math.ceil(a*R);return t>=S?t=S:R=t/a,{scale:R,size:t}}clipBbox(a,w,R,S,t){const c=S-w,h=t-R;a.ctx.rect(w,R,c,h),a.current.updateRectMinMax((0,y.getCurrentTransform)(a.ctx),[w,R,S,t]),a.clip(),a.endPath()}setFillAndStrokeStyleToContext(a,w,R){const S=a.ctx,t=a.current;switch(w){case d.COLORED:const c=this.ctx;S.fillStyle=c.fillStyle,S.strokeStyle=c.strokeStyle,t.fillColor=c.fillStyle,t.strokeColor=c.strokeStyle;break;case d.UNCOLORED:const h=i.Util.makeHexColor(R[0],R[1],R[2]);S.fillStyle=h,S.strokeStyle=h,t.fillColor=h,t.strokeColor=h;break;default:throw new i.FormatError(`Unsupported paint type: ${w}`)}}getPattern(a,w,R,S){let t=R;S!==B.SHADING&&(t=i.Util.transform(t,w.baseTransform),this.matrix&&(t=i.Util.transform(t,this.matrix)));const c=this.createPatternCanvas(w);let h=new DOMMatrix(t);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const r=a.createPattern(c.canvas,"repeat");return r.setTransform(h),r}}n.TilingPattern=p},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.convertBlackAndWhiteToRGBA=B,n.convertToRGBA=y,n.grayToRGBA=Z;var i=L(1);function y(N){switch(N.kind){case i.ImageKind.GRAYSCALE_1BPP:return B(N);case i.ImageKind.RGB_24BPP:return q(N)}return null}function B({src:N,srcPos:T=0,dest:b,width:k,height:E,nonBlackColor:_=4294967295,inverseDecode:d=!1}){const p=i.FeatureTest.isLittleEndian?4278190080:255,[s,a]=d?[_,p]:[p,_],w=k>>3,R=k&7,S=N.length;b=new Uint32Array(b.buffer);let t=0;for(let c=0;c<E;c++){for(const r=T+w;T<r;T++){const g=T<S?N[T]:255;b[t++]=g&128?a:s,b[t++]=g&64?a:s,b[t++]=g&32?a:s,b[t++]=g&16?a:s,b[t++]=g&8?a:s,b[t++]=g&4?a:s,b[t++]=g&2?a:s,b[t++]=g&1?a:s}if(R===0)continue;const h=T<S?N[T++]:255;for(let r=0;r<R;r++)b[t++]=h&1<<7-r?a:s}return{srcPos:T,destPos:t}}function q({src:N,srcPos:T=0,dest:b,destPos:k=0,width:E,height:_}){let d=0;const p=N.length>>2,s=new Uint32Array(N.buffer,T,p);if(i.FeatureTest.isLittleEndian){for(;d<p-2;d+=3,k+=4){const a=s[d],w=s[d+1],R=s[d+2];b[k]=a|4278190080,b[k+1]=a>>>24|w<<8|4278190080,b[k+2]=w>>>16|R<<16|4278190080,b[k+3]=R>>>8|4278190080}for(let a=d*4,w=N.length;a<w;a+=3)b[k++]=N[a]|N[a+1]<<8|N[a+2]<<16|4278190080}else{for(;d<p-2;d+=3,k+=4){const a=s[d],w=s[d+1],R=s[d+2];b[k]=a|255,b[k+1]=a<<24|w>>>8|255,b[k+2]=w<<16|R>>>16|255,b[k+3]=R<<8|255}for(let a=d*4,w=N.length;a<w;a+=3)b[k++]=N[a]<<24|N[a+1]<<16|N[a+2]<<8|255}return{srcPos:T,destPos:k}}function Z(N,T){if(i.FeatureTest.isLittleEndian)for(let b=0,k=N.length;b<k;b++)T[b]=N[b]*65793|4278190080;else for(let b=0,k=N.length;b<k;b++)T[b]=N[b]*16843008|255}},(v,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const L=Object.create(null);n.GlobalWorkerOptions=L,L.workerPort=null,L.workerSrc=""},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var i=L(1);const y={UNKNOWN:0,DATA:1,ERROR:2},B={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function q(N){switch(N instanceof Error||typeof N=="object"&&N!==null||(0,i.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),N.name){case"AbortException":return new i.AbortException(N.message);case"MissingPDFException":return new i.MissingPDFException(N.message);case"PasswordException":return new i.PasswordException(N.message,N.code);case"UnexpectedResponseException":return new i.UnexpectedResponseException(N.message,N.status);case"UnknownErrorException":return new i.UnknownErrorException(N.message,N.details);default:return new i.UnknownErrorException(N.message,N.toString())}}class Z{constructor(T,b,k){this.sourceName=T,this.targetName=b,this.comObj=k,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=E=>{const _=E.data;if(_.targetName!==this.sourceName)return;if(_.stream){this._processStreamMessage(_);return}if(_.callback){const p=_.callbackId,s=this.callbackCapabilities[p];if(!s)throw new Error(`Cannot resolve callback ${p}`);if(delete this.callbackCapabilities[p],_.callback===y.DATA)s.resolve(_.data);else if(_.callback===y.ERROR)s.reject(q(_.reason));else throw new Error("Unexpected callback case");return}const d=this.actionHandler[_.action];if(!d)throw new Error(`Unknown action from worker: ${_.action}`);if(_.callbackId){const p=this.sourceName,s=_.sourceName;new Promise(function(a){a(d(_.data))}).then(function(a){k.postMessage({sourceName:p,targetName:s,callback:y.DATA,callbackId:_.callbackId,data:a})},function(a){k.postMessage({sourceName:p,targetName:s,callback:y.ERROR,callbackId:_.callbackId,reason:q(a)})});return}if(_.streamId){this._createStreamSink(_);return}d(_.data)},k.addEventListener("message",this._onComObjOnMessage)}on(T,b){const k=this.actionHandler;if(k[T])throw new Error(`There is already an actionName called "${T}"`);k[T]=b}send(T,b,k){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:T,data:b},k)}sendWithPromise(T,b,k){const E=this.callbackId++,_=(0,i.createPromiseCapability)();this.callbackCapabilities[E]=_;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:T,callbackId:E,data:b},k)}catch(d){_.reject(d)}return _.promise}sendWithStream(T,b,k,E){const _=this.streamId++,d=this.sourceName,p=this.targetName,s=this.comObj;return new ReadableStream({start:a=>{const w=(0,i.createPromiseCapability)();return this.streamControllers[_]={controller:a,startCall:w,pullCall:null,cancelCall:null,isClosed:!1},s.postMessage({sourceName:d,targetName:p,action:T,streamId:_,data:b,desiredSize:a.desiredSize},E),w.promise},pull:a=>{const w=(0,i.createPromiseCapability)();return this.streamControllers[_].pullCall=w,s.postMessage({sourceName:d,targetName:p,stream:B.PULL,streamId:_,desiredSize:a.desiredSize}),w.promise},cancel:a=>{(0,i.assert)(a instanceof Error,"cancel must have a valid reason");const w=(0,i.createPromiseCapability)();return this.streamControllers[_].cancelCall=w,this.streamControllers[_].isClosed=!0,s.postMessage({sourceName:d,targetName:p,stream:B.CANCEL,streamId:_,reason:q(a)}),w.promise}},k)}_createStreamSink(T){const b=T.streamId,k=this.sourceName,E=T.sourceName,_=this.comObj,d=this,p=this.actionHandler[T.action],s={enqueue(a,w=1,R){if(this.isCancelled)return;const S=this.desiredSize;this.desiredSize-=w,S>0&&this.desiredSize<=0&&(this.sinkCapability=(0,i.createPromiseCapability)(),this.ready=this.sinkCapability.promise),_.postMessage({sourceName:k,targetName:E,stream:B.ENQUEUE,streamId:b,chunk:a},R)},close(){this.isCancelled||(this.isCancelled=!0,_.postMessage({sourceName:k,targetName:E,stream:B.CLOSE,streamId:b}),delete d.streamSinks[b])},error(a){(0,i.assert)(a instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,_.postMessage({sourceName:k,targetName:E,stream:B.ERROR,streamId:b,reason:q(a)}))},sinkCapability:(0,i.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:T.desiredSize,ready:null};s.sinkCapability.resolve(),s.ready=s.sinkCapability.promise,this.streamSinks[b]=s,new Promise(function(a){a(p(T.data,s))}).then(function(){_.postMessage({sourceName:k,targetName:E,stream:B.START_COMPLETE,streamId:b,success:!0})},function(a){_.postMessage({sourceName:k,targetName:E,stream:B.START_COMPLETE,streamId:b,reason:q(a)})})}_processStreamMessage(T){const b=T.streamId,k=this.sourceName,E=T.sourceName,_=this.comObj,d=this.streamControllers[b],p=this.streamSinks[b];switch(T.stream){case B.START_COMPLETE:T.success?d.startCall.resolve():d.startCall.reject(q(T.reason));break;case B.PULL_COMPLETE:T.success?d.pullCall.resolve():d.pullCall.reject(q(T.reason));break;case B.PULL:if(!p){_.postMessage({sourceName:k,targetName:E,stream:B.PULL_COMPLETE,streamId:b,success:!0});break}p.desiredSize<=0&&T.desiredSize>0&&p.sinkCapability.resolve(),p.desiredSize=T.desiredSize,new Promise(function(s){s(p.onPull&&p.onPull())}).then(function(){_.postMessage({sourceName:k,targetName:E,stream:B.PULL_COMPLETE,streamId:b,success:!0})},function(s){_.postMessage({sourceName:k,targetName:E,stream:B.PULL_COMPLETE,streamId:b,reason:q(s)})});break;case B.ENQUEUE:if((0,i.assert)(d,"enqueue should have stream controller"),d.isClosed)break;d.controller.enqueue(T.chunk);break;case B.CLOSE:if((0,i.assert)(d,"close should have stream controller"),d.isClosed)break;d.isClosed=!0,d.controller.close(),this._deleteStreamController(d,b);break;case B.ERROR:(0,i.assert)(d,"error should have stream controller"),d.controller.error(q(T.reason)),this._deleteStreamController(d,b);break;case B.CANCEL_COMPLETE:T.success?d.cancelCall.resolve():d.cancelCall.reject(q(T.reason)),this._deleteStreamController(d,b);break;case B.CANCEL:if(!p)break;new Promise(function(s){s(p.onCancel&&p.onCancel(q(T.reason)))}).then(function(){_.postMessage({sourceName:k,targetName:E,stream:B.CANCEL_COMPLETE,streamId:b,success:!0})},function(s){_.postMessage({sourceName:k,targetName:E,stream:B.CANCEL_COMPLETE,streamId:b,reason:q(s)})}),p.sinkCapability.reject(q(T.reason)),p.isCancelled=!0,delete this.streamSinks[b];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(T,b){await Promise.allSettled([T.startCall&&T.startCall.promise,T.pullCall&&T.pullCall.promise,T.cancelCall&&T.cancelCall.promise]),delete this.streamControllers[b]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=Z},(v,n,L)=>{var B,q;Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var i=L(1);class y{constructor({parsedData:N,rawData:T}){et(this,B,void 0);et(this,q,void 0);pt(this,B,N),pt(this,q,T)}getRaw(){return m(this,q)}get(N){var T;return(T=m(this,B).get(N))!=null?T:null}getAll(){return(0,i.objectFromMap)(m(this,B))}has(N){return m(this,B).has(N)}}B=new WeakMap,q=new WeakMap,n.Metadata=y},(v,n,L)=>{var N,T,b,k,E,_,be;Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var i=L(1),y=L(8);const B=Symbol("INTERNAL");class q{constructor(s,a){et(this,N,!0);this.name=s,this.intent=a}get visible(){return m(this,N)}_setVisible(s,a){s!==B&&(0,i.unreachable)("Internal method `_setVisible` called."),pt(this,N,a)}}N=new WeakMap;class Z{constructor(s){et(this,_);et(this,T,null);et(this,b,new Map);et(this,k,null);et(this,E,null);if(this.name=null,this.creator=null,s!==null){this.name=s.name,this.creator=s.creator,pt(this,E,s.order);for(const a of s.groups)m(this,b).set(a.id,new q(a.name,a.intent));if(s.baseState==="OFF")for(const a of m(this,b).values())a._setVisible(B,!1);for(const a of s.on)m(this,b).get(a)._setVisible(B,!0);for(const a of s.off)m(this,b).get(a)._setVisible(B,!1);pt(this,k,this.getHash())}}isVisible(s){if(m(this,b).size===0)return!0;if(!s)return(0,i.warn)("Optional content group not defined."),!0;if(s.type==="OCG")return m(this,b).has(s.id)?m(this,b).get(s.id).visible:((0,i.warn)(`Optional content group not found: ${s.id}`),!0);if(s.type==="OCMD"){if(s.expression)return ot(this,_,be).call(this,s.expression);if(!s.policy||s.policy==="AnyOn"){for(const a of s.ids){if(!m(this,b).has(a))return(0,i.warn)(`Optional content group not found: ${a}`),!0;if(m(this,b).get(a).visible)return!0}return!1}else if(s.policy==="AllOn"){for(const a of s.ids){if(!m(this,b).has(a))return(0,i.warn)(`Optional content group not found: ${a}`),!0;if(!m(this,b).get(a).visible)return!1}return!0}else if(s.policy==="AnyOff"){for(const a of s.ids){if(!m(this,b).has(a))return(0,i.warn)(`Optional content group not found: ${a}`),!0;if(!m(this,b).get(a).visible)return!0}return!1}else if(s.policy==="AllOff"){for(const a of s.ids){if(!m(this,b).has(a))return(0,i.warn)(`Optional content group not found: ${a}`),!0;if(m(this,b).get(a).visible)return!1}return!0}return(0,i.warn)(`Unknown optional content policy ${s.policy}.`),!0}return(0,i.warn)(`Unknown group type ${s.type}.`),!0}setVisibility(s,a=!0){if(!m(this,b).has(s)){(0,i.warn)(`Optional content group not found: ${s}`);return}m(this,b).get(s)._setVisible(B,!!a),pt(this,T,null)}get hasInitialVisibility(){return this.getHash()===m(this,k)}getOrder(){return m(this,b).size?m(this,E)?m(this,E).slice():[...m(this,b).keys()]:null}getGroups(){return m(this,b).size>0?(0,i.objectFromMap)(m(this,b)):null}getGroup(s){return m(this,b).get(s)||null}getHash(){if(m(this,T)!==null)return m(this,T);const s=new y.MurmurHash3_64;for(const[a,w]of m(this,b))s.update(`${a}:${w.visible}`);return pt(this,T,s.hexdigest())}}T=new WeakMap,b=new WeakMap,k=new WeakMap,E=new WeakMap,_=new WeakSet,be=function(s){const a=s.length;if(a<2)return!0;const w=s[0];for(let R=1;R<a;R++){const S=s[R];let t;if(Array.isArray(S))t=ot(this,_,be).call(this,S);else if(m(this,b).has(S))t=m(this,b).get(S).visible;else return(0,i.warn)(`Optional content group not found: ${S}`),!0;switch(w){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return w==="And"},n.OptionalContentConfig=Z},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var i=L(1),y=L(6);class B{constructor({length:T,initialData:b,progressiveDone:k=!1,contentDispositionFilename:E=null,disableRange:_=!1,disableStream:d=!1},p){if((0,i.assert)(p,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=k,this._contentDispositionFilename=E,(b==null?void 0:b.length)>0){const s=b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength?b.buffer:new Uint8Array(b).buffer;this._queuedChunks.push(s)}this._pdfDataRangeTransport=p,this._isStreamingSupported=!d,this._isRangeSupported=!_,this._contentLength=T,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((s,a)=>{this._onReceiveData({begin:s,chunk:a})}),this._pdfDataRangeTransport.addProgressListener((s,a)=>{this._onProgress({loaded:s,total:a})}),this._pdfDataRangeTransport.addProgressiveReadListener(s=>{this._onReceiveData({chunk:s})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:T,chunk:b}){const k=b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength?b.buffer:new Uint8Array(b).buffer;if(T===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(k):this._queuedChunks.push(k);else{const E=this._rangeReaders.some(function(_){return _._begin!==T?!1:(_._enqueue(k),!0)});(0,i.assert)(E,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var T,b;return(b=(T=this._fullRequestReader)==null?void 0:T._loaded)!=null?b:0}_onProgress(T){var b,k,E,_;T.total===void 0?(k=(b=this._rangeReaders[0])==null?void 0:b.onProgress)==null||k.call(b,{loaded:T.loaded}):(_=(E=this._fullRequestReader)==null?void 0:E.onProgress)==null||_.call(E,{loaded:T.loaded,total:T.total})}_onProgressiveDone(){var T;(T=this._fullRequestReader)==null||T.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(T){const b=this._rangeReaders.indexOf(T);b>=0&&this._rangeReaders.splice(b,1)}getFullReader(){(0,i.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const T=this._queuedChunks;return this._queuedChunks=null,new q(this,T,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(T,b){if(b<=this._progressiveDataLength)return null;const k=new Z(this,T,b);return this._pdfDataRangeTransport.requestDataRange(T,b),this._rangeReaders.push(k),k}cancelAllRequests(T){var b;(b=this._fullRequestReader)==null||b.cancel(T);for(const k of this._rangeReaders.slice(0))k.cancel(T);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=B;class q{constructor(T,b,k=!1,E=null){this._stream=T,this._done=k||!1,this._filename=(0,y.isPdfFile)(E)?E:null,this._queuedChunks=b||[],this._loaded=0;for(const _ of this._queuedChunks)this._loaded+=_.byteLength;this._requests=[],this._headersReady=Promise.resolve(),T._fullRequestReader=this,this.onProgress=null}_enqueue(T){this._done||(this._requests.length>0?this._requests.shift().resolve({value:T,done:!1}):this._queuedChunks.push(T),this._loaded+=T.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const T=(0,i.createPromiseCapability)();return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Z{constructor(T,b,k){this._stream=T,this._begin=b,this._end=k,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(T){if(!this._done){if(this._requests.length===0)this._queuedChunk=T;else{this._requests.shift().resolve({value:T,done:!1});for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const b=this._queuedChunk;return this._queuedChunk=null,{value:b,done:!1}}if(this._done)return{value:void 0,done:!0};const T=(0,i.createPromiseCapability)();return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(v,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class L{static textContent(y){const B=[],q={items:B,styles:Object.create(null)};function Z(N){var k;if(!N)return;let T=null;const b=N.name;if(b==="#text")T=N.value;else if(L.shouldBuildText(b))(k=N==null?void 0:N.attributes)!=null&&k.textContent?T=N.attributes.textContent:N.value&&(T=N.value);else return;if(T!==null&&B.push({str:T}),!!N.children)for(const E of N.children)Z(E)}return Z(y),q}static shouldBuildText(y){return!(y==="textarea"||y==="input"||y==="option"||y==="select")}}n.XfaText=L},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeFilterFactory=n.NodeCanvasFactory=n.NodeCMapReaderFactory=void 0;var i=L(7);const y=function(T){return new Promise((b,k)=>{require$$5.readFile(T,(_,d)=>{if(_||!d){k(new Error(_));return}b(new Uint8Array(d))})})};class B extends i.BaseFilterFactory{}n.NodeFilterFactory=B;class q extends i.BaseCanvasFactory{_createCanvas(b,k){return require$$5.createCanvas(b,k)}}n.NodeCanvasFactory=q;class Z extends i.BaseCMapReaderFactory{_fetchData(b,k){return y(b).then(E=>({cMapData:E,compressionType:k}))}}n.NodeCMapReaderFactory=Z;class N extends i.BaseStandardFontDataFactory{_fetchData(b){return y(b)}}n.NodeStandardFontDataFactory=N},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var i=L(1),y=L(22);const B=require$$5,q=require$$5,Z=require$$5,N=require$$5,T=/^file:\/\/\/[a-zA-Z]:\//;function b(R){const S=N.parse(R);return S.protocol==="file:"||S.host?S:/^[a-z]:[/\\]/i.test(R)?N.parse(`file:///${R}`):(S.host||(S.protocol="file:"),S)}class k{constructor(S){this.source=S,this.url=b(S.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&S.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var S,t;return(t=(S=this._fullRequestReader)==null?void 0:S._loaded)!=null?t:0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new a(this):new p(this),this._fullRequestReader}getRangeReader(S,t){if(t<=this._progressiveDataLength)return null;const c=this.isFsUrl?new w(this,S,t):new s(this,S,t);return this._rangeRequestReaders.push(c),c}cancelAllRequests(S){var t;(t=this._fullRequestReader)==null||t.cancel(S);for(const c of this._rangeRequestReaders.slice(0))c.cancel(S)}}n.PDFNodeStream=k;class E{constructor(S){this._url=S.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=S.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=(0,i.createPromiseCapability)(),this._headersCapability=(0,i.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var c;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const S=this._readableStream.read();return S===null?(this._readCapability=(0,i.createPromiseCapability)(),this.read()):(this._loaded+=S.length,(c=this.onProgress)==null||c.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(S).buffer,done:!1})}cancel(S){if(!this._readableStream){this._error(S);return}this._readableStream.destroy(S)}_error(S){this._storedError=S,this._readCapability.resolve()}_setReadableStream(S){this._readableStream=S,S.on("readable",()=>{this._readCapability.resolve()}),S.on("end",()=>{S.destroy(),this._done=!0,this._readCapability.resolve()}),S.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new i.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class _{constructor(S){this._url=S.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,i.createPromiseCapability)();const t=S.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var c;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const S=this._readableStream.read();return S===null?(this._readCapability=(0,i.createPromiseCapability)(),this.read()):(this._loaded+=S.length,(c=this.onProgress)==null||c.call(this,{loaded:this._loaded}),{value:new Uint8Array(S).buffer,done:!1})}cancel(S){if(!this._readableStream){this._error(S);return}this._readableStream.destroy(S)}_error(S){this._storedError=S,this._readCapability.resolve()}_setReadableStream(S){this._readableStream=S,S.on("readable",()=>{this._readCapability.resolve()}),S.on("end",()=>{S.destroy(),this._done=!0,this._readCapability.resolve()}),S.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function d(R,S){return{protocol:R.protocol,auth:R.auth,host:R.hostname,port:R.port,path:R.path,method:"GET",headers:S}}class p extends E{constructor(S){super(S);const t=c=>{if(c.statusCode===404){const x=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=x,this._headersCapability.reject(x);return}this._headersCapability.resolve(),this._setReadableStream(c);const h=x=>this._readableStream.headers[x.toLowerCase()],{allowRangeRequests:r,suggestedLength:g}=(0,y.validateRangeRequestCapabilities)({getResponseHeader:h,isHttp:S.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=g||this._contentLength,this._filename=(0,y.extractFilenameFromHeader)(h)};this._request=null,this._url.protocol==="http:"?this._request=q.request(d(this._url,S.httpHeaders),t):this._request=Z.request(d(this._url,S.httpHeaders),t),this._request.on("error",c=>{this._storedError=c,this._headersCapability.reject(c)}),this._request.end()}}class s extends _{constructor(S,t,c){super(S),this._httpHeaders={};for(const r in S.httpHeaders){const g=S.httpHeaders[r];g!==void 0&&(this._httpHeaders[r]=g)}this._httpHeaders.Range=`bytes=${t}-${c-1}`;const h=r=>{if(r.statusCode===404){const g=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=g;return}this._setReadableStream(r)};this._request=null,this._url.protocol==="http:"?this._request=q.request(d(this._url,this._httpHeaders),h):this._request=Z.request(d(this._url,this._httpHeaders),h),this._request.on("error",r=>{this._storedError=r}),this._request.end()}}class a extends E{constructor(S){super(S);let t=decodeURIComponent(this._url.path);T.test(this._url.href)&&(t=t.replace(/^\//,"")),B.lstat(t,(c,h)=>{if(c){c.code==="ENOENT"&&(c=new i.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=c,this._headersCapability.reject(c);return}this._contentLength=h.size,this._setReadableStream(B.createReadStream(t)),this._headersCapability.resolve()})}}class w extends _{constructor(S,t,c){super(S);let h=decodeURIComponent(this._url.path);T.test(this._url.href)&&(h=h.replace(/^\//,"")),this._setReadableStream(B.createReadStream(h,{start:t,end:c-1}))}}},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=N,n.extractFilenameFromHeader=Z,n.validateRangeRequestCapabilities=q,n.validateResponseStatus=T;var i=L(1),y=L(23),B=L(6);function q({getResponseHeader:b,isHttp:k,rangeChunkSize:E,disableRange:_}){const d={allowRangeRequests:!1,suggestedLength:void 0},p=parseInt(b("Content-Length"),10);return!Number.isInteger(p)||(d.suggestedLength=p,p<=2*E)||_||!k||b("Accept-Ranges")!=="bytes"||(b("Content-Encoding")||"identity")!=="identity"||(d.allowRangeRequests=!0),d}function Z(b){const k=b("Content-Disposition");if(k){let E=(0,y.getFilenameFromContentDispositionHeader)(k);if(E.includes("%"))try{E=decodeURIComponent(E)}catch{}if((0,B.isPdfFile)(E))return E}return null}function N(b,k){return b===404||b===0&&k.startsWith("file:")?new i.MissingPDFException('Missing PDF "'+k+'".'):new i.UnexpectedResponseException(`Unexpected server response (${b}) while retrieving PDF "${k}".`,b)}function T(b){return b===200||b===206}},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=y;var i=L(1);function y(B){let q=!0,Z=N("filename\\*","i").exec(B);if(Z){Z=Z[1];let p=E(Z);return p=unescape(p),p=_(p),p=d(p),b(p)}if(Z=k(B),Z){const p=d(Z);return b(p)}if(Z=N("filename","i").exec(B),Z){Z=Z[1];let p=E(Z);return p=d(p),b(p)}function N(p,s){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',s)}function T(p,s){if(p){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const a=new TextDecoder(p,{fatal:!0}),w=(0,i.stringToBytes)(s);s=a.decode(w),q=!1}catch{}}return s}function b(p){return q&&/[\x80-\xff]/.test(p)&&(p=T("utf-8",p),q&&(p=T("iso-8859-1",p))),p}function k(p){const s=[];let a;const w=N("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(a=w.exec(p))!==null;){let[,S,t,c]=a;if(S=parseInt(S,10),S in s){if(S===0)break;continue}s[S]=[t,c]}const R=[];for(let S=0;S<s.length&&S in s;++S){let[t,c]=s[S];c=E(c),t&&(c=unescape(c),S===0&&(c=_(c))),R.push(c)}return R.join("")}function E(p){if(p.startsWith('"')){const s=p.slice(1).split('\\"');for(let a=0;a<s.length;++a){const w=s[a].indexOf('"');w!==-1&&(s[a]=s[a].slice(0,w),s.length=a+1),s[a]=s[a].replaceAll(/\\(.)/g,"$1")}p=s.join('"')}return p}function _(p){const s=p.indexOf("'");if(s===-1)return p;const a=p.slice(0,s),R=p.slice(s+1).replace(/^[^']*'/,"");return T(a,R)}function d(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(s,a,w,R){if(w==="q"||w==="Q")return R=R.replaceAll("_"," "),R=R.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,t){return String.fromCharCode(parseInt(t,16))}),T(a,R);try{R=atob(R)}catch{}return T(a,R)})}return""}},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var i=L(1),y=L(22);const B=200,q=206;function Z(E){const _=E.response;return typeof _!="string"?_:(0,i.stringToBytes)(_).buffer}class N{constructor(_,d={}){this.url=_,this.isHttp=/^https?:/i.test(_),this.httpHeaders=this.isHttp&&d.httpHeaders||Object.create(null),this.withCredentials=d.withCredentials||!1,this.getXhr=d.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(_,d,p){const s={begin:_,end:d};for(const a in p)s[a]=p[a];return this.request(s)}requestFull(_){return this.request(_)}request(_){const d=this.getXhr(),p=this.currXhrId++,s=this.pendingRequests[p]={xhr:d};d.open("GET",this.url),d.withCredentials=this.withCredentials;for(const a in this.httpHeaders){const w=this.httpHeaders[a];w!==void 0&&d.setRequestHeader(a,w)}return this.isHttp&&"begin"in _&&"end"in _?(d.setRequestHeader("Range",`bytes=${_.begin}-${_.end-1}`),s.expectedStatus=q):s.expectedStatus=B,d.responseType="arraybuffer",_.onError&&(d.onerror=function(a){_.onError(d.status)}),d.onreadystatechange=this.onStateChange.bind(this,p),d.onprogress=this.onProgress.bind(this,p),s.onHeadersReceived=_.onHeadersReceived,s.onDone=_.onDone,s.onError=_.onError,s.onProgress=_.onProgress,d.send(null),p}onProgress(_,d){var s;const p=this.pendingRequests[_];!p||(s=p.onProgress)==null||s.call(p,d)}onStateChange(_,d){var S,t,c;const p=this.pendingRequests[_];if(!p)return;const s=p.xhr;if(s.readyState>=2&&p.onHeadersReceived&&(p.onHeadersReceived(),delete p.onHeadersReceived),s.readyState!==4||!(_ in this.pendingRequests))return;if(delete this.pendingRequests[_],s.status===0&&this.isHttp){(S=p.onError)==null||S.call(p,s.status);return}const a=s.status||B;if(!(a===B&&p.expectedStatus===q)&&a!==p.expectedStatus){(t=p.onError)==null||t.call(p,s.status);return}const R=Z(s);if(a===q){const h=s.getResponseHeader("Content-Range"),r=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);p.onDone({begin:parseInt(r[1],10),chunk:R})}else R?p.onDone({begin:0,chunk:R}):(c=p.onError)==null||c.call(p,s.status)}getRequestXhr(_){return this.pendingRequests[_].xhr}isPendingRequest(_){return _ in this.pendingRequests}abortRequest(_){const d=this.pendingRequests[_].xhr;delete this.pendingRequests[_],d.abort()}}class T{constructor(_){this._source=_,this._manager=new N(_.url,{httpHeaders:_.httpHeaders,withCredentials:_.withCredentials}),this._rangeChunkSize=_.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(_){const d=this._rangeRequestReaders.indexOf(_);d>=0&&this._rangeRequestReaders.splice(d,1)}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new b(this._manager,this._source),this._fullRequestReader}getRangeReader(_,d){const p=new k(this._manager,_,d);return p.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(p),p}cancelAllRequests(_){var d;(d=this._fullRequestReader)==null||d.cancel(_);for(const p of this._rangeRequestReaders.slice(0))p.cancel(_)}}n.PDFNetworkStream=T;class b{constructor(_,d){this._manager=_;const p={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=d.url,this._fullRequestId=_.requestFull(p),this._headersReceivedCapability=(0,i.createPromiseCapability)(),this._disableRange=d.disableRange||!1,this._contentLength=d.length,this._rangeChunkSize=d.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const _=this._fullRequestId,d=this._manager.getRequestXhr(_),p=w=>d.getResponseHeader(w),{allowRangeRequests:s,suggestedLength:a}=(0,y.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=(0,y.extractFilenameFromHeader)(p),this._isRangeSupported&&this._manager.abortRequest(_),this._headersReceivedCapability.resolve()}_onDone(_){if(_&&(this._requests.length>0?this._requests.shift().resolve({value:_.chunk,done:!1}):this._cachedChunks.push(_.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(_){this._storedError=(0,y.createResponseStatusError)(_,this._url),this._headersReceivedCapability.reject(this._storedError);for(const d of this._requests)d.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(_){var d;(d=this.onProgress)==null||d.call(this,{loaded:_.loaded,total:_.lengthComputable?_.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const _=(0,i.createPromiseCapability)();return this._requests.push(_),_.promise}cancel(_){this._done=!0,this._headersReceivedCapability.reject(_);for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class k{constructor(_,d,p){this._manager=_;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=_.url,this._requestId=_.requestRange(d,p,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var _;(_=this.onClosed)==null||_.call(this,this)}_onDone(_){const d=_.chunk;this._requests.length>0?this._requests.shift().resolve({value:d,done:!1}):this._queuedChunk=d,this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(_){this._storedError=(0,y.createResponseStatusError)(_,this._url);for(const d of this._requests)d.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(_){var d;this.isStreamingSupported||(d=this.onProgress)==null||d.call(this,{loaded:_.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const d=this._queuedChunk;return this._queuedChunk=null,{value:d,done:!1}}if(this._done)return{value:void 0,done:!0};const _=(0,i.createPromiseCapability)();return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var i=L(1),y=L(22);function B(k,E,_){return{method:"GET",headers:k,signal:_.signal,mode:"cors",credentials:E?"include":"same-origin",redirect:"follow"}}function q(k){const E=new Headers;for(const _ in k){const d=k[_];d!==void 0&&E.append(_,d)}return E}function Z(k){return k instanceof Uint8Array?k.buffer:k instanceof ArrayBuffer?k:((0,i.warn)(`getArrayBuffer - unexpected data format: ${k}`),new Uint8Array(k).buffer)}class N{constructor(E){this.source=E,this.isHttp=/^https?:/i.test(E.url),this.httpHeaders=this.isHttp&&E.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var E,_;return(_=(E=this._fullRequestReader)==null?void 0:E._loaded)!=null?_:0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new T(this),this._fullRequestReader}getRangeReader(E,_){if(_<=this._progressiveDataLength)return null;const d=new b(this,E,_);return this._rangeRequestReaders.push(d),d}cancelAllRequests(E){var _;(_=this._fullRequestReader)==null||_.cancel(E);for(const d of this._rangeRequestReaders.slice(0))d.cancel(E)}}n.PDFFetchStream=N;class T{constructor(E){this._stream=E,this._reader=null,this._loaded=0,this._filename=null;const _=E.source;this._withCredentials=_.withCredentials||!1,this._contentLength=_.length,this._headersCapability=(0,i.createPromiseCapability)(),this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._headers=q(this._stream.httpHeaders);const d=_.url;fetch(d,B(this._headers,this._withCredentials,this._abortController)).then(p=>{if(!(0,y.validateResponseStatus)(p.status))throw(0,y.createResponseStatusError)(p.status,d);this._reader=p.body.getReader(),this._headersCapability.resolve();const s=R=>p.headers.get(R),{allowRangeRequests:a,suggestedLength:w}=(0,y.validateRangeRequestCapabilities)({getResponseHeader:s,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=w||this._contentLength,this._filename=(0,y.extractFilenameFromHeader)(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new i.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var d;await this._headersCapability.promise;const{value:E,done:_}=await this._reader.read();return _?{value:E,done:_}:(this._loaded+=E.byteLength,(d=this.onProgress)==null||d.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Z(E),done:!1})}cancel(E){var _;(_=this._reader)==null||_.cancel(E),this._abortController.abort()}}class b{constructor(E,_,d){this._stream=E,this._reader=null,this._loaded=0;const p=E.source;this._withCredentials=p.withCredentials||!1,this._readCapability=(0,i.createPromiseCapability)(),this._isStreamingSupported=!p.disableStream,this._abortController=new AbortController,this._headers=q(this._stream.httpHeaders),this._headers.append("Range",`bytes=${_}-${d-1}`);const s=p.url;fetch(s,B(this._headers,this._withCredentials,this._abortController)).then(a=>{if(!(0,y.validateResponseStatus)(a.status))throw(0,y.createResponseStatusError)(a.status,s);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var d;await this._readCapability.promise;const{value:E,done:_}=await this._reader.read();return _?{value:E,done:_}:(this._loaded+=E.byteLength,(d=this.onProgress)==null||d.call(this,{loaded:this._loaded}),{value:Z(E),done:!1})}cancel(E){var _;(_=this._reader)==null||_.cancel(E),this._abortController.abort()}}},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TextLayerRenderTask=void 0,n.renderTextLayer=p,n.updateTextLayer=s;var i=L(1),y=L(6);const B=1e5,q=30,Z=.8,N=new Map;function T(a,w){let R;if(w&&i.FeatureTest.isOffscreenCanvasSupported)R=new OffscreenCanvas(a,a).getContext("2d",{alpha:!1});else{const S=document.createElement("canvas");S.width=S.height=a,R=S.getContext("2d",{alpha:!1})}return R}function b(a,w){const R=N.get(a);if(R)return R;const S=T(q,w);S.font=`${q}px ${a}`;const t=S.measureText("");let c=t.fontBoundingBoxAscent,h=Math.abs(t.fontBoundingBoxDescent);if(c){const g=c/(c+h);return N.set(a,g),S.canvas.width=S.canvas.height=0,g}S.strokeStyle="red",S.clearRect(0,0,q,q),S.strokeText("g",0,0);let r=S.getImageData(0,0,q,q).data;h=0;for(let g=r.length-1-3;g>=0;g-=4)if(r[g]>0){h=Math.ceil(g/4/q);break}S.clearRect(0,0,q,q),S.strokeText("A",0,q),r=S.getImageData(0,0,q,q).data,c=0;for(let g=0,x=r.length;g<x;g+=4)if(r[g]>0){c=q-Math.floor(g/4/q);break}if(S.canvas.width=S.canvas.height=0,c){const g=c/(c+h);return N.set(a,g),g}return N.set(a,Z),Z}function k(a,w,R){const S=document.createElement("span"),t={angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL,fontSize:0};a._textDivs.push(S);const c=i.Util.transform(a._transform,w.transform);let h=Math.atan2(c[1],c[0]);const r=R[w.fontName];r.vertical&&(h+=Math.PI/2);const g=Math.hypot(c[2],c[3]),x=g*b(r.fontFamily,a._isOffscreenCanvasSupported);let o,D;h===0?(o=c[4],D=c[5]-x):(o=c[4]+x*Math.sin(h),D=c[5]-x*Math.cos(h));const z="calc(var(--scale-factor)*",K=S.style;a._container===a._rootContainer?(K.left=`${(100*o/a._pageWidth).toFixed(2)}%`,K.top=`${(100*D/a._pageHeight).toFixed(2)}%`):(K.left=`${z}${o.toFixed(2)}px)`,K.top=`${z}${D.toFixed(2)}px)`),K.fontSize=`${z}${g.toFixed(2)}px)`,K.fontFamily=r.fontFamily,t.fontSize=g,S.setAttribute("role","presentation"),S.textContent=w.str,S.dir=w.dir,a._fontInspectorEnabled&&(S.dataset.fontName=w.fontName),h!==0&&(t.angle=h*(180/Math.PI));let tt=!1;if(w.str.length>1)tt=!0;else if(w.str!==" "&&w.transform[0]!==w.transform[3]){const it=Math.abs(w.transform[0]),ft=Math.abs(w.transform[3]);it!==ft&&Math.max(it,ft)/Math.min(it,ft)>1.5&&(tt=!0)}tt&&(t.canvasWidth=r.vertical?w.height:w.width),a._textDivProperties.set(S,t),a._isReadableStream&&a._layoutText(S)}function E(a){const{div:w,scale:R,properties:S,ctx:t,prevFontSize:c,prevFontFamily:h}=a,{style:r}=w;let g="";if(S.canvasWidth!==0&&S.hasText){const{fontFamily:x}=r,{canvasWidth:o,fontSize:D}=S;(c!==D||h!==x)&&(t.font=`${D*R}px ${x}`,a.prevFontSize=D,a.prevFontFamily=x);const{width:z}=t.measureText(w.textContent);z>0&&(g=`scaleX(${o*R/z})`)}S.angle!==0&&(g=`rotate(${S.angle}deg) ${g}`),g.length>0&&(r.transform=g)}function _(a){if(a._canceled)return;const w=a._textDivs,R=a._capability;if(w.length>B){R.resolve();return}if(!a._isReadableStream)for(const t of w)a._layoutText(t);R.resolve()}class d{constructor({textContentSource:w,container:R,viewport:S,textDivs:t,textDivProperties:c,textContentItemsStr:h,isOffscreenCanvasSupported:r}){var z;this._textContentSource=w,this._isReadableStream=w instanceof ReadableStream,this._container=this._rootContainer=R,this._textDivs=t||[],this._textContentItemsStr=h||[],this._isOffscreenCanvasSupported=r,this._fontInspectorEnabled=!!((z=globalThis.FontInspector)!=null&&z.enabled),this._reader=null,this._textDivProperties=c||new WeakMap,this._canceled=!1,this._capability=(0,i.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:S.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:T(0,r)};const{pageWidth:g,pageHeight:x,pageX:o,pageY:D}=S.rawDims;this._transform=[1,0,0,-1,-o,D+x],this._pageWidth=g,this._pageHeight=x,(0,y.setLayerDimensions)(R,S),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new i.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new i.AbortException("TextLayer task cancelled."))}_processItems(w,R){for(const S of w){if(S.str===void 0){if(S.type==="beginMarkedContentProps"||S.type==="beginMarkedContent"){const t=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),S.id!==null&&this._container.setAttribute("id",`${S.id}`),t.append(this._container)}else S.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(S.str),k(this,S,R)}}_layoutText(w){const R=this._layoutTextParams.properties=this._textDivProperties.get(w);if(this._layoutTextParams.div=w,E(this._layoutTextParams),R.hasText&&this._container.append(w),R.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this._container.append(S)}}_render(){const w=(0,i.createPromiseCapability)();let R=Object.create(null);if(this._isReadableStream){const S=()=>{this._reader.read().then(({value:t,done:c})=>{if(c){w.resolve();return}Object.assign(R,t.styles),this._processItems(t.items,R),S()},w.reject)};this._reader=this._textContentSource.getReader(),S()}else if(this._textContentSource){const{items:S,styles:t}=this._textContentSource;this._processItems(S,t),w.resolve()}else throw new Error('No "textContentSource" parameter specified.');w.promise.then(()=>{R=null,_(this)},this._capability.reject)}}n.TextLayerRenderTask=d;function p(a){!a.textContentSource&&(a.textContent||a.textContentStream)&&((0,y.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),a.textContentSource=a.textContent||a.textContentStream);const{container:w,viewport:R}=a,S=getComputedStyle(w),t=S.getPropertyValue("visibility"),c=parseFloat(S.getPropertyValue("--scale-factor"));t==="visible"&&(!c||Math.abs(c-R.scale)>1e-15)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const h=new d(a);return h._render(),h}function s({container:a,viewport:w,textDivs:R,textDivProperties:S,isOffscreenCanvasSupported:t,mustRotate:c=!0,mustRescale:h=!0}){if(c&&(0,y.setLayerDimensions)(a,{rotation:w.rotation}),h){const r=T(0,t),x={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:r};for(const o of R)x.properties=S.get(o),x.div=o,E(x)}}},(v,n,L)=>{var T,b,k,E,_,d,p,s,a,_e,R,je,t,Ae,h,ve;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditorLayer=void 0;var i=L(1),y=L(5),B=L(28),q=L(29),Z=L(6);const g=class{constructor(o){et(this,a);et(this,R);et(this,t);et(this,h);et(this,T,void 0);et(this,b,!1);et(this,k,this.pointerup.bind(this));et(this,E,this.pointerdown.bind(this));et(this,_,new Map);et(this,d,!1);et(this,p,!1);et(this,s,void 0);g._initialized||(g._initialized=!0,B.FreeTextEditor.initialize(o.l10n),q.InkEditor.initialize(o.l10n)),o.uiManager.registerEditorTypes([B.FreeTextEditor,q.InkEditor]),pt(this,s,o.uiManager),this.pageIndex=o.pageIndex,this.div=o.div,pt(this,T,o.accessibilityManager),m(this,s).addLayer(this)}get isEmpty(){return m(this,_).size===0}updateToolbar(o){m(this,s).updateToolbar(o)}updateMode(o=m(this,s).getMode()){ot(this,h,ve).call(this),o===i.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),m(this,s).unselectAll(),o!==i.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",o===i.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",o===i.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(o){if(!o&&m(this,s).getMode()!==i.AnnotationEditorType.INK)return;if(!o){for(const z of m(this,_).values())if(z.isEmpty()){z.setInBackground();return}}ot(this,t,Ae).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(o){m(this,s).setEditingState(o)}addCommands(o){m(this,s).addCommands(o)}enable(){this.div.style.pointerEvents="auto";for(const o of m(this,_).values())o.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const o of m(this,_).values())o.disableEditing();ot(this,h,ve).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(o){m(this,s).getActive()!==o&&m(this,s).setActiveEditor(o)}enableClick(){this.div.addEventListener("pointerdown",m(this,E)),this.div.addEventListener("pointerup",m(this,k))}disableClick(){this.div.removeEventListener("pointerdown",m(this,E)),this.div.removeEventListener("pointerup",m(this,k))}attach(o){m(this,_).set(o.id,o)}detach(o){var D;m(this,_).delete(o.id),(D=m(this,T))==null||D.removePointerInTextLayer(o.contentDiv)}remove(o){m(this,s).removeEditor(o),this.detach(o),o.div.style.display="none",setTimeout(()=>{o.div.style.display="",o.div.remove(),o.isAttachedToDOM=!1,document.activeElement===document.body&&m(this,s).focusMainContainer()},0),m(this,p)||this.addInkEditorIfNeeded(!1)}add(o){if(ot(this,a,_e).call(this,o),m(this,s).addEditor(o),this.attach(o),!o.isAttachedToDOM){const D=o.render();this.div.append(D),o.isAttachedToDOM=!0}this.moveEditorInDOM(o),o.onceAdded(),m(this,s).addToAnnotationStorage(o)}moveEditorInDOM(o){var D;(D=m(this,T))==null||D.moveElementInDOM(this.div,o.div,o.contentDiv,!0)}addOrRebuild(o){o.needsToBeRebuilt()?o.rebuild():this.add(o)}addANewEditor(o){const D=()=>{this.addOrRebuild(o)},z=()=>{o.remove()};this.addCommands({cmd:D,undo:z,mustExec:!0})}addUndoableEditor(o){const D=()=>{this.addOrRebuild(o)},z=()=>{o.remove()};this.addCommands({cmd:D,undo:z,mustExec:!1})}getNextId(){return m(this,s).getId()}deserialize(o){switch(o.annotationType){case i.AnnotationEditorType.FREETEXT:return B.FreeTextEditor.deserialize(o,this,m(this,s));case i.AnnotationEditorType.INK:return q.InkEditor.deserialize(o,this,m(this,s))}return null}setSelected(o){m(this,s).setSelected(o)}toggleSelected(o){m(this,s).toggleSelected(o)}isSelected(o){return m(this,s).isSelected(o)}unselect(o){m(this,s).unselect(o)}pointerup(o){const{isMac:D}=i.FeatureTest.platform;if(!(o.button!==0||o.ctrlKey&&D)&&o.target===this.div&&!!m(this,d)){if(pt(this,d,!1),!m(this,b)){pt(this,b,!0);return}ot(this,t,Ae).call(this,o)}}pointerdown(o){const{isMac:D}=i.FeatureTest.platform;if(o.button!==0||o.ctrlKey&&D||o.target!==this.div)return;pt(this,d,!0);const z=m(this,s).getActive();pt(this,b,!z||z.isEmpty())}drop(o){const D=o.dataTransfer.getData("text/plain"),z=m(this,s).getEditor(D);if(!z)return;o.preventDefault(),o.dataTransfer.dropEffect="move",ot(this,a,_e).call(this,z);const K=this.div.getBoundingClientRect(),tt=o.clientX-K.x,it=o.clientY-K.y;z.translate(tt-z.startX,it-z.startY),this.moveEditorInDOM(z),z.div.focus()}dragover(o){o.preventDefault()}destroy(){var o,D;((o=m(this,s).getActive())==null?void 0:o.parent)===this&&m(this,s).setActiveEditor(null);for(const z of m(this,_).values())(D=m(this,T))==null||D.removePointerInTextLayer(z.contentDiv),z.setParent(null),z.isAttachedToDOM=!1,z.div.remove();this.div=null,m(this,_).clear(),m(this,s).removeLayer(this)}render({viewport:o}){this.viewport=o,(0,Z.setLayerDimensions)(this.div,o),(0,y.bindEvents)(this,this.div,["dragover","drop"]);for(const D of m(this,s).getEditors(this.pageIndex))this.add(D);this.updateMode()}update({viewport:o}){m(this,s).commitOrRemove(),this.viewport=o,(0,Z.setLayerDimensions)(this.div,{rotation:o.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:o,pageHeight:D}=this.viewport.rawDims;return[o,D]}};let N=g;T=new WeakMap,b=new WeakMap,k=new WeakMap,E=new WeakMap,_=new WeakMap,d=new WeakMap,p=new WeakMap,s=new WeakMap,a=new WeakSet,_e=function(o){var D;o.parent!==this&&(this.attach(o),(D=o.parent)==null||D.detach(o),o.setParent(this),o.div&&o.isAttachedToDOM&&(o.div.remove(),this.div.append(o.div)))},R=new WeakSet,je=function(o){switch(m(this,s).getMode()){case i.AnnotationEditorType.FREETEXT:return new B.FreeTextEditor(o);case i.AnnotationEditorType.INK:return new q.InkEditor(o)}return null},t=new WeakSet,Ae=function(o){const D=this.getNextId(),z=ot(this,R,je).call(this,{parent:this,id:D,x:o.offsetX,y:o.offsetY,uiManager:m(this,s)});return z&&this.add(z),z},h=new WeakSet,ve=function(){pt(this,p,!0);for(const o of m(this,_).values())o.isEmpty()&&o.remove();pt(this,p,!1)},It(N,"_initialized",!1),n.AnnotationEditorLayer=N},(v,n,L)=>{var Z,N,T,b,k,E,_,d,p,s,Ue,w,Ve,S,He,c,ye;Object.defineProperty(n,"__esModule",{value:!0}),n.FreeTextEditor=void 0;var i=L(1),y=L(5),B=L(4);const r=class extends B.AnnotationEditor{constructor(o){super({...o,name:"freeTextEditor"});et(this,s);et(this,w);et(this,S);et(this,c);et(this,Z,this.editorDivBlur.bind(this));et(this,N,this.editorDivFocus.bind(this));et(this,T,this.editorDivInput.bind(this));et(this,b,this.editorDivKeydown.bind(this));et(this,k,void 0);et(this,E,"");et(this,_,`${this.id}-editor`);et(this,d,!1);et(this,p,void 0);pt(this,k,o.color||r._defaultColor||B.AnnotationEditor._defaultLineColor),pt(this,p,o.fontSize||r._defaultFontSize)}static initialize(o){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(z=>[z,o.get(z)]));const D=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(D.getPropertyValue("--freetext-padding"))}static updateDefaultParams(o,D){switch(o){case i.AnnotationEditorParamsType.FREETEXT_SIZE:r._defaultFontSize=D;break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:r._defaultColor=D;break}}updateParams(o,D){switch(o){case i.AnnotationEditorParamsType.FREETEXT_SIZE:ot(this,s,Ue).call(this,D);break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:ot(this,w,Ve).call(this,D);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,r._defaultFontSize],[i.AnnotationEditorParamsType.FREETEXT_COLOR,r._defaultColor||B.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,m(this,p)],[i.AnnotationEditorParamsType.FREETEXT_COLOR,m(this,k)]]}getInitialTranslation(){const o=this.parentScale;return[-r._internalPadding*o,-(r._internalPadding+m(this,p))*o]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(i.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",m(this,b)),this.editorDiv.addEventListener("focus",m(this,N)),this.editorDiv.addEventListener("blur",m(this,Z)),this.editorDiv.addEventListener("input",m(this,T)))}disableEditMode(){!this.isInEditMode()||(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",m(this,_)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",m(this,b)),this.editorDiv.removeEventListener("focus",m(this,N)),this.editorDiv.removeEventListener("blur",m(this,Z)),this.editorDiv.removeEventListener("input",m(this,T)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(o){super.focusin(o),o.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){!this.isInEditMode()||(super.commit(),m(this,d)||(pt(this,d,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),pt(this,E,ot(this,S,He).call(this).trimEnd()),ot(this,c,ye).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(o){this.enableEditMode(),this.editorDiv.focus()}keydown(o){o.target===this.div&&o.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(o){r._keyboardManager.exec(this,o)}editorDivFocus(o){this.isEditing=!0}editorDivBlur(o){this.isEditing=!1}editorDivInput(o){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let o,D;this.width&&(o=this.x,D=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",m(this,_)),this.enableEditing(),r._l10nPromise.get("editor_free_text2_aria_label").then(K=>{var tt;return(tt=this.editorDiv)==null?void 0:tt.setAttribute("aria-label",K)}),r._l10nPromise.get("free_text2_default_content").then(K=>{var tt;return(tt=this.editorDiv)==null?void 0:tt.setAttribute("default-content",K)}),this.editorDiv.contentEditable=!0;const{style:z}=this.editorDiv;if(z.fontSize=`calc(${m(this,p)}px * var(--scale-factor))`,z.color=m(this,k),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,y.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[K,tt]=this.parentDimensions;this.setAt(o*K,D*tt,this.width*K,this.height*tt);for(const it of m(this,E).split(`
`)){const ft=document.createElement("div");ft.append(it?document.createTextNode(it):document.createElement("br")),this.editorDiv.append(ft)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(o,D,z){const K=super.deserialize(o,D,z);return pt(K,p,o.fontSize),pt(K,k,i.Util.makeHexColor(...o.color)),pt(K,E,o.value),K}serialize(){if(this.isEmpty())return null;const o=r._internalPadding*this.parentScale,D=this.getRect(o,o),z=B.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:m(this,k));return{annotationType:i.AnnotationEditorType.FREETEXT,color:z,fontSize:m(this,p),value:m(this,E),pageIndex:this.pageIndex,rect:D,rotation:this.rotation}}};let q=r;Z=new WeakMap,N=new WeakMap,T=new WeakMap,b=new WeakMap,k=new WeakMap,E=new WeakMap,_=new WeakMap,d=new WeakMap,p=new WeakMap,s=new WeakSet,Ue=function(o){const D=K=>{this.editorDiv.style.fontSize=`calc(${K}px * var(--scale-factor))`,this.translate(0,-(K-m(this,p))*this.parentScale),pt(this,p,K),ot(this,c,ye).call(this)},z=m(this,p);this.addCommands({cmd:()=>{D(o)},undo:()=>{D(z)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},w=new WeakSet,Ve=function(o){const D=m(this,k);this.addCommands({cmd:()=>{pt(this,k,this.editorDiv.style.color=o)},undo:()=>{pt(this,k,this.editorDiv.style.color=D)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},S=new WeakSet,He=function(){const o=this.editorDiv.getElementsByTagName("div");if(o.length===0)return this.editorDiv.innerText;const D=[];for(const z of o)D.push(z.innerText.replace(/\r\n?|\n/,""));return D.join(`
`)},c=new WeakSet,ye=function(){const[o,D]=this.parentDimensions;let z;if(this.isAttachedToDOM)z=this.div.getBoundingClientRect();else{const{currentLayer:K,div:tt}=this,it=tt.style.display;tt.style.display="hidden",K.div.append(this.div),z=tt.getBoundingClientRect(),tt.remove(),tt.style.display=it}this.width=z.width/o,this.height=z.height/D},It(q,"_freeTextDefaultContent",""),It(q,"_l10nPromise"),It(q,"_internalPadding",0),It(q,"_defaultColor",null),It(q,"_defaultFontSize",10),It(q,"_keyboardManager",new y.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],r.prototype.commitOrRemove]])),It(q,"_type","freetext"),n.FreeTextEditor=q},(v,n,L)=>{var T,b,k,E,_,d,p,s,a,w,R,S,t,c,h,We,g,Ge,o,qe,z,Xe,tt,Se,ft,$e,ut,ze,yt,Ye,u,Gt,C,Ce,I,ae,X,oe,Y,Yt,M,Ee,l,le,P,Te,U,Ke,st,Je,at,Qe,ct,Pe,gt,ce,At,Kt,F,xe;Object.defineProperty(n,"__esModule",{value:!0}),n.InkEditor=void 0,Object.defineProperty(n,"fitCurve",{enumerable:!0,get:function(){return B.fitCurve}});var i=L(1),y=L(4),B=L(30),q=L(5);const Z=16,W=class extends y.AnnotationEditor{constructor(Q){super({...Q,name:"inkEditor"});et(this,h);et(this,g);et(this,o);et(this,z);et(this,tt);et(this,ft);et(this,ut);et(this,yt);et(this,u);et(this,C);et(this,I);et(this,X);et(this,Y);et(this,M);et(this,l);et(this,U);et(this,st);et(this,at);et(this,ct);et(this,gt);et(this,At);et(this,F);et(this,T,0);et(this,b,0);et(this,k,0);et(this,E,this.canvasPointermove.bind(this));et(this,_,this.canvasPointerleave.bind(this));et(this,d,this.canvasPointerup.bind(this));et(this,p,this.canvasPointerdown.bind(this));et(this,s,!1);et(this,a,!1);et(this,w,null);et(this,R,null);et(this,S,0);et(this,t,0);et(this,c,null);this.color=Q.color||null,this.thickness=Q.thickness||null,this.opacity=Q.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(Q){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(ht=>[ht,Q.get(ht)]))}static updateDefaultParams(Q,ht){switch(Q){case i.AnnotationEditorParamsType.INK_THICKNESS:W._defaultThickness=ht;break;case i.AnnotationEditorParamsType.INK_COLOR:W._defaultColor=ht;break;case i.AnnotationEditorParamsType.INK_OPACITY:W._defaultOpacity=ht/100;break}}updateParams(Q,ht){switch(Q){case i.AnnotationEditorParamsType.INK_THICKNESS:ot(this,h,We).call(this,ht);break;case i.AnnotationEditorParamsType.INK_COLOR:ot(this,g,Ge).call(this,ht);break;case i.AnnotationEditorParamsType.INK_OPACITY:ot(this,o,qe).call(this,ht);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,W._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,W._defaultColor||y.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(W._defaultOpacity*100)]]}get propertiesToUpdate(){var Q;return[[i.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||W._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,this.color||W._defaultColor||y.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((Q=this.opacity)!=null?Q:W._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ot(this,I,ae).call(this),ot(this,X,oe).call(this)),this.isAttachedToDOM||(this.parent.add(this),ot(this,Y,Yt).call(this)),ot(this,At,Kt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,m(this,R).disconnect(),pt(this,R,null),super.remove())}setParent(Q){!this.parent&&Q?this._uiManager.removeShouldRescale(this):this.parent&&Q===null&&this._uiManager.addShouldRescale(this),super.setParent(Q)}onScaleChanging(){const[Q,ht]=this.parentDimensions,vt=this.width*Q,St=this.height*ht;this.setDimensions(vt,St)}enableEditMode(){m(this,s)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",m(this,p)),this.canvas.addEventListener("pointerup",m(this,d)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",m(this,p)),this.canvas.removeEventListener("pointerup",m(this,d)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){m(this,s)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),pt(this,s,!0),this.div.classList.add("disabled"),ot(this,At,Kt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(Q){super.focusin(Q),this.enableEditMode()}canvasPointerdown(Q){Q.button!==0||!this.isInEditMode()||m(this,s)||(this.setInForeground(),Q.type!=="mouse"&&this.div.focus(),Q.stopPropagation(),this.canvas.addEventListener("pointerleave",m(this,_)),this.canvas.addEventListener("pointermove",m(this,E)),ot(this,ft,$e).call(this,Q.offsetX,Q.offsetY))}canvasPointermove(Q){Q.stopPropagation(),ot(this,ut,ze).call(this,Q.offsetX,Q.offsetY)}canvasPointerup(Q){Q.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(Q.stopPropagation(),ot(this,C,Ce).call(this,Q),this.setInBackground())}canvasPointerleave(Q){ot(this,C,Ce).call(this,Q),this.setInBackground()}render(){if(this.div)return this.div;let Q,ht;this.width&&(Q=this.x,ht=this.y),super.render(),W._l10nPromise.get("editor_ink2_aria_label").then(xt=>{var Pt;return(Pt=this.div)==null?void 0:Pt.setAttribute("aria-label",xt)});const[vt,St,Rt,kt]=ot(this,z,Xe).call(this);if(this.setAt(vt,St,0,0),this.setDims(Rt,kt),ot(this,I,ae).call(this),this.width){const[xt,Pt]=this.parentDimensions;this.setAt(Q*xt,ht*Pt,this.width*xt,this.height*Pt),pt(this,a,!0),ot(this,Y,Yt).call(this),this.setDims(this.width*xt,this.height*Pt),ot(this,u,Gt).call(this),ot(this,F,xe).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ot(this,X,oe).call(this),this.div}setDimensions(Q,ht){const vt=Math.round(Q),St=Math.round(ht);if(m(this,S)===vt&&m(this,t)===St)return;pt(this,S,vt),pt(this,t,St),this.canvas.style.visibility="hidden",m(this,T)&&Math.abs(m(this,T)-Q/ht)>.01&&(ht=Math.ceil(Q/m(this,T)),this.setDims(Q,ht));const[Rt,kt]=this.parentDimensions;this.width=Q/Rt,this.height=ht/kt,m(this,s)&&ot(this,M,Ee).call(this,Q,ht),ot(this,Y,Yt).call(this),ot(this,u,Gt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Q,ht,vt){var Mt,Dt;const St=super.deserialize(Q,ht,vt);St.thickness=Q.thickness,St.color=i.Util.makeHexColor(...Q.color),St.opacity=Q.opacity;const[Rt,kt]=St.pageDimensions,xt=St.width*Rt,Pt=St.height*kt,Ft=St.parentScale,Tt=Q.thickness/2;pt(St,T,xt/Pt),pt(St,s,!0),pt(St,S,Math.round(xt)),pt(St,t,Math.round(Pt));for(const{bezier:Lt}of Q.paths){const Bt=[];St.paths.push(Bt);let Ot=Ft*(Lt[0]-Tt),jt=Ft*(Pt-Lt[1]-Tt);for(let Ut=2,Zt=Lt.length;Ut<Zt;Ut+=6){const te=Ft*(Lt[Ut]-Tt),ee=Ft*(Pt-Lt[Ut+1]-Tt),se=Ft*(Lt[Ut+2]-Tt),ne=Ft*(Pt-Lt[Ut+3]-Tt),Re=Ft*(Lt[Ut+4]-Tt),Fe=Ft*(Pt-Lt[Ut+5]-Tt);Bt.push([[Ot,jt],[te,ee],[se,ne],[Re,Fe]]),Ot=Re,jt=Fe}const Ht=ot(this,P,Te).call(this,Bt);St.bezierPath2D.push(Ht)}const Nt=ot(Mt=St,ct,Pe).call(Mt);return pt(St,k,Math.max(Z,Nt[2]-Nt[0])),pt(St,b,Math.max(Z,Nt[3]-Nt[1])),ot(Dt=St,M,Ee).call(Dt,xt,Pt),St}serialize(){if(this.isEmpty())return null;const Q=this.getRect(0,0),ht=this.rotation%180===0?Q[3]-Q[1]:Q[2]-Q[0],vt=y.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:i.AnnotationEditorType.INK,color:vt,thickness:this.thickness,opacity:this.opacity,paths:ot(this,U,Ke).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,ht),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation}}};let N=W;T=new WeakMap,b=new WeakMap,k=new WeakMap,E=new WeakMap,_=new WeakMap,d=new WeakMap,p=new WeakMap,s=new WeakMap,a=new WeakMap,w=new WeakMap,R=new WeakMap,S=new WeakMap,t=new WeakMap,c=new WeakMap,h=new WeakSet,We=function(Q){const ht=this.thickness;this.addCommands({cmd:()=>{this.thickness=Q,ot(this,At,Kt).call(this)},undo:()=>{this.thickness=ht,ot(this,At,Kt).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,Ge=function(Q){const ht=this.color;this.addCommands({cmd:()=>{this.color=Q,ot(this,u,Gt).call(this)},undo:()=>{this.color=ht,ot(this,u,Gt).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},o=new WeakSet,qe=function(Q){Q/=100;const ht=this.opacity;this.addCommands({cmd:()=>{this.opacity=Q,ot(this,u,Gt).call(this)},undo:()=>{this.opacity=ht,ot(this,u,Gt).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},z=new WeakSet,Xe=function(){const{parentRotation:Q,parentDimensions:[ht,vt]}=this;switch(Q){case 90:return[0,vt,vt,ht];case 180:return[ht,vt,ht,vt];case 270:return[ht,0,vt,ht];default:return[0,0,ht,vt]}},tt=new WeakSet,Se=function(){const{ctx:Q,color:ht,opacity:vt,thickness:St,parentScale:Rt,scaleFactor:kt}=this;Q.lineWidth=St*Rt/kt,Q.lineCap="round",Q.lineJoin="round",Q.miterLimit=10,Q.strokeStyle=`${ht}${(0,q.opacityToHex)(vt)}`},ft=new WeakSet,$e=function(Q,ht){var vt;this.isEditing=!0,m(this,a)||(pt(this,a,!0),ot(this,Y,Yt).call(this),this.thickness||(this.thickness=W._defaultThickness),this.color||(this.color=W._defaultColor||y.AnnotationEditor._defaultLineColor),(vt=this.opacity)!=null||(this.opacity=W._defaultOpacity)),this.currentPath.push([Q,ht]),pt(this,w,null),ot(this,tt,Se).call(this),this.ctx.beginPath(),this.ctx.moveTo(Q,ht),pt(this,c,()=>{!m(this,c)||(m(this,w)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ot(this,u,Gt).call(this),this.ctx.lineTo(...m(this,w)),pt(this,w,null),this.ctx.stroke()),window.requestAnimationFrame(m(this,c)))}),window.requestAnimationFrame(m(this,c))},ut=new WeakSet,ze=function(Q,ht){const[vt,St]=this.currentPath.at(-1);Q===vt&&ht===St||(this.currentPath.push([Q,ht]),pt(this,w,[Q,ht]))},yt=new WeakSet,Ye=function(Q,ht){var Ft;this.ctx.closePath(),pt(this,c,null),Q=Math.min(Math.max(Q,0),this.canvas.width),ht=Math.min(Math.max(ht,0),this.canvas.height);const[vt,St]=this.currentPath.at(-1);(Q!==vt||ht!==St)&&this.currentPath.push([Q,ht]);let Rt;if(this.currentPath.length!==1)Rt=(0,B.fitCurve)(this.currentPath,30,null);else{const Tt=[Q,ht];Rt=[[Tt,Tt.slice(),Tt.slice(),Tt]]}const kt=ot(Ft=W,P,Te).call(Ft,Rt);this.currentPath.length=0;const xt=()=>{this.paths.push(Rt),this.bezierPath2D.push(kt),this.rebuild()},Pt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ot(this,I,ae).call(this),ot(this,X,oe).call(this)),ot(this,At,Kt).call(this))};this.addCommands({cmd:xt,undo:Pt,mustExec:!0})},u=new WeakSet,Gt=function(){if(this.isEmpty()){ot(this,l,le).call(this);return}ot(this,tt,Se).call(this);const{canvas:Q,ctx:ht}=this;ht.setTransform(1,0,0,1,0,0),ht.clearRect(0,0,Q.width,Q.height),ot(this,l,le).call(this);for(const vt of this.bezierPath2D)ht.stroke(vt)},C=new WeakSet,Ce=function(Q){ot(this,yt,Ye).call(this,Q.offsetX,Q.offsetY),this.canvas.removeEventListener("pointerleave",m(this,_)),this.canvas.removeEventListener("pointermove",m(this,E)),this.addToAnnotationStorage()},I=new WeakSet,ae=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",W._l10nPromise.get("editor_ink_canvas_aria_label").then(Q=>{var ht;return(ht=this.canvas)==null?void 0:ht.setAttribute("aria-label",Q)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},X=new WeakSet,oe=function(){pt(this,R,new ResizeObserver(Q=>{const ht=Q[0].contentRect;ht.width&&ht.height&&this.setDimensions(ht.width,ht.height)})),m(this,R).observe(this.div)},Y=new WeakSet,Yt=function(){if(!m(this,a))return;const[Q,ht]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Q),this.canvas.height=Math.ceil(this.height*ht),ot(this,l,le).call(this)},M=new WeakSet,Ee=function(Q,ht){const vt=ot(this,gt,ce).call(this),St=(Q-vt)/m(this,k),Rt=(ht-vt)/m(this,b);this.scaleFactor=Math.min(St,Rt)},l=new WeakSet,le=function(){const Q=ot(this,gt,ce).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Q,this.translationY*this.scaleFactor+Q)},P=new WeakSet,Te=function(Q){const ht=new Path2D;for(let vt=0,St=Q.length;vt<St;vt++){const[Rt,kt,xt,Pt]=Q[vt];vt===0&&ht.moveTo(...Rt),ht.bezierCurveTo(kt[0],kt[1],xt[0],xt[1],Pt[0],Pt[1])}return ht},U=new WeakSet,Ke=function(Q,ht,vt,St){const kt=[],xt=this.thickness/2;let Pt,Ft;for(const Tt of this.paths){Pt=[],Ft=[];for(let Nt=0,Mt=Tt.length;Nt<Mt;Nt++){const[Dt,Lt,Bt,Ot]=Tt[Nt],jt=Q*(Dt[0]+ht)+xt,Ht=St-Q*(Dt[1]+vt)-xt,Ut=Q*(Lt[0]+ht)+xt,Zt=St-Q*(Lt[1]+vt)-xt,te=Q*(Bt[0]+ht)+xt,ee=St-Q*(Bt[1]+vt)-xt,se=Q*(Ot[0]+ht)+xt,ne=St-Q*(Ot[1]+vt)-xt;Nt===0&&(Pt.push(jt,Ht),Ft.push(jt,Ht)),Pt.push(Ut,Zt,te,ee,se,ne),ot(this,st,Je).call(this,jt,Ht,Ut,Zt,te,ee,se,ne,4,Ft)}kt.push({bezier:Pt,points:Ft})}return kt},st=new WeakSet,Je=function(Q,ht,vt,St,Rt,kt,xt,Pt,Ft,Tt){if(ot(this,at,Qe).call(this,Q,ht,vt,St,Rt,kt,xt,Pt)){Tt.push(xt,Pt);return}for(let Nt=1;Nt<Ft-1;Nt++){const Mt=Nt/Ft,Dt=1-Mt;let Lt=Mt*Q+Dt*vt,Bt=Mt*ht+Dt*St,Ot=Mt*vt+Dt*Rt,jt=Mt*St+Dt*kt;const Ht=Mt*Rt+Dt*xt,Ut=Mt*kt+Dt*Pt;Lt=Mt*Lt+Dt*Ot,Bt=Mt*Bt+Dt*jt,Ot=Mt*Ot+Dt*Ht,jt=Mt*jt+Dt*Ut,Lt=Mt*Lt+Dt*Ot,Bt=Mt*Bt+Dt*jt,Tt.push(Lt,Bt)}Tt.push(xt,Pt)},at=new WeakSet,Qe=function(Q,ht,vt,St,Rt,kt,xt,Pt){const Tt=(3*vt-2*Q-xt)**2,Nt=(3*St-2*ht-Pt)**2,Mt=(3*Rt-Q-2*xt)**2,Dt=(3*kt-ht-2*Pt)**2;return Math.max(Tt,Mt)+Math.max(Nt,Dt)<=10},ct=new WeakSet,Pe=function(){let Q=1/0,ht=-1/0,vt=1/0,St=-1/0;for(const Rt of this.paths)for(const[kt,xt,Pt,Ft]of Rt){const Tt=i.Util.bezierBoundingBox(...kt,...xt,...Pt,...Ft);Q=Math.min(Q,Tt[0]),vt=Math.min(vt,Tt[1]),ht=Math.max(ht,Tt[2]),St=Math.max(St,Tt[3])}return[Q,vt,ht,St]},gt=new WeakSet,ce=function(){return m(this,s)?Math.ceil(this.thickness*this.parentScale):0},At=new WeakSet,Kt=function(Q=!1){if(this.isEmpty())return;if(!m(this,s)){ot(this,u,Gt).call(this);return}const ht=ot(this,ct,Pe).call(this),vt=ot(this,gt,ce).call(this);pt(this,k,Math.max(Z,ht[2]-ht[0])),pt(this,b,Math.max(Z,ht[3]-ht[1]));const St=Math.ceil(vt+m(this,k)*this.scaleFactor),Rt=Math.ceil(vt+m(this,b)*this.scaleFactor),[kt,xt]=this.parentDimensions;this.width=St/kt,this.height=Rt/xt,pt(this,T,St/Rt),ot(this,F,xe).call(this);const Pt=this.translationX,Ft=this.translationY;this.translationX=-ht[0],this.translationY=-ht[1],ot(this,Y,Yt).call(this),ot(this,u,Gt).call(this),pt(this,S,St),pt(this,t,Rt),this.setDims(St,Rt);const Tt=Q?vt/this.scaleFactor/2:0;this.translate(Pt-this.translationX-Tt,Ft-this.translationY-Tt)},F=new WeakSet,xe=function(){const{style:Q}=this.div;m(this,T)>=1?(Q.minHeight=`${Z}px`,Q.minWidth=`${Math.round(m(this,T)*Z)}px`):(Q.minWidth=`${Z}px`,Q.minHeight=`${Math.round(Z/m(this,T))}px`)},et(N,P),It(N,"_defaultColor",null),It(N,"_defaultOpacity",1),It(N,"_defaultThickness",1),It(N,"_l10nPromise"),It(N,"_type","ink"),n.InkEditor=N},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.fitCurve=void 0;const i=L(31);n.fitCurve=i},v=>{function n(d,p,s){if(!Array.isArray(d))throw new TypeError("First argument should be an array");if(d.forEach(S=>{if(!Array.isArray(S)||S.some(t=>typeof t!="number")||S.length!==d[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),d=d.filter((S,t)=>t===0||!S.every((c,h)=>c===d[t-1][h])),d.length<2)return[];const a=d.length,w=k(d[1],d[0]),R=k(d[a-2],d[a-1]);return L(d,w,R,p,s)}function L(d,p,s,a,w){var S,t,c,h,r,g,x,o,D,z,K,tt,it;if(d.length===2)return tt=E.vectorLen(E.subtract(d[0],d[1]))/3,S=[d[0],E.addArrays(d[0],E.mulItems(p,tt)),E.addArrays(d[1],E.mulItems(s,tt)),d[1]],[S];if(t=Z(d),[S,h,g]=i(d,t,t,p,s,w),h===0||h<a)return[S];if(h<a*a)for(c=t,r=h,x=g,it=0;it<20;it++){if(c=B(S,d,c),[S,h,g]=i(d,t,c,p,s,w),h<a)return[S];if(g===x){let ft=h/r;if(ft>.9999&&ft<1.0001)break}r=h,x=g}return K=[],o=E.subtract(d[g-1],d[g+1]),o.every(ft=>ft===0)&&(o=E.subtract(d[g-1],d[g]),[o[0],o[1]]=[-o[1],o[0]]),D=E.normalize(o),z=E.mulItems(D,-1),K=K.concat(L(d.slice(0,g+1),p,D,a,w)),K=K.concat(L(d.slice(g),z,s,a,w)),K}function i(d,p,s,a,w,R){var S,t,c;return S=y(d,s,a,w),[t,c]=N(d,S,p),R&&R({bez:S,points:d,params:p,maxErr:t,maxPoint:c}),[S,t,c]}function y(d,p,s,a){var w,R,S,t,c,h,r,g,x,o,D,z,K,tt,it,ft,lt,ut=d[0],_t=d[d.length-1];for(w=[ut,null,null,_t],R=E.zeros_Xx2x2(p.length),K=0,tt=p.length;K<tt;K++)ft=p[K],lt=1-ft,S=R[K],S[0]=E.mulItems(s,3*ft*(lt*lt)),S[1]=E.mulItems(a,3*lt*(ft*ft));for(t=[[0,0],[0,0]],c=[0,0],K=0,tt=d.length;K<tt;K++)ft=p[K],S=R[K],t[0][0]+=E.dot(S[0],S[0]),t[0][1]+=E.dot(S[0],S[1]),t[1][0]+=E.dot(S[0],S[1]),t[1][1]+=E.dot(S[1],S[1]),it=E.subtract(d[K],_.q([ut,ut,_t,_t],ft)),c[0]+=E.dot(S[0],it),c[1]+=E.dot(S[1],it);return h=t[0][0]*t[1][1]-t[1][0]*t[0][1],r=t[0][0]*c[1]-t[1][0]*c[0],g=c[0]*t[1][1]-c[1]*t[0][1],x=h===0?0:g/h,o=h===0?0:r/h,z=E.vectorLen(E.subtract(ut,_t)),D=1e-6*z,x<D||o<D?(w[1]=E.addArrays(ut,E.mulItems(s,z/3)),w[2]=E.addArrays(_t,E.mulItems(a,z/3))):(w[1]=E.addArrays(ut,E.mulItems(s,x)),w[2]=E.addArrays(_t,E.mulItems(a,o))),w}function B(d,p,s){return s.map((a,w)=>q(d,p[w],a))}function q(d,p,s){var a=E.subtract(_.q(d,s),p),w=_.qprime(d,s),R=E.mulMatrix(a,w),S=E.sum(E.squareItems(w))+2*E.mulMatrix(a,_.qprimeprime(d,s));return S===0?s:s-R/S}function Z(d){var p=[],s,a,w;return d.forEach((R,S)=>{s=S?a+E.vectorLen(E.subtract(R,w)):0,p.push(s),a=s,w=R}),p=p.map(R=>R/a),p}function N(d,p,s){var a,w,R,S,t,c,h,r;w=0,R=Math.floor(d.length/2);const g=T(p,10);for(t=0,c=d.length;t<c;t++)h=d[t],r=b(p,s[t],g,10),S=E.subtract(_.q(p,r),h),a=S[0]*S[0]+S[1]*S[1],a>w&&(w=a,R=t);return[w,R]}var T=function(d,p){for(var s,a=[0],w=d[0],R=0,S=1;S<=p;S++)s=_.q(d,S/p),R+=E.vectorLen(E.subtract(s,w)),a.push(R),w=s;return a=a.map(t=>t/R),a};function b(d,p,s,a){if(p<0)return 0;if(p>1)return 1;for(var w,R,S,t,c,h=1;h<=a;h++)if(p<=s[h]){t=(h-1)/a,S=h/a,R=s[h-1],w=s[h],c=(p-R)/(w-R)*(S-t)+t;break}return c}function k(d,p){return E.normalize(E.subtract(d,p))}class E{static zeros_Xx2x2(p){for(var s=[];p--;)s.push([0,0]);return s}static mulItems(p,s){return p.map(a=>a*s)}static mulMatrix(p,s){return p.reduce((a,w,R)=>a+w*s[R],0)}static subtract(p,s){return p.map((a,w)=>a-s[w])}static addArrays(p,s){return p.map((a,w)=>a+s[w])}static addItems(p,s){return p.map(a=>a+s)}static sum(p){return p.reduce((s,a)=>s+a)}static dot(p,s){return E.mulMatrix(p,s)}static vectorLen(p){return Math.hypot(...p)}static divItems(p,s){return p.map(a=>a/s)}static squareItems(p){return p.map(s=>s*s)}static normalize(p){return this.divItems(p,this.vectorLen(p))}}class _{static q(p,s){var a=1-s,w=E.mulItems(p[0],a*a*a),R=E.mulItems(p[1],3*a*a*s),S=E.mulItems(p[2],3*a*s*s),t=E.mulItems(p[3],s*s*s);return E.addArrays(E.addArrays(w,R),E.addArrays(S,t))}static qprime(p,s){var a=1-s,w=E.mulItems(E.subtract(p[1],p[0]),3*a*a),R=E.mulItems(E.subtract(p[2],p[1]),6*a*s),S=E.mulItems(E.subtract(p[3],p[2]),3*s*s);return E.addArrays(E.addArrays(w,R),S)}static qprimeprime(p,s){return E.addArrays(E.mulItems(E.addArrays(E.subtract(p[2],E.mulItems(p[1],2)),p[0]),6*(1-s)),E.mulItems(E.addArrays(E.subtract(p[3],E.mulItems(p[2],2)),p[1]),6*s))}}v.exports=n,v.exports.fitCubic=L,v.exports.createTangent=k},(v,n,L)=>{var u,Xt,C,Ze,$,we,J,ke;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationLayer=void 0;var i=L(1),y=L(6),B=L(3),q=L(33),Z=L(34);const N=1e3,T=9,b=new WeakSet;function k(M){return{width:M[2]-M[0],height:M[3]-M[1]}}class E{static create(e){switch(e.data.annotationType){case i.AnnotationType.LINK:return new d(e);case i.AnnotationType.TEXT:return new p(e);case i.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new a(e);case"Btn":return e.data.radioButton?new R(e):e.data.checkBox?new w(e):new S(e);case"Ch":return new t(e)}return new s(e);case i.AnnotationType.POPUP:return new c(e);case i.AnnotationType.FREETEXT:return new r(e);case i.AnnotationType.LINE:return new g(e);case i.AnnotationType.SQUARE:return new x(e);case i.AnnotationType.CIRCLE:return new o(e);case i.AnnotationType.POLYLINE:return new D(e);case i.AnnotationType.CARET:return new K(e);case i.AnnotationType.INK:return new tt(e);case i.AnnotationType.POLYGON:return new z(e);case i.AnnotationType.HIGHLIGHT:return new it(e);case i.AnnotationType.UNDERLINE:return new ft(e);case i.AnnotationType.SQUIGGLY:return new lt(e);case i.AnnotationType.STRIKEOUT:return new ut(e);case i.AnnotationType.STAMP:return new _t(e);case i.AnnotationType.FILEATTACHMENT:return new yt(e);default:return new _(e)}}}class _{constructor(e,{isRenderable:l=!1,ignoreBorder:A=!1,createQuadrilaterals:P=!1}={}){this.isRenderable=l,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,l&&(this.container=this._createContainer(A)),P&&(this.quadrilaterals=this._createQuadrilaterals(A))}_createContainer(e=!1){const{data:l,page:A,viewport:P}=this,O=document.createElement("section");O.setAttribute("data-annotation-id",l.id),l.noRotate&&O.classList.add("norotate");const{pageWidth:U,pageHeight:nt,pageX:st,pageY:rt}=P.rawDims,{width:at,height:dt}=k(l.rect),ct=i.Util.normalizeRect([l.rect[0],A.view[3]-l.rect[1]+A.view[1],l.rect[2],A.view[3]-l.rect[3]+A.view[1]]);if(!e&&l.borderStyle.width>0){O.style.borderWidth=`${l.borderStyle.width}px`;const gt=l.borderStyle.horizontalCornerRadius,Ct=l.borderStyle.verticalCornerRadius;if(gt>0||Ct>0){const wt=`calc(${gt}px * var(--scale-factor)) / calc(${Ct}px * var(--scale-factor))`;O.style.borderRadius=wt}else if(this instanceof R){const wt=`calc(${at}px * var(--scale-factor)) / calc(${dt}px * var(--scale-factor))`;O.style.borderRadius=wt}switch(l.borderStyle.style){case i.AnnotationBorderStyleType.SOLID:O.style.borderStyle="solid";break;case i.AnnotationBorderStyleType.DASHED:O.style.borderStyle="dashed";break;case i.AnnotationBorderStyleType.BEVELED:(0,i.warn)("Unimplemented border style: beveled");break;case i.AnnotationBorderStyleType.INSET:(0,i.warn)("Unimplemented border style: inset");break;case i.AnnotationBorderStyleType.UNDERLINE:O.style.borderBottomStyle="solid";break}const At=l.borderColor||null;At?O.style.borderColor=i.Util.makeHexColor(At[0]|0,At[1]|0,At[2]|0):O.style.borderWidth=0}O.style.left=`${100*(ct[0]-st)/U}%`,O.style.top=`${100*(ct[1]-rt)/nt}%`;const{rotation:bt}=l;return l.hasOwnCanvas||bt===0?(O.style.width=`${100*at/U}%`,O.style.height=`${100*dt/nt}%`):this.setRotation(bt,O),O}setRotation(e,l=this.container){const{pageWidth:A,pageHeight:P}=this.viewport.rawDims,{width:O,height:U}=k(this.data.rect);let nt,st;e%180===0?(nt=100*O/A,st=100*U/P):(nt=100*U/A,st=100*O/P),l.style.width=`${nt}%`,l.style.height=`${st}%`,l.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(l,A,P)=>{const O=P.detail[l];P.target.style[A]=q.ColorConverters[`${O[0]}_HTML`](O.slice(1))};return(0,i.shadow)(this,"_commonActions",{display:l=>{const A=l.detail.display%2===1;this.container.style.visibility=A?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:A,print:l.detail.display===0||l.detail.display===3})},print:l=>{this.annotationStorage.setValue(this.data.id,{print:l.detail.print})},hidden:l=>{this.container.style.visibility=l.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:l.detail.hidden})},focus:l=>{setTimeout(()=>l.target.focus({preventScroll:!1}),0)},userName:l=>{l.target.title=l.detail.userName},readonly:l=>{l.detail.readonly?l.target.setAttribute("readonly",""):l.target.removeAttribute("readonly")},required:l=>{this._setRequired(l.target,l.detail.required)},bgColor:l=>{e("bgColor","backgroundColor",l)},fillColor:l=>{e("fillColor","backgroundColor",l)},fgColor:l=>{e("fgColor","color",l)},textColor:l=>{e("textColor","color",l)},borderColor:l=>{e("borderColor","borderColor",l)},strokeColor:l=>{e("strokeColor","borderColor",l)},rotation:l=>{const A=l.detail.rotation;this.setRotation(A),this.annotationStorage.setValue(this.data.id,{rotation:A})}})}_dispatchEventFromSandbox(e,l){const A=this._commonActions;for(const P of Object.keys(l.detail)){const O=e[P]||A[P];O==null||O(l)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const l=this.annotationStorage.getRawValue(this.data.id);if(!l)return;const A=this._commonActions;for(const[P,O]of Object.entries(l)){const U=A[P];if(U){const nt={detail:{[P]:O},target:e};U(nt),delete l[P]}}}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const l=[],A=this.data.rect;for(const P of this.data.quadPoints)this.data.rect=[P[2].x,P[2].y,P[1].x,P[1].y],l.push(this._createContainer(e));return this.data.rect=A,l}_createPopup(e,l){let A=this.container;this.quadrilaterals&&(e=e||this.quadrilaterals,A=this.quadrilaterals[0]),e||(e=document.createElement("div"),e.classList.add("popupTriggerArea"),A.append(e));const O=new h({container:A,trigger:e,color:l.color,titleObj:l.titleObj,modificationDate:l.modificationDate,contentsObj:l.contentsObj,richText:l.richText,hideWrapper:!0}).render();O.style.left="100%",A.append(O)}_renderQuadrilaterals(e){for(const l of this.quadrilaterals)l.classList.add(e);return this.quadrilaterals}render(){(0,i.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,l=null){const A=[];if(this._fieldObjects){const P=this._fieldObjects[e];if(P)for(const{page:O,id:U,exportValues:nt}of P){if(O===-1||U===l)continue;const st=typeof nt=="string"?nt:null,rt=document.querySelector(`[data-element-id="${U}"]`);if(rt&&!b.has(rt)){(0,i.warn)(`_getElementsByName - element not allowed: ${U}`);continue}A.push({id:U,exportValue:st,domElement:rt})}return A}for(const P of document.getElementsByName(e)){const{exportValue:O}=P,U=P.getAttribute("data-element-id");U!==l&&(!b.has(P)||A.push({id:U,exportValue:O,domElement:P}))}return A}}class d extends _{constructor(l,A=null){super(l,{isRenderable:!0,ignoreBorder:!!(A!=null&&A.ignoreBorder),createQuadrilaterals:!0});et(this,u);et(this,C);this.isTooltipOnly=l.data.isTooltipOnly}render(){const{data:l,linkService:A}=this,P=document.createElement("a");P.setAttribute("data-element-id",l.id);let O=!1;return l.url?(A.addLinkAttributes(P,l.url,l.newWindow),O=!0):l.action?(this._bindNamedAction(P,l.action),O=!0):l.attachment?(this._bindAttachment(P,l.attachment),O=!0):l.setOCGState?(ot(this,C,Ze).call(this,P,l.setOCGState),O=!0):l.dest?(this._bindLink(P,l.dest),O=!0):(l.actions&&(l.actions.Action||l.actions["Mouse Up"]||l.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(P,l),O=!0),l.resetForm?(this._bindResetFormAction(P,l.resetForm),O=!0):this.isTooltipOnly&&!O&&(this._bindLink(P,""),O=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((U,nt)=>{const st=nt===0?P:P.cloneNode();return U.append(st),U}):(this.container.classList.add("linkAnnotation"),O&&this.container.append(P),this.container)}_bindLink(l,A){l.href=this.linkService.getDestinationHash(A),l.onclick=()=>(A&&this.linkService.goToDestination(A),!1),(A||A==="")&&ot(this,u,Xt).call(this)}_bindNamedAction(l,A){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.linkService.executeNamedAction(A),!1),ot(this,u,Xt).call(this)}_bindAttachment(l,A){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>{var P;return(P=this.downloadManager)==null||P.openOrDownloadData(this.container,A.content,A.filename),!1},ot(this,u,Xt).call(this)}_bindJSAction(l,A){l.href=this.linkService.getAnchorUrl("");const P=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const O of Object.keys(A.actions)){const U=P.get(O);!U||(l[U]=()=>{var nt;return(nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:A.id,name:O}}),!1})}l.onclick||(l.onclick=()=>!1),ot(this,u,Xt).call(this)}_bindResetFormAction(l,A){const P=l.onclick;if(P||(l.href=this.linkService.getAnchorUrl("")),ot(this,u,Xt).call(this),!this._fieldObjects){(0,i.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),P||(l.onclick=()=>!1);return}l.onclick=()=>{var dt;P==null||P();const{fields:O,refs:U,include:nt}=A,st=[];if(O.length!==0||U.length!==0){const ct=new Set(U);for(const bt of O){const gt=this._fieldObjects[bt]||[];for(const{id:Ct}of gt)ct.add(Ct)}for(const bt of Object.values(this._fieldObjects))for(const gt of bt)ct.has(gt.id)===nt&&st.push(gt)}else for(const ct of Object.values(this._fieldObjects))st.push(...ct);const rt=this.annotationStorage,at=[];for(const ct of st){const{id:bt}=ct;switch(at.push(bt),ct.type){case"text":{const Ct=ct.defaultValue||"";rt.setValue(bt,{value:Ct});break}case"checkbox":case"radiobutton":{const Ct=ct.defaultValue===ct.exportValues;rt.setValue(bt,{value:Ct});break}case"combobox":case"listbox":{const Ct=ct.defaultValue||"";rt.setValue(bt,{value:Ct});break}default:continue}const gt=document.querySelector(`[data-element-id="${bt}"]`);if(gt){if(!b.has(gt)){(0,i.warn)(`_bindResetFormAction - element not allowed: ${bt}`);continue}}else continue;gt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((dt=this.linkService.eventBus)==null||dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:at,name:"ResetForm"}})),!1}}}u=new WeakSet,Xt=function(){this.container.setAttribute("data-internal-link","")},C=new WeakSet,Ze=function(l,A){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.linkService.executeSetOCGState(A),!1),ot(this,u,Xt).call(this)};class p extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.append(e),this.container}}class s extends _{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(e){const{isWin:l,isMac:A}=i.FeatureTest.platform;return l&&e.ctrlKey||A&&e.metaKey}_setEventListener(e,l,A,P){l.includes("mouse")?e.addEventListener(l,O=>{var U;(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:A,value:P(O),shift:O.shiftKey,modifier:this._getKeyModifier(O)}})}):e.addEventListener(l,O=>{var U;(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:A,value:P(O)}})})}_setEventListeners(e,l,A){var P;for(const[O,U]of l)(U==="Action"||((P=this.data.actions)==null?void 0:P[U]))&&this._setEventListener(e,O,U,A)}_setBackgroundColor(e){const l=this.data.backgroundColor||null;e.style.backgroundColor=l===null?"transparent":i.Util.makeHexColor(l[0],l[1],l[2])}_setTextStyle(e){const l=["left","center","right"],{fontColor:A}=this.data.defaultAppearanceData,P=this.data.defaultAppearanceData.fontSize||T,O=e.style;let U;const nt=2,st=rt=>Math.round(10*rt)/10;if(this.data.multiLine){const rt=Math.abs(this.data.rect[3]-this.data.rect[1]-nt),at=Math.round(rt/(i.LINE_FACTOR*P))||1,dt=rt/at;U=Math.min(P,st(dt/i.LINE_FACTOR))}else{const rt=Math.abs(this.data.rect[3]-this.data.rect[1]-nt);U=Math.min(P,st(rt/i.LINE_FACTOR))}O.fontSize=`calc(${U}px * var(--scale-factor))`,O.color=i.Util.makeHexColor(A[0],A[1],A[2]),this.data.textAlignment!==null&&(O.textAlign=l[this.data.textAlignment])}_setRequired(e,l){l?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",l)}}class a extends s{constructor(e){const l=e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:l})}setPropertyOnSiblings(e,l,A,P){const O=this.annotationStorage;for(const U of this._getElementsByName(e.name,e.id))U.domElement&&(U.domElement[l]=A),O.setValue(U.id,{[P]:A})}render(){var P;const e=this.annotationStorage,l=this.data.id;this.container.classList.add("textWidgetAnnotation");let A=null;if(this.renderForms){const O=e.getValue(l,{value:this.data.fieldValue});let U=O.formattedValue||O.value||"";const nt=e.getValue(l,{charLimit:this.data.maxLen}).charLimit;nt&&U.length>nt&&(U=U.slice(0,nt));const st={userValue:U,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(A=document.createElement("textarea"),A.textContent=U,this.data.doNotScroll&&(A.style.overflowY="hidden")):(A=document.createElement("input"),A.type="text",A.setAttribute("value",U),this.data.doNotScroll&&(A.style.overflowX="hidden")),b.add(A),A.setAttribute("data-element-id",l),A.disabled=this.data.readOnly,A.name=this.data.fieldName,A.tabIndex=N,this._setRequired(A,this.data.required),nt&&(A.maxLength=nt),A.addEventListener("input",at=>{e.setValue(l,{value:at.target.value}),this.setPropertyOnSiblings(A,"value",at.target.value,"value")}),A.addEventListener("resetform",at=>{var ct;const dt=(ct=this.data.defaultFieldValue)!=null?ct:"";A.value=st.userValue=dt,st.formattedValue=null});let rt=at=>{const{formattedValue:dt}=st;dt!=null&&(at.target.value=dt),at.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){A.addEventListener("focus",dt=>{const{target:ct}=dt;st.userValue&&(ct.value=st.userValue),st.lastCommittedValue=ct.value,st.commitKey=1}),A.addEventListener("updatefromsandbox",dt=>{const ct={value(bt){var gt;st.userValue=(gt=bt.detail.value)!=null?gt:"",e.setValue(l,{value:st.userValue.toString()}),bt.target.value=st.userValue},formattedValue(bt){const{formattedValue:gt}=bt.detail;st.formattedValue=gt,gt!=null&&bt.target!==document.activeElement&&(bt.target.value=gt),e.setValue(l,{formattedValue:gt})},selRange(bt){bt.target.setSelectionRange(...bt.detail.selRange)},charLimit:bt=>{var wt;const{charLimit:gt}=bt.detail,{target:Ct}=bt;if(gt===0){Ct.removeAttribute("maxLength");return}Ct.setAttribute("maxLength",gt);let At=st.userValue;!At||At.length<=gt||(At=At.slice(0,gt),Ct.value=st.userValue=At,e.setValue(l,{value:At}),(wt=this.linkService.eventBus)==null||wt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:At,willCommit:!0,commitKey:1,selStart:Ct.selectionStart,selEnd:Ct.selectionEnd}}))}};this._dispatchEventFromSandbox(ct,dt)}),A.addEventListener("keydown",dt=>{var gt;st.commitKey=1;let ct=-1;if(dt.key==="Escape"?ct=0:dt.key==="Enter"&&!this.data.multiLine?ct=2:dt.key==="Tab"&&(st.commitKey=3),ct===-1)return;const{value:bt}=dt.target;st.lastCommittedValue!==bt&&(st.lastCommittedValue=bt,st.userValue=bt,(gt=this.linkService.eventBus)==null||gt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:bt,willCommit:!0,commitKey:ct,selStart:dt.target.selectionStart,selEnd:dt.target.selectionEnd}}))});const at=rt;rt=null,A.addEventListener("blur",dt=>{var bt;if(!dt.relatedTarget)return;const{value:ct}=dt.target;st.userValue=ct,st.lastCommittedValue!==ct&&((bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:ct,willCommit:!0,commitKey:st.commitKey,selStart:dt.target.selectionStart,selEnd:dt.target.selectionEnd}})),at(dt)}),(P=this.data.actions)!=null&&P.Keystroke&&A.addEventListener("beforeinput",dt=>{var H;st.lastCommittedValue=null;const{data:ct,target:bt}=dt,{value:gt,selectionStart:Ct,selectionEnd:At}=bt;let wt=Ct,F=At;switch(dt.inputType){case"deleteWordBackward":{const W=gt.substring(0,Ct).match(/\w*[^\w]*$/);W&&(wt-=W[0].length);break}case"deleteWordForward":{const W=gt.substring(Ct).match(/^[^\w]*\w*/);W&&(F+=W[0].length);break}case"deleteContentBackward":Ct===At&&(wt-=1);break;case"deleteContentForward":Ct===At&&(F+=1);break}dt.preventDefault(),(H=this.linkService.eventBus)==null||H.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:gt,change:ct||"",willCommit:!1,selStart:wt,selEnd:F}})}),this._setEventListeners(A,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],dt=>dt.target.value)}if(rt&&A.addEventListener("blur",rt),this.data.comb){const dt=(this.data.rect[2]-this.data.rect[0])/nt;A.classList.add("comb"),A.style.letterSpacing=`calc(${dt}px * var(--scale-factor) - 1ch)`}}else A=document.createElement("div"),A.textContent=this.data.fieldValue,A.style.verticalAlign="middle",A.style.display="table-cell";return this._setTextStyle(A),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}class w extends s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,l=this.data,A=l.id;let P=e.getValue(A,{value:l.exportValue===l.fieldValue}).value;typeof P=="string"&&(P=P!=="Off",e.setValue(A,{value:P})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const O=document.createElement("input");return b.add(O),O.setAttribute("data-element-id",A),O.disabled=l.readOnly,this._setRequired(O,this.data.required),O.type="checkbox",O.name=l.fieldName,P&&O.setAttribute("checked",!0),O.setAttribute("exportValue",l.exportValue),O.tabIndex=N,O.addEventListener("change",U=>{const{name:nt,checked:st}=U.target;for(const rt of this._getElementsByName(nt,A)){const at=st&&rt.exportValue===l.exportValue;rt.domElement&&(rt.domElement.checked=at),e.setValue(rt.id,{value:at})}e.setValue(A,{value:st})}),O.addEventListener("resetform",U=>{const nt=l.defaultFieldValue||"Off";U.target.checked=nt===l.exportValue}),this.enableScripting&&this.hasJSActions&&(O.addEventListener("updatefromsandbox",U=>{const nt={value(st){st.target.checked=st.detail.value!=="Off",e.setValue(A,{value:st.target.checked})}};this._dispatchEventFromSandbox(nt,U)}),this._setEventListeners(O,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],U=>U.target.checked)),this._setBackgroundColor(O),this._setDefaultPropertiesFromJS(O),this.container.append(O),this.container}}class R extends s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,l=this.data,A=l.id;let P=e.getValue(A,{value:l.fieldValue===l.buttonValue}).value;typeof P=="string"&&(P=P!==l.buttonValue,e.setValue(A,{value:P}));const O=document.createElement("input");if(b.add(O),O.setAttribute("data-element-id",A),O.disabled=l.readOnly,this._setRequired(O,this.data.required),O.type="radio",O.name=l.fieldName,P&&O.setAttribute("checked",!0),O.tabIndex=N,O.addEventListener("change",U=>{const{name:nt,checked:st}=U.target;for(const rt of this._getElementsByName(nt,A))e.setValue(rt.id,{value:!1});e.setValue(A,{value:st})}),O.addEventListener("resetform",U=>{const nt=l.defaultFieldValue;U.target.checked=nt!=null&&nt===l.buttonValue}),this.enableScripting&&this.hasJSActions){const U=l.buttonValue;O.addEventListener("updatefromsandbox",nt=>{const st={value:rt=>{const at=U===rt.detail.value;for(const dt of this._getElementsByName(rt.target.name)){const ct=at&&dt.id===A;dt.domElement&&(dt.domElement.checked=ct),e.setValue(dt.id,{value:ct})}}};this._dispatchEventFromSandbox(st,nt)}),this._setEventListeners(O,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],nt=>nt.target.checked)}return this._setBackgroundColor(O),this._setDefaultPropertiesFromJS(O),this.container.append(O),this.container}}class S extends d{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(e.title=this.data.alternativeText);const l=e.lastChild;return this.enableScripting&&this.hasJSActions&&l&&(this._setDefaultPropertiesFromJS(l),l.addEventListener("updatefromsandbox",A=>{this._dispatchEventFromSandbox({},A)})),e}}class t extends s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,l=this.data.id,A=e.getValue(l,{value:this.data.fieldValue}),P=document.createElement("select");b.add(P),P.setAttribute("data-element-id",l),P.disabled=this.data.readOnly,this._setRequired(P,this.data.required),P.name=this.data.fieldName,P.tabIndex=N;let O=this.data.combo&&this.data.options.length>0;this.data.combo||(P.size=this.data.options.length,this.data.multiSelect&&(P.multiple=!0)),P.addEventListener("resetform",at=>{const dt=this.data.defaultFieldValue;for(const ct of P.options)ct.selected=ct.value===dt});for(const at of this.data.options){const dt=document.createElement("option");dt.textContent=at.displayValue,dt.value=at.exportValue,A.value.includes(at.exportValue)&&(dt.setAttribute("selected",!0),O=!1),P.append(dt)}let U=null;if(O){const at=document.createElement("option");at.value=" ",at.setAttribute("hidden",!0),at.setAttribute("selected",!0),P.prepend(at),U=()=>{at.remove(),P.removeEventListener("input",U),U=null},P.addEventListener("input",U)}const nt=at=>{const dt=at?"value":"textContent",{options:ct,multiple:bt}=P;return bt?Array.prototype.filter.call(ct,gt=>gt.selected).map(gt=>gt[dt]):ct.selectedIndex===-1?null:ct[ct.selectedIndex][dt]};let st=nt(!1);const rt=at=>{const dt=at.target.options;return Array.prototype.map.call(dt,ct=>({displayValue:ct.textContent,exportValue:ct.value}))};return this.enableScripting&&this.hasJSActions?(P.addEventListener("updatefromsandbox",at=>{const dt={value(ct){U==null||U();const bt=ct.detail.value,gt=new Set(Array.isArray(bt)?bt:[bt]);for(const Ct of P.options)Ct.selected=gt.has(Ct.value);e.setValue(l,{value:nt(!0)}),st=nt(!1)},multipleSelection(ct){P.multiple=!0},remove(ct){const bt=P.options,gt=ct.detail.remove;bt[gt].selected=!1,P.remove(gt),bt.length>0&&Array.prototype.findIndex.call(bt,At=>At.selected)===-1&&(bt[0].selected=!0),e.setValue(l,{value:nt(!0),items:rt(ct)}),st=nt(!1)},clear(ct){for(;P.length!==0;)P.remove(0);e.setValue(l,{value:null,items:[]}),st=nt(!1)},insert(ct){const{index:bt,displayValue:gt,exportValue:Ct}=ct.detail.insert,At=P.children[bt],wt=document.createElement("option");wt.textContent=gt,wt.value=Ct,At?At.before(wt):P.append(wt),e.setValue(l,{value:nt(!0),items:rt(ct)}),st=nt(!1)},items(ct){const{items:bt}=ct.detail;for(;P.length!==0;)P.remove(0);for(const gt of bt){const{displayValue:Ct,exportValue:At}=gt,wt=document.createElement("option");wt.textContent=Ct,wt.value=At,P.append(wt)}P.options.length>0&&(P.options[0].selected=!0),e.setValue(l,{value:nt(!0),items:rt(ct)}),st=nt(!1)},indices(ct){const bt=new Set(ct.detail.indices);for(const gt of ct.target.options)gt.selected=bt.has(gt.index);e.setValue(l,{value:nt(!0)}),st=nt(!1)},editable(ct){ct.target.disabled=!ct.detail.editable}};this._dispatchEventFromSandbox(dt,at)}),P.addEventListener("input",at=>{var ct;const dt=nt(!0);e.setValue(l,{value:dt}),at.preventDefault(),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:st,changeEx:dt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(P,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],at=>at.target.value)):P.addEventListener("input",function(at){e.setValue(l,{value:nt(!0)})}),this.data.combo&&this._setTextStyle(P),this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}const I=class extends _{constructor(e){var P,O,U;const{data:l}=e,A=!I.IGNORE_TYPES.has(l.parentType)&&!!(((P=l.titleObj)==null?void 0:P.str)||((O=l.contentsObj)==null?void 0:O.str)||((U=l.richText)==null?void 0:U.str));super(e,{isRenderable:A})}render(){this.container.classList.add("popupAnnotation");const e=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(e.length===0)return this.container;const l=new h({container:this.container,trigger:Array.from(e),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),A=this.page,P=i.Util.normalizeRect([this.data.parentRect[0],A.view[3]-this.data.parentRect[1]+A.view[1],this.data.parentRect[2],A.view[3]-this.data.parentRect[3]+A.view[1]]),O=P[0]+this.data.parentRect[2]-this.data.parentRect[0],U=P[1],{pageWidth:nt,pageHeight:st,pageX:rt,pageY:at}=this.viewport.rawDims;return this.container.style.left=`${100*(O-rt)/nt}%`,this.container.style.top=`${100*(U-at)/st}%`,this.container.append(l.render()),this.container}};let c=I;It(c,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class h{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.richText=e.richText,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){var nt,st;const l=document.createElement("div");l.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?l:this.container,this.hideElement.hidden=!0;const A=document.createElement("div");A.classList.add("popup");const P=this.color;if(P){const rt=.7*(255-P[0])+P[0],at=.7*(255-P[1])+P[1],dt=.7*(255-P[2])+P[2];A.style.backgroundColor=i.Util.makeHexColor(rt|0,at|0,dt|0)}const O=document.createElement("h1");O.dir=this.titleObj.dir,O.textContent=this.titleObj.str,A.append(O);const U=y.PDFDateString.toDateObject(this.modificationDate);if(U){const rt=document.createElement("span");rt.classList.add("popupDate"),rt.textContent="{{date}}, {{time}}",rt.dataset.l10nId="annotation_date_string",rt.dataset.l10nArgs=JSON.stringify({date:U.toLocaleDateString(),time:U.toLocaleTimeString()}),A.append(rt)}if(((nt=this.richText)==null?void 0:nt.str)&&(!((st=this.contentsObj)!=null&&st.str)||this.contentsObj.str===this.richText.str))Z.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:A}),A.lastChild.classList.add("richText","popupContent");else{const rt=this._formatContents(this.contentsObj);A.append(rt)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const rt of this.trigger)rt.addEventListener("click",this._toggle.bind(this)),rt.addEventListener("mouseover",this._show.bind(this,!1)),rt.addEventListener("mouseout",this._hide.bind(this,!1));return A.addEventListener("click",this._hide.bind(this,!0)),l.append(A),l}_formatContents({str:e,dir:l}){const A=document.createElement("p");A.classList.add("popupContent"),A.dir=l;const P=e.split(/(?:\r\n?|\n)/);for(let O=0,U=P.length;O<U;++O){const nt=P[O];A.append(document.createTextNode(nt)),O<U-1&&A.append(document.createElement("br"))}return A}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(e=!0){e&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class r extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0}),this.textContent=e.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const l of this.textContent){const A=document.createElement("span");A.textContent=l,e.append(A)}this.container.append(e)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class g extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:l,height:A}=k(e.rect),P=this.svgFactory.create(l,A,!0),O=this.svgFactory.createElement("svg:line");return O.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),O.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),O.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),O.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),O.setAttribute("stroke-width",e.borderStyle.width||1),O.setAttribute("stroke","transparent"),O.setAttribute("fill","transparent"),P.append(O),this.container.append(P),this._createPopup(O,e),this.container}}class x extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:l,height:A}=k(e.rect),P=this.svgFactory.create(l,A,!0),O=e.borderStyle.width,U=this.svgFactory.createElement("svg:rect");return U.setAttribute("x",O/2),U.setAttribute("y",O/2),U.setAttribute("width",l-O),U.setAttribute("height",A-O),U.setAttribute("stroke-width",O||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),P.append(U),this.container.append(P),this._createPopup(U,e),this.container}}class o extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:l,height:A}=k(e.rect),P=this.svgFactory.create(l,A,!0),O=e.borderStyle.width,U=this.svgFactory.createElement("svg:ellipse");return U.setAttribute("cx",l/2),U.setAttribute("cy",A/2),U.setAttribute("rx",l/2-O/2),U.setAttribute("ry",A/2-O/2),U.setAttribute("stroke-width",O||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),P.append(U),this.container.append(P),this._createPopup(U,e),this.container}}class D extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:l,height:A}=k(e.rect),P=this.svgFactory.create(l,A,!0);let O=[];for(const nt of e.vertices){const st=nt.x-e.rect[0],rt=e.rect[3]-nt.y;O.push(st+","+rt)}O=O.join(" ");const U=this.svgFactory.createElement(this.svgElementName);return U.setAttribute("points",O),U.setAttribute("stroke-width",e.borderStyle.width||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),P.append(U),this.container.append(P),this._createPopup(U,e),this.container}}class z extends D{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class K extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class tt extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:l,height:A}=k(e.rect),P=this.svgFactory.create(l,A,!0);for(const O of e.inkLists){let U=[];for(const st of O){const rt=st.x-e.rect[0],at=e.rect[3]-st.y;U.push(`${rt},${at}`)}U=U.join(" ");const nt=this.svgFactory.createElement(this.svgElementName);nt.setAttribute("points",U),nt.setAttribute("stroke-width",e.borderStyle.width||1),nt.setAttribute("stroke","transparent"),nt.setAttribute("fill","transparent"),this._createPopup(nt,e),P.append(nt)}return this.container.append(P),this.container}}class it extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class ft extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class lt extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class ut extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class _t extends _{constructor(e){var A,P,O;const l=!!(e.data.hasPopup||((A=e.data.titleObj)==null?void 0:A.str)||((P=e.data.contentsObj)==null?void 0:P.str)||((O=e.data.richText)==null?void 0:O.str));super(e,{isRenderable:l,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class yt extends _{constructor(e){var P;super(e,{isRenderable:!0});const{filename:l,content:A}=this.data.file;this.filename=(0,y.getFilenameFromUrl)(l,!0),this.content=A,(P=this.linkService.eventBus)==null||P.dispatch("fileattachmentannotation",{source:this,filename:l,content:A})}render(){var l,A;this.container.classList.add("fileAttachmentAnnotation");let e;return this.data.hasAppearance?e=document.createElement("div"):(e=document.createElement("img"),e.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),e.classList.add("popupTriggerArea"),e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(((l=this.data.titleObj)==null?void 0:l.str)||((A=this.data.contentsObj)==null?void 0:A.str)||this.data.richText)&&this._createPopup(e,this.data),this.container.append(e),this.container}_download(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)}}const j=class{static render(e){var st,rt;const{annotations:l,div:A,viewport:P,accessibilityManager:O}=e;(0,y.setLayerDimensions)(A,P);const U={data:null,layer:A,page:e.page,viewport:P,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new y.DOMSVGFactory,annotationStorage:e.annotationStorage||new B.AnnotationStorage,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects};let nt=0;for(const at of l){if(at.noHTML)continue;if(at.annotationType!==i.AnnotationType.POPUP){const{width:bt,height:gt}=k(at.rect);if(bt<=0||gt<=0)continue}U.data=at;const dt=E.create(U);if(!dt.isRenderable)continue;const ct=dt.render();if(at.hidden&&(ct.style.visibility="hidden"),Array.isArray(ct))for(const bt of ct)bt.style.zIndex=nt++,ot(st=j,$,we).call(st,bt,at.id,A,O);else ct.style.zIndex=nt++,dt instanceof c?A.prepend(ct):ot(rt=j,$,we).call(rt,ct,at.id,A,O)}ot(this,J,ke).call(this,A,e.annotationCanvasMap)}static update(e){const{annotationCanvasMap:l,div:A,viewport:P}=e;(0,y.setLayerDimensions)(A,{rotation:P.rotation}),ot(this,J,ke).call(this,A,l),A.hidden=!1}};let G=j;$=new WeakSet,we=function(e,l,A,P){const O=e.firstChild||e;O.id=`${y.AnnotationPrefix}${l}`,A.append(e),P==null||P.moveElementInDOM(A,e,O,!1)},J=new WeakSet,ke=function(e,l){if(!!l){for(const[A,P]of l){const O=e.querySelector(`[data-annotation-id="${A}"]`);if(!O)continue;const{firstChild:U}=O;U?U.nodeName==="CANVAS"?U.replaceWith(P):U.before(P):O.append(P)}l.clear()}},et(G,$),et(G,J),n.AnnotationLayer=G},(v,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function L(y){return Math.floor(Math.max(0,Math.min(1,y))*255).toString(16).padStart(2,"0")}class i{static CMYK_G([B,q,Z,N]){return["G",1-Math.min(1,.3*B+.59*Z+.11*q+N)]}static G_CMYK([B]){return["CMYK",0,0,0,1-B]}static G_RGB([B]){return["RGB",B,B,B]}static G_HTML([B]){const q=L(B);return`#${q}${q}${q}`}static RGB_G([B,q,Z]){return["G",.3*B+.59*q+.11*Z]}static RGB_HTML([B,q,Z]){const N=L(B),T=L(q),b=L(Z);return`#${N}${T}${b}`}static T_HTML(){return"#00000000"}static CMYK_RGB([B,q,Z,N]){return["RGB",1-Math.min(1,B+N),1-Math.min(1,Z+N),1-Math.min(1,q+N)]}static CMYK_HTML(B){const q=this.CMYK_RGB(B).slice(1);return this.RGB_HTML(q)}static RGB_CMYK([B,q,Z]){const N=1-B,T=1-q,b=1-Z,k=Math.min(N,T,b);return["CMYK",N,T,b,k]}}n.ColorConverters=i},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var i=L(19);class y{static setupStorage(q,Z,N,T,b){const k=T.getValue(Z,{value:null});switch(N.name){case"textarea":if(k.value!==null&&(q.textContent=k.value),b==="print")break;q.addEventListener("input",E=>{T.setValue(Z,{value:E.target.value})});break;case"input":if(N.attributes.type==="radio"||N.attributes.type==="checkbox"){if(k.value===N.attributes.xfaOn?q.setAttribute("checked",!0):k.value===N.attributes.xfaOff&&q.removeAttribute("checked"),b==="print")break;q.addEventListener("change",E=>{T.setValue(Z,{value:E.target.checked?E.target.getAttribute("xfaOn"):E.target.getAttribute("xfaOff")})})}else{if(k.value!==null&&q.setAttribute("value",k.value),b==="print")break;q.addEventListener("input",E=>{T.setValue(Z,{value:E.target.value})})}break;case"select":if(k.value!==null)for(const E of N.children)E.attributes.value===k.value&&(E.attributes.selected=!0);q.addEventListener("input",E=>{const _=E.target.options,d=_.selectedIndex===-1?"":_[_.selectedIndex].value;T.setValue(Z,{value:d})});break}}static setAttributes({html:q,element:Z,storage:N=null,intent:T,linkService:b}){const{attributes:k}=Z,E=q instanceof HTMLAnchorElement;k.type==="radio"&&(k.name=`${k.name}-${T}`);for(const[_,d]of Object.entries(k))if(d!=null)switch(_){case"class":d.length&&q.setAttribute(_,d.join(" "));break;case"dataId":break;case"id":q.setAttribute("data-element-id",d);break;case"style":Object.assign(q.style,d);break;case"textContent":q.textContent=d;break;default:(!E||_!=="href"&&_!=="newWindow")&&q.setAttribute(_,d)}E&&b.addLinkAttributes(q,k.href,k.newWindow),N&&k.dataId&&this.setupStorage(q,k.dataId,Z,N)}static render(q){var p;const Z=q.annotationStorage,N=q.linkService,T=q.xfaHtml,b=q.intent||"display",k=document.createElement(T.name);T.attributes&&this.setAttributes({html:k,element:T,intent:b,linkService:N});const E=[[T,-1,k]],_=q.div;if(_.append(k),q.viewport){const s=`matrix(${q.viewport.transform.join(",")})`;_.style.transform=s}b!=="richText"&&_.setAttribute("class","xfaLayer xfaFont");const d=[];for(;E.length>0;){const[s,a,w]=E.at(-1);if(a+1===s.children.length){E.pop();continue}const R=s.children[++E.at(-1)[1]];if(R===null)continue;const{name:S}=R;if(S==="#text"){const c=document.createTextNode(R.value);d.push(c),w.append(c);continue}let t;if((p=R==null?void 0:R.attributes)!=null&&p.xmlns?t=document.createElementNS(R.attributes.xmlns,S):t=document.createElement(S),w.append(t),R.attributes&&this.setAttributes({html:t,element:R,storage:Z,intent:b,linkService:N}),R.children&&R.children.length>0)E.push([R,-1,t]);else if(R.value){const c=document.createTextNode(R.value);i.XfaText.shouldBuildText(S)&&d.push(c),t.append(c)}}for(const s of _.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))s.setAttribute("readOnly",!0);return{textDivs:d}}static update(q){const Z=`matrix(${q.viewport.transform.join(",")})`;q.div.style.transform=Z,q.div.hidden=!1}}n.XfaLayer=y},(v,n,L)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var i=L(6),y=L(1),B=L(10);let q=class{constructor(){(0,y.unreachable)("Not implemented: SVGGraphics")}};n.SVGGraphics=q;{let p=function(t){let c=[];const h=[];for(const r of t){if(r.fn==="save"){c.push({fnId:92,fn:"group",items:[]}),h.push(c),c=c.at(-1).items;continue}r.fn==="restore"?c=h.pop():c.push(r)}return c},s=function(t){if(Number.isInteger(t))return t.toString();const c=t.toFixed(10);let h=c.length-1;if(c[h]!=="0")return c;do h--;while(c[h]==="0");return c.substring(0,c[h]==="."?h:h+1)},a=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${s(t[0])} ${s(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){const c=Math.acos(t[0])*180/Math.PI;return`rotate(${s(c)})`}}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${s(t[4])} ${s(t[5])})`;return`matrix(${s(t[0])} ${s(t[1])} ${s(t[2])} ${s(t[3])} ${s(t[4])} ${s(t[5])})`};const Z={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},N="http://www.w3.org/XML/1998/namespace",T="http://www.w3.org/1999/xlink",b=["butt","round","square"],k=["miter","round","bevel"],E=function(t,c="",h=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!h)return URL.createObjectURL(new Blob([t],{type:c}));const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let g=`data:${c};base64,`;for(let x=0,o=t.length;x<o;x+=3){const D=t[x]&255,z=t[x+1]&255,K=t[x+2]&255,tt=D>>2,it=(D&3)<<4|z>>4,ft=x+1<o?(z&15)<<2|K>>6:64,lt=x+2<o?K&63:64;g+=r[tt]+r[it]+r[ft]+r[lt]}return g},_=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),c=12,h=new Int32Array(256);for(let K=0;K<256;K++){let tt=K;for(let it=0;it<8;it++)tt&1?tt=3988292384^tt>>1&2147483647:tt=tt>>1&2147483647;h[K]=tt}function r(K,tt,it){let ft=-1;for(let lt=tt;lt<it;lt++){const ut=(ft^K[lt])&255,_t=h[ut];ft=ft>>>8^_t}return ft^-1}function g(K,tt,it,ft){let lt=ft;const ut=tt.length;it[lt]=ut>>24&255,it[lt+1]=ut>>16&255,it[lt+2]=ut>>8&255,it[lt+3]=ut&255,lt+=4,it[lt]=K.charCodeAt(0)&255,it[lt+1]=K.charCodeAt(1)&255,it[lt+2]=K.charCodeAt(2)&255,it[lt+3]=K.charCodeAt(3)&255,lt+=4,it.set(tt,lt),lt+=tt.length;const _t=r(it,ft+4,lt);it[lt]=_t>>24&255,it[lt+1]=_t>>16&255,it[lt+2]=_t>>8&255,it[lt+3]=_t&255}function x(K,tt,it){let ft=1,lt=0;for(let ut=tt;ut<it;++ut)ft=(ft+(K[ut]&255))%65521,lt=(lt+ft)%65521;return lt<<16|ft}function o(K){if(!B.isNodeJS)return D(K);try{let tt;parseInt(process.versions.node)>=8?tt=K:tt=Buffer.from(K);const it=require$$5.deflateSync(tt,{level:9});return it instanceof Uint8Array?it:new Uint8Array(it)}catch(tt){(0,y.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+tt)}return D(K)}function D(K){let tt=K.length;const it=65535,ft=Math.ceil(tt/it),lt=new Uint8Array(2+tt+ft*5+4);let ut=0;lt[ut++]=120,lt[ut++]=156;let _t=0;for(;tt>it;)lt[ut++]=0,lt[ut++]=255,lt[ut++]=255,lt[ut++]=0,lt[ut++]=0,lt.set(K.subarray(_t,_t+it),ut),ut+=it,_t+=it,tt-=it;lt[ut++]=1,lt[ut++]=tt&255,lt[ut++]=tt>>8&255,lt[ut++]=~tt&65535&255,lt[ut++]=(~tt&65535)>>8&255,lt.set(K.subarray(_t),ut),ut+=K.length-_t;const yt=x(K,0,K.length);return lt[ut++]=yt>>24&255,lt[ut++]=yt>>16&255,lt[ut++]=yt>>8&255,lt[ut++]=yt&255,lt}function z(K,tt,it,ft){const lt=K.width,ut=K.height;let _t,yt,G;const u=K.data;switch(tt){case y.ImageKind.GRAYSCALE_1BPP:yt=0,_t=1,G=lt+7>>3;break;case y.ImageKind.RGB_24BPP:yt=2,_t=8,G=lt*3;break;case y.ImageKind.RGBA_32BPP:yt=6,_t=8,G=lt*4;break;default:throw new Error("invalid format")}const f=new Uint8Array((1+G)*ut);let C=0,V=0;for(let j=0;j<ut;++j)f[C++]=0,f.set(u.subarray(V,V+G),C),V+=G,C+=G;if(tt===y.ImageKind.GRAYSCALE_1BPP&&ft){C=0;for(let j=0;j<ut;j++){C++;for(let M=0;M<G;M++)f[C++]^=255}}const I=new Uint8Array([lt>>24&255,lt>>16&255,lt>>8&255,lt&255,ut>>24&255,ut>>16&255,ut>>8&255,ut&255,_t,yt,0,0,0]),$=o(f),X=t.length+c*3+I.length+$.length,J=new Uint8Array(X);let Y=0;return J.set(t,Y),Y+=t.length,g("IHDR",I,J,Y),Y+=c+I.length,g("IDATA",$,J,Y),Y+=c+$.length,g("IEND",new Uint8Array(0),J,Y),E(J,"image/png",it)}return function(tt,it,ft){const lt=tt.kind===void 0?y.ImageKind.GRAYSCALE_1BPP:tt.kind;return z(tt,lt,it,ft)}}();class d{constructor(){this.fontSizeScale=1,this.fontWeight=Z.fontWeight,this.fontSize=0,this.textMatrix=y.IDENTITY_MATRIX,this.fontMatrix=y.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=y.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=Z.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(c,h){this.x=c,this.y=h}}let w=0,R=0,S=0;n.SVGGraphics=q=class{constructor(t,c,h=!1){(0,i.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new i.DOMSVGFactory,this.current=new d,this.transformMatrix=y.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=c,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!h,this._operatorIdMapping=[];for(const r in y.OPS)this._operatorIdMapping[y.OPS[r]]=r}getObject(t,c=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):c}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const c=t.fnArray,h=t.argsArray;for(let r=0,g=c.length;r<g;r++)if(c[r]===y.OPS.dependency)for(const x of h[r]){const o=x.startsWith("g_")?this.commonObjs:this.objs,D=new Promise(z=>{o.get(x,z)});this.current.dependencies.push(D)}return Promise.all(this.current.dependencies)}transform(t,c,h,r,g,x){const o=[t,c,h,r,g,x];this.transformMatrix=y.Util.transform(this.transformMatrix,o),this.tgrp=null}getSVG(t,c){this.viewport=c;const h=this._initialize(c);return this.loadDependencies(t).then(()=>(this.transformMatrix=y.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),h))}convertOpList(t){const c=this._operatorIdMapping,h=t.argsArray,r=t.fnArray,g=[];for(let x=0,o=r.length;x<o;x++){const D=r[x];g.push({fnId:D,fn:c[D],args:h[x]})}return p(g)}executeOpTree(t){for(const c of t){const h=c.fn,r=c.fnId,g=c.args;switch(r|0){case y.OPS.beginText:this.beginText();break;case y.OPS.dependency:break;case y.OPS.setLeading:this.setLeading(g);break;case y.OPS.setLeadingMoveText:this.setLeadingMoveText(g[0],g[1]);break;case y.OPS.setFont:this.setFont(g);break;case y.OPS.showText:this.showText(g[0]);break;case y.OPS.showSpacedText:this.showText(g[0]);break;case y.OPS.endText:this.endText();break;case y.OPS.moveText:this.moveText(g[0],g[1]);break;case y.OPS.setCharSpacing:this.setCharSpacing(g[0]);break;case y.OPS.setWordSpacing:this.setWordSpacing(g[0]);break;case y.OPS.setHScale:this.setHScale(g[0]);break;case y.OPS.setTextMatrix:this.setTextMatrix(g[0],g[1],g[2],g[3],g[4],g[5]);break;case y.OPS.setTextRise:this.setTextRise(g[0]);break;case y.OPS.setTextRenderingMode:this.setTextRenderingMode(g[0]);break;case y.OPS.setLineWidth:this.setLineWidth(g[0]);break;case y.OPS.setLineJoin:this.setLineJoin(g[0]);break;case y.OPS.setLineCap:this.setLineCap(g[0]);break;case y.OPS.setMiterLimit:this.setMiterLimit(g[0]);break;case y.OPS.setFillRGBColor:this.setFillRGBColor(g[0],g[1],g[2]);break;case y.OPS.setStrokeRGBColor:this.setStrokeRGBColor(g[0],g[1],g[2]);break;case y.OPS.setStrokeColorN:this.setStrokeColorN(g);break;case y.OPS.setFillColorN:this.setFillColorN(g);break;case y.OPS.shadingFill:this.shadingFill(g[0]);break;case y.OPS.setDash:this.setDash(g[0],g[1]);break;case y.OPS.setRenderingIntent:this.setRenderingIntent(g[0]);break;case y.OPS.setFlatness:this.setFlatness(g[0]);break;case y.OPS.setGState:this.setGState(g[0]);break;case y.OPS.fill:this.fill();break;case y.OPS.eoFill:this.eoFill();break;case y.OPS.stroke:this.stroke();break;case y.OPS.fillStroke:this.fillStroke();break;case y.OPS.eoFillStroke:this.eoFillStroke();break;case y.OPS.clip:this.clip("nonzero");break;case y.OPS.eoClip:this.clip("evenodd");break;case y.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case y.OPS.paintImageXObject:this.paintImageXObject(g[0]);break;case y.OPS.paintInlineImageXObject:this.paintInlineImageXObject(g[0]);break;case y.OPS.paintImageMaskXObject:this.paintImageMaskXObject(g[0]);break;case y.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(g[0],g[1]);break;case y.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case y.OPS.closePath:this.closePath();break;case y.OPS.closeStroke:this.closeStroke();break;case y.OPS.closeFillStroke:this.closeFillStroke();break;case y.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case y.OPS.nextLine:this.nextLine();break;case y.OPS.transform:this.transform(g[0],g[1],g[2],g[3],g[4],g[5]);break;case y.OPS.constructPath:this.constructPath(g[0],g[1]);break;case y.OPS.endPath:this.endPath();break;case 92:this.group(c.items);break;default:(0,y.warn)(`Unimplemented operator ${h}`);break}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,c,h,r,g,x){const o=this.current;o.textMatrix=o.lineMatrix=[t,c,h,r,g,x],o.textMatrixScale=Math.hypot(t,c),o.x=o.lineX=0,o.y=o.lineY=0,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${s(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",s(-o.y)),o.txtElement=this.svgFactory.createElement("svg:text"),o.txtElement.append(o.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=y.IDENTITY_MATRIX,t.lineMatrix=y.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,c){const h=this.current;h.x=h.lineX+=t,h.y=h.lineY+=c,h.xcoords=[],h.ycoords=[],h.tspan=this.svgFactory.createElement("svg:tspan"),h.tspan.setAttributeNS(null,"font-family",h.fontFamily),h.tspan.setAttributeNS(null,"font-size",`${s(h.fontSize)}px`),h.tspan.setAttributeNS(null,"y",s(-h.y))}showText(t){const c=this.current,h=c.font,r=c.fontSize;if(r===0)return;const g=c.fontSizeScale,x=c.charSpacing,o=c.wordSpacing,D=c.fontDirection,z=c.textHScale*D,K=h.vertical,tt=K?1:-1,it=h.defaultVMetrics,ft=r*c.fontMatrix[0];let lt=0;for(const yt of t){if(yt===null){lt+=D*o;continue}else if(typeof yt=="number"){lt+=tt*yt*r/1e3;continue}const G=(yt.isSpace?o:0)+x,u=yt.fontChar;let f,C,V=yt.width;if(K){let $;const X=yt.vmetric||it;$=yt.vmetric?X[1]:V*.5,$=-$*ft;const J=X[2]*ft;V=X?-X[0]:V,f=$/g,C=(lt+J)/g}else f=lt/g,C=0;(yt.isInFont||h.missingFile)&&(c.xcoords.push(c.x+f),K&&c.ycoords.push(-c.y+C),c.tspan.textContent+=u);let I;K?I=V*ft-G*D:I=V*ft+G*D,lt+=I}c.tspan.setAttributeNS(null,"x",c.xcoords.map(s).join(" ")),K?c.tspan.setAttributeNS(null,"y",c.ycoords.map(s).join(" ")):c.tspan.setAttributeNS(null,"y",s(-c.y)),K?c.y-=lt:c.x+=lt*z,c.tspan.setAttributeNS(null,"font-family",c.fontFamily),c.tspan.setAttributeNS(null,"font-size",`${s(c.fontSize)}px`),c.fontStyle!==Z.fontStyle&&c.tspan.setAttributeNS(null,"font-style",c.fontStyle),c.fontWeight!==Z.fontWeight&&c.tspan.setAttributeNS(null,"font-weight",c.fontWeight);const ut=c.textRenderingMode&y.TextRenderingMode.FILL_STROKE_MASK;if(ut===y.TextRenderingMode.FILL||ut===y.TextRenderingMode.FILL_STROKE?(c.fillColor!==Z.fillColor&&c.tspan.setAttributeNS(null,"fill",c.fillColor),c.fillAlpha<1&&c.tspan.setAttributeNS(null,"fill-opacity",c.fillAlpha)):c.textRenderingMode===y.TextRenderingMode.ADD_TO_PATH?c.tspan.setAttributeNS(null,"fill","transparent"):c.tspan.setAttributeNS(null,"fill","none"),ut===y.TextRenderingMode.STROKE||ut===y.TextRenderingMode.FILL_STROKE){const yt=1/(c.textMatrixScale||1);this._setStrokeAttributes(c.tspan,yt)}let _t=c.textMatrix;c.textRise!==0&&(_t=_t.slice(),_t[5]+=c.textRise),c.txtElement.setAttributeNS(null,"transform",`${a(_t)} scale(${s(z)}, -1)`),c.txtElement.setAttributeNS(N,"xml:space","preserve"),c.txtElement.append(c.tspan),c.txtgrp.append(c.txtElement),this._ensureTransformGroup().append(c.txtElement)}setLeadingMoveText(t,c){this.setLeading(-c),this.moveText(t,c)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const c=E(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${c}); }
`}setFont(t){const c=this.current,h=this.commonObjs.get(t[0]);let r=t[1];c.font=h,this.embedFonts&&!h.missingFile&&!this.embeddedFonts[h.loadedName]&&(this.addFontStyle(h),this.embeddedFonts[h.loadedName]=h),c.fontMatrix=h.fontMatrix||y.FONT_IDENTITY_MATRIX;let g="normal";h.black?g="900":h.bold&&(g="bold");const x=h.italic?"italic":"normal";r<0?(r=-r,c.fontDirection=-1):c.fontDirection=1,c.fontSize=r,c.fontFamily=h.loadedName,c.fontWeight=g,c.fontStyle=x,c.tspan=this.svgFactory.createElement("svg:tspan"),c.tspan.setAttributeNS(null,"y",s(-c.y)),c.xcoords=[],c.ycoords=[]}endText(){var c;const t=this.current;t.textRenderingMode&y.TextRenderingMode.ADD_TO_PATH_FLAG&&((c=t.txtElement)==null?void 0:c.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=b[t]}setLineJoin(t){this.current.lineJoin=k[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,c,h){this.current.strokeColor=y.Util.makeHexColor(t,c,h)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,c,h){this.current.fillColor=y.Util.makeHexColor(t,c,h),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const c=this.viewport.width,h=this.viewport.height,r=y.Util.inverseTransform(this.transformMatrix),g=y.Util.applyTransform([0,0],r),x=y.Util.applyTransform([0,h],r),o=y.Util.applyTransform([c,0],r),D=y.Util.applyTransform([c,h],r),z=Math.min(g[0],x[0],o[0],D[0]),K=Math.min(g[1],x[1],o[1],D[1]),tt=Math.max(g[0],x[0],o[0],D[0]),it=Math.max(g[1],x[1],o[1],D[1]),ft=this.svgFactory.createElement("svg:rect");ft.setAttributeNS(null,"x",z),ft.setAttributeNS(null,"y",K),ft.setAttributeNS(null,"width",tt-z),ft.setAttributeNS(null,"height",it-K),ft.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&ft.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(ft)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const c=t[1],h=t[2],r=t[3]||y.IDENTITY_MATRIX,[g,x,o,D]=t[4],z=t[5],K=t[6],tt=t[7],it=`shading${S++}`,[ft,lt,ut,_t]=y.Util.normalizeRect([...y.Util.applyTransform([g,x],r),...y.Util.applyTransform([o,D],r)]),[yt,G]=y.Util.singularValueDecompose2dScale(r),u=z*yt,f=K*G,C=this.svgFactory.createElement("svg:pattern");C.setAttributeNS(null,"id",it),C.setAttributeNS(null,"patternUnits","userSpaceOnUse"),C.setAttributeNS(null,"width",u),C.setAttributeNS(null,"height",f),C.setAttributeNS(null,"x",`${ft}`),C.setAttributeNS(null,"y",`${lt}`);const V=this.svg,I=this.transformMatrix,$=this.current.fillColor,X=this.current.strokeColor,J=this.svgFactory.create(ut-ft,_t-lt);if(this.svg=J,this.transformMatrix=r,tt===2){const Y=y.Util.makeHexColor(...c);this.current.fillColor=Y,this.current.strokeColor=Y}return this.executeOpTree(this.convertOpList(h)),this.svg=V,this.transformMatrix=I,this.current.fillColor=$,this.current.strokeColor=X,C.append(J.childNodes[0]),this.defs.append(C),`url(#${it})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const c=`shading${S++}`,h=t[3];let r;switch(t[1]){case"axial":const g=t[4],x=t[5];r=this.svgFactory.createElement("svg:linearGradient"),r.setAttributeNS(null,"id",c),r.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),r.setAttributeNS(null,"x1",g[0]),r.setAttributeNS(null,"y1",g[1]),r.setAttributeNS(null,"x2",x[0]),r.setAttributeNS(null,"y2",x[1]);break;case"radial":const o=t[4],D=t[5],z=t[6],K=t[7];r=this.svgFactory.createElement("svg:radialGradient"),r.setAttributeNS(null,"id",c),r.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),r.setAttributeNS(null,"cx",D[0]),r.setAttributeNS(null,"cy",D[1]),r.setAttributeNS(null,"r",K),r.setAttributeNS(null,"fx",o[0]),r.setAttributeNS(null,"fy",o[1]),r.setAttributeNS(null,"fr",z);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const g of h){const x=this.svgFactory.createElement("svg:stop");x.setAttributeNS(null,"offset",g[0]),x.setAttributeNS(null,"stop-color",g[1]),r.append(x)}return this.defs.append(r),`url(#${c})`;case"Mesh":return(0,y.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,c){this.current.dashArray=t,this.current.dashPhase=c}constructPath(t,c){const h=this.current;let r=h.x,g=h.y,x=[],o=0;for(const D of t)switch(D|0){case y.OPS.rectangle:r=c[o++],g=c[o++];const z=c[o++],K=c[o++],tt=r+z,it=g+K;x.push("M",s(r),s(g),"L",s(tt),s(g),"L",s(tt),s(it),"L",s(r),s(it),"Z");break;case y.OPS.moveTo:r=c[o++],g=c[o++],x.push("M",s(r),s(g));break;case y.OPS.lineTo:r=c[o++],g=c[o++],x.push("L",s(r),s(g));break;case y.OPS.curveTo:r=c[o+4],g=c[o+5],x.push("C",s(c[o]),s(c[o+1]),s(c[o+2]),s(c[o+3]),s(r),s(g)),o+=6;break;case y.OPS.curveTo2:x.push("C",s(r),s(g),s(c[o]),s(c[o+1]),s(c[o+2]),s(c[o+3])),r=c[o+2],g=c[o+3],o+=4;break;case y.OPS.curveTo3:r=c[o+2],g=c[o+3],x.push("C",s(c[o]),s(c[o+1]),s(r),s(g),s(r),s(g)),o+=4;break;case y.OPS.closePath:x.push("Z");break}x=x.join(" "),h.path&&t.length>0&&t[0]!==y.OPS.rectangle&&t[0]!==y.OPS.moveTo?x=h.path.getAttributeNS(null,"d")+x:(h.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(h.path)),h.path.setAttributeNS(null,"d",x),h.path.setAttributeNS(null,"fill","none"),h.element=h.path,h.setCurrentPoint(r,g)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const c=`clippath${w++}`,h=this.svgFactory.createElement("svg:clipPath");h.setAttributeNS(null,"id",c),h.setAttributeNS(null,"transform",a(this.transformMatrix));const r=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?r.setAttributeNS(null,"clip-rule","evenodd"):r.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,h.append(r),this.defs.append(h),t.activeClipUrl){t.clipGroup=null;for(const g of this.extraStack)g.clipGroup=null;h.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${c})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const c=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",c)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[c,h]of t)switch(c){case"LW":this.setLineWidth(h);break;case"LC":this.setLineCap(h);break;case"LJ":this.setLineJoin(h);break;case"ML":this.setMiterLimit(h);break;case"D":this.setDash(h[0],h[1]);break;case"RI":this.setRenderingIntent(h);break;case"FL":this.setFlatness(h);break;case"Font":this.setFont(h);break;case"CA":this.setStrokeAlpha(h);break;case"ca":this.setFillAlpha(h);break;default:(0,y.warn)(`Unimplemented graphic state operator ${c}`);break}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,c=1){const h=this.current;let r=h.dashArray;c!==1&&r.length>0&&(r=r.map(function(g){return c*g})),t.setAttributeNS(null,"stroke",h.strokeColor),t.setAttributeNS(null,"stroke-opacity",h.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",s(h.miterLimit)),t.setAttributeNS(null,"stroke-linecap",h.lineCap),t.setAttributeNS(null,"stroke-linejoin",h.lineJoin),t.setAttributeNS(null,"stroke-width",s(c*h.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",r.map(s).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",s(c*h.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const c=this.getObject(t);if(!c){(0,y.warn)(`Dependent image with object ID ${t} is not ready yet`);return}this.paintInlineImageXObject(c)}paintInlineImageXObject(t,c){const h=t.width,r=t.height,g=_(t,this.forceDataSchema,!!c),x=this.svgFactory.createElement("svg:rect");x.setAttributeNS(null,"x","0"),x.setAttributeNS(null,"y","0"),x.setAttributeNS(null,"width",s(h)),x.setAttributeNS(null,"height",s(r)),this.current.element=x,this.clip("nonzero");const o=this.svgFactory.createElement("svg:image");o.setAttributeNS(T,"xlink:href",g),o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y",s(-r)),o.setAttributeNS(null,"width",s(h)+"px"),o.setAttributeNS(null,"height",s(r)+"px"),o.setAttributeNS(null,"transform",`scale(${s(1/h)} ${s(-1/r)})`),c?c.append(o):this._ensureTransformGroup().append(o)}paintImageMaskXObject(t){const c=this.getObject(t.data,t);if(c.bitmap){(0,y.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const h=this.current,r=c.width,g=c.height,x=h.fillColor;h.maskId=`mask${R++}`;const o=this.svgFactory.createElement("svg:mask");o.setAttributeNS(null,"id",h.maskId);const D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width",s(r)),D.setAttributeNS(null,"height",s(g)),D.setAttributeNS(null,"fill",x),D.setAttributeNS(null,"mask",`url(#${h.maskId})`),this.defs.append(o),this._ensureTransformGroup().append(D),this.paintInlineImageXObject(c,o)}paintFormXObjectBegin(t,c){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),c){const h=c[2]-c[0],r=c[3]-c[1],g=this.svgFactory.createElement("svg:rect");g.setAttributeNS(null,"x",c[0]),g.setAttributeNS(null,"y",c[1]),g.setAttributeNS(null,"width",s(h)),g.setAttributeNS(null,"height",s(r)),this.current.element=g,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const c=this.svgFactory.create(t.width,t.height),h=this.svgFactory.createElement("svg:defs");c.append(h),this.defs=h;const r=this.svgFactory.createElement("svg:g");return r.setAttributeNS(null,"transform",a(t.transform)),c.append(r),this.svg=r,c}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",a(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(v){var n=__webpack_module_cache__[v];if(n!==void 0)return n.exports;var L=__webpack_module_cache__[v]={exports:{}};return __webpack_modules__[v](L,L.exports,__w_pdfjs_require__),L.exports}var __webpack_exports__={};return(()=>{var v=__webpack_exports__;Object.defineProperty(v,"__esModule",{value:!0}),Object.defineProperty(v,"AbortException",{enumerable:!0,get:function(){return n.AbortException}}),Object.defineProperty(v,"AnnotationEditorLayer",{enumerable:!0,get:function(){return B.AnnotationEditorLayer}}),Object.defineProperty(v,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return n.AnnotationEditorParamsType}}),Object.defineProperty(v,"AnnotationEditorType",{enumerable:!0,get:function(){return n.AnnotationEditorType}}),Object.defineProperty(v,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return q.AnnotationEditorUIManager}}),Object.defineProperty(v,"AnnotationLayer",{enumerable:!0,get:function(){return Z.AnnotationLayer}}),Object.defineProperty(v,"AnnotationMode",{enumerable:!0,get:function(){return n.AnnotationMode}}),Object.defineProperty(v,"CMapCompressionType",{enumerable:!0,get:function(){return n.CMapCompressionType}}),Object.defineProperty(v,"FeatureTest",{enumerable:!0,get:function(){return n.FeatureTest}}),Object.defineProperty(v,"GlobalWorkerOptions",{enumerable:!0,get:function(){return N.GlobalWorkerOptions}}),Object.defineProperty(v,"InvalidPDFException",{enumerable:!0,get:function(){return n.InvalidPDFException}}),Object.defineProperty(v,"MissingPDFException",{enumerable:!0,get:function(){return n.MissingPDFException}}),Object.defineProperty(v,"OPS",{enumerable:!0,get:function(){return n.OPS}}),Object.defineProperty(v,"PDFDataRangeTransport",{enumerable:!0,get:function(){return L.PDFDataRangeTransport}}),Object.defineProperty(v,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(v,"PDFWorker",{enumerable:!0,get:function(){return L.PDFWorker}}),Object.defineProperty(v,"PasswordResponses",{enumerable:!0,get:function(){return n.PasswordResponses}}),Object.defineProperty(v,"PermissionFlag",{enumerable:!0,get:function(){return n.PermissionFlag}}),Object.defineProperty(v,"PixelsPerInch",{enumerable:!0,get:function(){return i.PixelsPerInch}}),Object.defineProperty(v,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(v,"SVGGraphics",{enumerable:!0,get:function(){return T.SVGGraphics}}),Object.defineProperty(v,"UnexpectedResponseException",{enumerable:!0,get:function(){return n.UnexpectedResponseException}}),Object.defineProperty(v,"Util",{enumerable:!0,get:function(){return n.Util}}),Object.defineProperty(v,"VerbosityLevel",{enumerable:!0,get:function(){return n.VerbosityLevel}}),Object.defineProperty(v,"XfaLayer",{enumerable:!0,get:function(){return b.XfaLayer}}),Object.defineProperty(v,"build",{enumerable:!0,get:function(){return L.build}}),Object.defineProperty(v,"createPromiseCapability",{enumerable:!0,get:function(){return n.createPromiseCapability}}),Object.defineProperty(v,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return n.createValidAbsoluteUrl}}),Object.defineProperty(v,"getDocument",{enumerable:!0,get:function(){return L.getDocument}}),Object.defineProperty(v,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(v,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return i.getPdfFilenameFromUrl}}),Object.defineProperty(v,"getXfaPageViewport",{enumerable:!0,get:function(){return i.getXfaPageViewport}}),Object.defineProperty(v,"isDataScheme",{enumerable:!0,get:function(){return i.isDataScheme}}),Object.defineProperty(v,"isPdfFile",{enumerable:!0,get:function(){return i.isPdfFile}}),Object.defineProperty(v,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(v,"renderTextLayer",{enumerable:!0,get:function(){return y.renderTextLayer}}),Object.defineProperty(v,"setLayerDimensions",{enumerable:!0,get:function(){return i.setLayerDimensions}}),Object.defineProperty(v,"shadow",{enumerable:!0,get:function(){return n.shadow}}),Object.defineProperty(v,"updateTextLayer",{enumerable:!0,get:function(){return y.updateTextLayer}}),Object.defineProperty(v,"version",{enumerable:!0,get:function(){return L.version}});var n=__w_pdfjs_require__(1),L=__w_pdfjs_require__(2),i=__w_pdfjs_require__(6),y=__w_pdfjs_require__(26),B=__w_pdfjs_require__(27),q=__w_pdfjs_require__(5),Z=__w_pdfjs_require__(32),N=__w_pdfjs_require__(14),T=__w_pdfjs_require__(35),b=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf);const VBtn$1="",VBtnToggle="",VBtnGroup$1="",makeBorderProps=propsFactory({border:[Boolean,Number,String]},"border");function useBorder(v){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();return{borderClasses:computed(()=>{const i=isRef(v)?v.value:v.border,y=[];if(i===!0||i==="")y.push(`${n}--border`);else if(typeof i=="string"||i===0)for(const B of String(i).split(" "))y.push(`border-${B}`);return y})}}const makeElevationProps=propsFactory({elevation:{type:[Number,String],validator(v){const n=parseInt(v);return!isNaN(n)&&n>=0&&n<=24}}},"elevation");function useElevation(v){return{elevationClasses:computed(()=>{const L=isRef(v)?v.value:v.elevation,i=[];return L==null||i.push(`elevation-${L}`),i})}}const allowedVariants=["elevated","flat","tonal","outlined","text","plain"];function genOverlays(v,n){return createVNode(Fragment,null,[v&&createVNode("span",{key:"overlay",class:`${n}__overlay`},null),createVNode("span",{key:"underlay",class:`${n}__underlay`},null)])}const makeVariantProps=propsFactory({color:String,variant:{type:String,default:"elevated",validator:v=>allowedVariants.includes(v)}},"variant");function useVariant(v){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();const L=computed(()=>{const{variant:B}=unref(v);return`${n}--variant-${B}`}),{colorClasses:i,colorStyles:y}=useColor(computed(()=>{const{variant:B,color:q}=unref(v);return{[["elevated","flat"].includes(B)?"background":"text"]:q}}));return{colorClasses:i,colorStyles:y,variantClasses:L}}const makeVBtnGroupProps=propsFactory({divided:Boolean,...makeBorderProps(),...makeDensityProps(),...makeElevationProps(),...makeRoundedProps(),...makeTagProps(),...makeThemeProps(),...makeVariantProps()},"v-btn-group"),VBtnGroup=genericComponent()({name:"VBtnGroup",props:makeVBtnGroupProps(),setup(v,n){let{slots:L}=n;const{themeClasses:i}=provideTheme(v),{densityClasses:y}=useDensity(v),{borderClasses:B}=useBorder(v),{elevationClasses:q}=useElevation(v),{roundedClasses:Z}=useRounded(v);provideDefaults({VBtn:{height:"auto",color:toRef(v,"color"),density:toRef(v,"density"),flat:!0,variant:toRef(v,"variant")}}),useRender(()=>createVNode(v.tag,{class:["v-btn-group",{"v-btn-group--divided":v.divided},i.value,B.value,y.value,q.value,Z.value]},L))}}),makeGroupProps=propsFactory({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),makeGroupItemProps=propsFactory({value:null,disabled:Boolean,selectedClass:String},"group-item");function useGroupItem(v,n){let L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=getCurrentInstance("useGroupItem");if(!i)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const y=getUid();provide(Symbol.for(`${n.description}:id`),y);const B=inject(n,null);if(!B){if(!L)return B;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${n.description}`)}const q=toRef(v,"value"),Z=computed(()=>B.disabled.value||v.disabled);B.register({id:y,value:q,disabled:Z},i),onBeforeUnmount(()=>{B.unregister(y)});const N=computed(()=>B.isSelected(y)),T=computed(()=>N.value&&[B.selectedClass.value,v.selectedClass]);return watch(N,b=>{i.emit("group:selected",{value:b})}),{id:y,isSelected:N,toggle:()=>B.select(y,!N.value),select:b=>B.select(y,b),selectedClass:T,value:q,disabled:Z,group:B}}function useGroup(v,n){let L=!1;const i=reactive([]),y=useProxiedModel(v,"modelValue",[],E=>E==null?[]:getIds(i,wrapInArray(E)),E=>{const _=getValues(i,E);return v.multiple?_:_[0]}),B=getCurrentInstance("useGroup");function q(E,_){const d=E,p=Symbol.for(`${n.description}:id`),a=findChildrenWithProvide(p,B==null?void 0:B.vnode).indexOf(_);a>-1?i.splice(a,0,d):i.push(d)}function Z(E){if(L)return;N();const _=i.findIndex(d=>d.id===E);i.splice(_,1)}function N(){const E=i.find(_=>!_.disabled);E&&v.mandatory==="force"&&!y.value.length&&(y.value=[E.id])}onMounted(()=>{N()}),onBeforeUnmount(()=>{L=!0});function T(E,_){const d=i.find(p=>p.id===E);if(!(_&&(d==null?void 0:d.disabled)))if(v.multiple){const p=y.value.slice(),s=p.findIndex(w=>w===E),a=~s;if(_=_!=null?_:!a,a&&v.mandatory&&p.length<=1||!a&&v.max!=null&&p.length+1>v.max)return;s<0&&_?p.push(E):s>=0&&!_&&p.splice(s,1),y.value=p}else{const p=y.value.includes(E);if(v.mandatory&&p)return;y.value=(_!=null?_:!p)?[E]:[]}}function b(E){if(v.multiple&&consoleWarn('This method is not supported when using "multiple" prop'),y.value.length){const _=y.value[0],d=i.findIndex(a=>a.id===_);let p=(d+E)%i.length,s=i[p];for(;s.disabled&&p!==d;)p=(p+E)%i.length,s=i[p];if(s.disabled)return;y.value=[i[p].id]}else{const _=i.find(d=>!d.disabled);_&&(y.value=[_.id])}}const k={register:q,unregister:Z,selected:y,select:T,disabled:toRef(v,"disabled"),prev:()=>b(i.length-1),next:()=>b(1),isSelected:E=>y.value.includes(E),selectedClass:computed(()=>v.selectedClass),items:computed(()=>i),getItemIndex:E=>getItemIndex(i,E)};return provide(n,k),k}function getItemIndex(v,n){const L=getIds(v,[n]);return L.length?v.findIndex(i=>i.id===L[0]):-1}function getIds(v,n){const L=[];for(let i=0;i<v.length;i++){const y=v[i];y.value!=null?n.find(B=>deepEqual(B,y.value))!=null&&L.push(y.id):n.includes(i)&&L.push(y.id)}return L}function getValues(v,n){const L=[];for(let i=0;i<v.length;i++){const y=v[i];n.includes(y.id)&&L.push(y.value!=null?y.value:i)}return L}const VBtnToggleSymbol=Symbol.for("vuetify:v-btn-toggle");genericComponent()({name:"VBtnToggle",props:{...makeVBtnGroupProps(),...makeGroupProps()},emits:{"update:modelValue":v=>!0},setup(v,n){let{slots:L}=n;const{isSelected:i,next:y,prev:B,select:q,selected:Z}=useGroup(v,VBtnToggleSymbol);return useRender(()=>{const[N]=VBtnGroup.filterProps(v);return createVNode(VBtnGroup,mergeProps({class:"v-btn-toggle"},N),{default:()=>{var T;return[(T=L.default)==null?void 0:T.call(L,{isSelected:i,next:y,prev:B,select:q,selected:Z})]}})}),{next:y,prev:B,select:q}}});const VProgressCircular$1="";function useIntersectionObserver(v){const n=ref(),L=ref(!1);if(SUPPORTS_INTERSECTION){const i=new IntersectionObserver(y=>{v==null||v(y,i),L.value=!!y.find(B=>B.isIntersecting)});onBeforeUnmount(()=>{i.disconnect()}),watch(n,(y,B)=>{B&&(i.unobserve(B),L.value=!1),y&&i.observe(y)},{flush:"post"})}return{intersectionRef:n,isIntersecting:L}}const VProgressCircular=genericComponent()({name:"VProgressCircular",props:{bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...makeSizeProps(),...makeTagProps({tag:"div"}),...makeThemeProps()},setup(v,n){let{slots:L}=n;const i=20,y=2*Math.PI*i,B=ref(),{themeClasses:q}=provideTheme(v),{sizeClasses:Z,sizeStyles:N}=useSize(v),{textColorClasses:T,textColorStyles:b}=useTextColor(toRef(v,"color")),{textColorClasses:k,textColorStyles:E}=useTextColor(toRef(v,"bgColor")),{intersectionRef:_,isIntersecting:d}=useIntersectionObserver(),{resizeRef:p,contentRect:s}=useResizeObserver(),a=computed(()=>Math.max(0,Math.min(100,parseFloat(v.modelValue)))),w=computed(()=>Number(v.width)),R=computed(()=>N.value?Number(v.size):s.value?s.value.width:Math.max(w.value,32)),S=computed(()=>i/(1-w.value/R.value)*2),t=computed(()=>w.value/R.value*S.value),c=computed(()=>convertToUnit((100-a.value)/100*y));return watchEffect(()=>{_.value=B.value,p.value=B.value}),useRender(()=>createVNode(v.tag,{ref:B,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!v.indeterminate,"v-progress-circular--visible":d.value,"v-progress-circular--disable-shrink":v.indeterminate==="disable-shrink"},q.value,Z.value,T.value],style:[N.value,b.value],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":v.indeterminate?void 0:a.value},{default:()=>[createVNode("svg",{style:{transform:`rotate(calc(-90deg + ${Number(v.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${S.value} ${S.value}`},[createVNode("circle",{class:["v-progress-circular__underlay",k.value],style:E.value,fill:"transparent",cx:"50%",cy:"50%",r:i,"stroke-width":t.value,"stroke-dasharray":y,"stroke-dashoffset":0},null),createVNode("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:i,"stroke-width":t.value,"stroke-dasharray":y,"stroke-dashoffset":c.value},null)]),L.default&&createVNode("div",{class:"v-progress-circular__content"},[L.default({value:a.value})])]})),{}}}),VRipple="",stopSymbol=Symbol("rippleStop"),DELAY_RIPPLE=80;function transform(v,n){v.style.transform=n,v.style.webkitTransform=n}function isTouchEvent(v){return v.constructor.name==="TouchEvent"}function isKeyboardEvent(v){return v.constructor.name==="KeyboardEvent"}const calculate=function(v,n){var k;let L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=0,y=0;if(!isKeyboardEvent(v)){const E=n.getBoundingClientRect(),_=isTouchEvent(v)?v.touches[v.touches.length-1]:v;i=_.clientX-E.left,y=_.clientY-E.top}let B=0,q=.3;(k=n._ripple)!=null&&k.circle?(q=.15,B=n.clientWidth/2,B=L.center?B:B+Math.sqrt((i-B)**2+(y-B)**2)/4):B=Math.sqrt(n.clientWidth**2+n.clientHeight**2)/2;const Z=`${(n.clientWidth-B*2)/2}px`,N=`${(n.clientHeight-B*2)/2}px`,T=L.center?Z:`${i-B}px`,b=L.center?N:`${y-B}px`;return{radius:B,scale:q,x:T,y:b,centerX:Z,centerY:N}},ripples={show(v,n){var _;let L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!((_=n==null?void 0:n._ripple)!=null&&_.enabled))return;const i=document.createElement("span"),y=document.createElement("span");i.appendChild(y),i.className="v-ripple__container",L.class&&(i.className+=` ${L.class}`);const{radius:B,scale:q,x:Z,y:N,centerX:T,centerY:b}=calculate(v,n,L),k=`${B*2}px`;y.className="v-ripple__animation",y.style.width=k,y.style.height=k,n.appendChild(i);const E=window.getComputedStyle(n);E&&E.position==="static"&&(n.style.position="relative",n.dataset.previousPosition="static"),y.classList.add("v-ripple__animation--enter"),y.classList.add("v-ripple__animation--visible"),transform(y,`translate(${Z}, ${N}) scale3d(${q},${q},${q})`),y.dataset.activated=String(performance.now()),setTimeout(()=>{y.classList.remove("v-ripple__animation--enter"),y.classList.add("v-ripple__animation--in"),transform(y,`translate(${T}, ${b}) scale3d(1,1,1)`)},0)},hide(v){var B;if(!((B=v==null?void 0:v._ripple)!=null&&B.enabled))return;const n=v.getElementsByClassName("v-ripple__animation");if(n.length===0)return;const L=n[n.length-1];if(L.dataset.isHiding)return;L.dataset.isHiding="true";const i=performance.now()-Number(L.dataset.activated),y=Math.max(250-i,0);setTimeout(()=>{L.classList.remove("v-ripple__animation--in"),L.classList.add("v-ripple__animation--out"),setTimeout(()=>{var Z;v.getElementsByClassName("v-ripple__animation").length===1&&v.dataset.previousPosition&&(v.style.position=v.dataset.previousPosition,delete v.dataset.previousPosition),((Z=L.parentNode)==null?void 0:Z.parentNode)===v&&v.removeChild(L.parentNode)},300)},y)}};function isRippleEnabled(v){return typeof v>"u"||!!v}function rippleShow(v){const n={},L=v.currentTarget;if(!(!(L!=null&&L._ripple)||L._ripple.touched||v[stopSymbol])){if(v[stopSymbol]=!0,isTouchEvent(v))L._ripple.touched=!0,L._ripple.isTouch=!0;else if(L._ripple.isTouch)return;if(n.center=L._ripple.centered||isKeyboardEvent(v),L._ripple.class&&(n.class=L._ripple.class),isTouchEvent(v)){if(L._ripple.showTimerCommit)return;L._ripple.showTimerCommit=()=>{ripples.show(v,L,n)},L._ripple.showTimer=window.setTimeout(()=>{var i;(i=L==null?void 0:L._ripple)!=null&&i.showTimerCommit&&(L._ripple.showTimerCommit(),L._ripple.showTimerCommit=null)},DELAY_RIPPLE)}else ripples.show(v,L,n)}}function rippleStop(v){v[stopSymbol]=!0}function rippleHide(v){const n=v.currentTarget;if(!!(n!=null&&n._ripple)){if(window.clearTimeout(n._ripple.showTimer),v.type==="touchend"&&n._ripple.showTimerCommit){n._ripple.showTimerCommit(),n._ripple.showTimerCommit=null,n._ripple.showTimer=window.setTimeout(()=>{rippleHide(v)});return}window.setTimeout(()=>{n._ripple&&(n._ripple.touched=!1)}),ripples.hide(n)}}function rippleCancelShow(v){const n=v.currentTarget;!(n!=null&&n._ripple)||(n._ripple.showTimerCommit&&(n._ripple.showTimerCommit=null),window.clearTimeout(n._ripple.showTimer))}let keyboardRipple=!1;function keyboardRippleShow(v){!keyboardRipple&&(v.keyCode===keyCodes.enter||v.keyCode===keyCodes.space)&&(keyboardRipple=!0,rippleShow(v))}function keyboardRippleHide(v){keyboardRipple=!1,rippleHide(v)}function focusRippleHide(v){keyboardRipple&&(keyboardRipple=!1,rippleHide(v))}function updateRipple(v,n,L){var q;const{value:i,modifiers:y}=n,B=isRippleEnabled(i);if(B||ripples.hide(v),v._ripple=(q=v._ripple)!=null?q:{},v._ripple.enabled=B,v._ripple.centered=y.center,v._ripple.circle=y.circle,isObject(i)&&i.class&&(v._ripple.class=i.class),B&&!L){if(y.stop){v.addEventListener("touchstart",rippleStop,{passive:!0}),v.addEventListener("mousedown",rippleStop);return}v.addEventListener("touchstart",rippleShow,{passive:!0}),v.addEventListener("touchend",rippleHide,{passive:!0}),v.addEventListener("touchmove",rippleCancelShow,{passive:!0}),v.addEventListener("touchcancel",rippleHide),v.addEventListener("mousedown",rippleShow),v.addEventListener("mouseup",rippleHide),v.addEventListener("mouseleave",rippleHide),v.addEventListener("keydown",keyboardRippleShow),v.addEventListener("keyup",keyboardRippleHide),v.addEventListener("blur",focusRippleHide),v.addEventListener("dragstart",rippleHide,{passive:!0})}else!B&&L&&removeListeners(v)}function removeListeners(v){v.removeEventListener("mousedown",rippleShow),v.removeEventListener("touchstart",rippleShow),v.removeEventListener("touchend",rippleHide),v.removeEventListener("touchmove",rippleCancelShow),v.removeEventListener("touchcancel",rippleHide),v.removeEventListener("mouseup",rippleHide),v.removeEventListener("mouseleave",rippleHide),v.removeEventListener("keydown",keyboardRippleShow),v.removeEventListener("keyup",keyboardRippleHide),v.removeEventListener("dragstart",rippleHide),v.removeEventListener("blur",focusRippleHide)}function mounted(v,n){updateRipple(v,n,!1)}function unmounted(v){delete v._ripple,removeListeners(v)}function updated(v,n){if(n.value===n.oldValue)return;const L=isRippleEnabled(n.oldValue);updateRipple(v,n,L)}const Ripple={mounted,unmounted,updated},oppositeMap={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},makeLocationProps=propsFactory({location:String},"location");function useLocation(v){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,L=arguments.length>2?arguments[2]:void 0;const{isRtl:i}=useRtl();return{locationStyles:computed(()=>{if(!v.location)return{};const{side:B,align:q}=parseAnchor(v.location.split(" ").length>1?v.location:`${v.location} center`,i.value);function Z(T){return L?L(T):0}const N={};return B!=="center"&&(n?N[oppositeMap[B]]=`calc(100% - ${Z(B)}px)`:N[B]=0),q!=="center"?n?N[oppositeMap[q]]=`calc(100% - ${Z(q)}px)`:N[q]=0:(B==="center"?N.top=N.left="50%":N[{top:"left",bottom:"left",left:"top",right:"top"}[B]]="50%",N.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[B]),N})}}const makeLoaderProps=propsFactory({loading:[Boolean,String]},"loader");function useLoader(v){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();return{loaderClasses:computed(()=>({[`${n}--loading`]:v.loading}))}}const positionValues=["static","relative","fixed","absolute","sticky"],makePositionProps=propsFactory({position:{type:String,validator:v=>positionValues.includes(v)}},"position");function usePosition(v){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();return{positionClasses:computed(()=>v.position?`${n}--${v.position}`:void 0)}}function useSelectLink(v,n){watch(()=>{var L;return(L=v.isActive)==null?void 0:L.value},L=>{v.isLink.value&&L&&n&&nextTick(()=>{n(!0)})},{immediate:!0})}const makeVBtnProps=propsFactory({active:{type:Boolean,default:void 0},symbol:{type:null,default:VBtnToggleSymbol},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:IconValue,appendIcon:IconValue,block:Boolean,stacked:Boolean,ripple:{type:Boolean,default:!0},...makeBorderProps(),...makeRoundedProps(),...makeDensityProps(),...makeDimensionProps(),...makeElevationProps(),...makeGroupItemProps(),...makeLoaderProps(),...makeLocationProps(),...makePositionProps(),...makeRouterProps(),...makeSizeProps(),...makeTagProps({tag:"button"}),...makeThemeProps(),...makeVariantProps({variant:"elevated"})},"VBtn"),VBtn=genericComponent()({name:"VBtn",directives:{Ripple},props:makeVBtnProps(),emits:{"group:selected":v=>!0},setup(v,n){let{attrs:L,slots:i}=n;const{themeClasses:y}=provideTheme(v),{borderClasses:B}=useBorder(v),{colorClasses:q,colorStyles:Z,variantClasses:N}=useVariant(v),{densityClasses:T}=useDensity(v),{dimensionStyles:b}=useDimension(v),{elevationClasses:k}=useElevation(v),{loaderClasses:E}=useLoader(v),{locationStyles:_}=useLocation(v),{positionClasses:d}=usePosition(v),{roundedClasses:p}=useRounded(v),{sizeClasses:s,sizeStyles:a}=useSize(v),w=useGroupItem(v,v.symbol,!1),R=useLink(v,L),S=computed(()=>{var r;return v.active!==void 0?v.active:R.isLink.value?(r=R.isActive)==null?void 0:r.value:w==null?void 0:w.isSelected.value}),t=computed(()=>(w==null?void 0:w.disabled.value)||v.disabled),c=computed(()=>v.variant==="elevated"&&!(v.disabled||v.flat||v.border)),h=computed(()=>{if(v.value!==void 0)return Object(v.value)===v.value?JSON.stringify(v.value,null,0):v.value});return useSelectLink(R,w==null?void 0:w.select),useRender(()=>{var z,K;const r=R.isLink.value?"a":v.tag,g=!!(v.prependIcon||i.prepend),x=!!(v.appendIcon||i.append),o=!!(v.icon&&v.icon!==!0),D=(w==null?void 0:w.isSelected.value)&&(!R.isLink.value||((z=R.isActive)==null?void 0:z.value))||!w||((K=R.isActive)==null?void 0:K.value);return withDirectives(createVNode(r,{type:r==="a"?void 0:"button",class:["v-btn",w==null?void 0:w.selectedClass.value,{"v-btn--active":S.value,"v-btn--block":v.block,"v-btn--disabled":t.value,"v-btn--elevated":c.value,"v-btn--flat":v.flat,"v-btn--icon":!!v.icon,"v-btn--loading":v.loading,"v-btn--stacked":v.stacked},y.value,B.value,D?q.value:void 0,T.value,k.value,E.value,d.value,p.value,s.value,N.value],style:[D?Z.value:void 0,b.value,_.value,a.value],disabled:t.value||void 0,href:R.href.value,onClick:tt=>{var it;t.value||((it=R.navigate)==null||it.call(R,tt),w==null||w.toggle())},value:h.value},{default:()=>{var tt,it;return[genOverlays(!0,"v-btn"),!v.icon&&g&&createVNode("span",{key:"prepend",class:"v-btn__prepend"},[i.prepend?createVNode(VDefaultsProvider,{key:"prepend-defaults",disabled:!v.prependIcon,defaults:{VIcon:{icon:v.prependIcon}}},i.prepend):createVNode(VIcon,{key:"prepend-icon",icon:v.prependIcon},null)]),createVNode("span",{class:"v-btn__content","data-no-activator":""},[!i.default&&o?createVNode(VIcon,{key:"content-icon",icon:v.icon},null):createVNode(VDefaultsProvider,{key:"content-defaults",disabled:!o,defaults:{VIcon:{icon:v.icon}}},i.default)]),!v.icon&&x&&createVNode("span",{key:"append",class:"v-btn__append"},[i.append?createVNode(VDefaultsProvider,{key:"append-defaults",disabled:!v.appendIcon,defaults:{VIcon:{icon:v.appendIcon}}},i.append):createVNode(VIcon,{key:"append-icon",icon:v.appendIcon},null)]),!!v.loading&&createVNode("span",{key:"loader",class:"v-btn__loader"},[(it=(tt=i.loader)==null?void 0:tt.call(i))!=null?it:createVNode(VProgressCircular,{color:typeof v.loading=="boolean"?void 0:v.loading,indeterminate:!0,size:"23",width:"2"},null)])]}}),[[resolveDirective("ripple"),!t.value&&v.ripple,null]])}),{}}}),_sfc_main={__name:"PdfDisplay",setup(v){const n=useRoute(),L=ref(null),i=ref(1),y=ref(0),B=ref(null),q=ref(1.5);onMounted(()=>{pdf.exports.GlobalWorkerOptions.workerSrc="../../node_modules/pdfjs-dist/build/pdf.worker.js",pdf.exports.getDocument("/api"+n.path+".pdf").promise.then(b=>{L.value=b,i.value=1,y.value=b.numPages,Z(i.value)},b=>console.log(b))});const Z=b=>{toRaw(L.value).getPage(b).then(k=>{const E=B.value.getContext("2d"),_=k.getViewport({scale:q.value});B.value.width=_.width,B.value.height=_.height;const d={canvasContext:E,viewport:_};k.render(d)})},N=()=>{i.value>=y.value||(i.value++,Z(i.value))},T=()=>{i.value<=1||(i.value--,Z(i.value))};return(b,k)=>L.value?(openBlock(),createBlock(VContainer,{key:0},{default:withCtx(()=>[createVNode(VRow,{justify:"center",align:"center"},{default:withCtx(()=>[createVNode(VCol,{cols:"auto"},{default:withCtx(()=>[createVNode(VBtn,{size:"small",onClick:T,disabled:i.value===1},{default:withCtx(()=>[createTextVNode(" Prev ")]),_:1},8,["disabled"])]),_:1}),createVNode(VCol,{cols:"auto"},{default:withCtx(()=>[createBaseVNode("p",null,toDisplayString(i.value)+" / "+toDisplayString(y.value),1)]),_:1}),createVNode(VCol,{cols:"auto"},{default:withCtx(()=>[createVNode(VBtn,{size:"small",onClick:N,disabled:i.value===y.value},{default:withCtx(()=>[createTextVNode(" Next ")]),_:1},8,["disabled"])]),_:1})]),_:1}),createVNode(VRow,{justify:"center"},{default:withCtx(()=>[createBaseVNode("canvas",{ref_key:"canvas",ref:B,style:{border:"1px solid black"}},null,512)]),_:1})]),_:1})):createCommentVNode("",!0)}};export{_sfc_main as default};
